1                                                          The SAS System                              13:16 Sunday, August 26, 2018

NOTE: Copyright (c) 2002-2010 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.3 (TS1M2) 
      Licensed to INFORMATION RESOURCES, Site 51800034.
NOTE: This session is executing on the HP-UX B.11.31 (HP IPF) platform.

NOTE: Running on HP Model ia64 Serial Number 3644327325.


You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
      real time           0.24 seconds
      cpu time            0.08 seconds
      
1          *****************************************************************************;
2          *  Integrated Scanner/Audit Aggregation Engine Code for Greek Transition    *;
3          *---------------------------------------------------------------------------*;
4          *  Developer:   Simon Poole                                                 *;
5          *  Created:             May 2003                                            *;
6          *---------------------------------------------------------------------------*;
7          * INPUTS:                                                                   *;
8          * MASTAUDIT         master file for audit data                              *;
9          * MASTSCAN          master files for scanner data                           *;
10         * ITEMMAST          integrated dictionary                                   *;
11         * STORMAST          integrated store master                                 *;
12         * MAX               Geography v store type mapping                          *;
13         * KEYCAT            keycat specific scaling variables                       *;
14         * FACTOR            Projections                                             *;
15         * GEO               Region hierarchy and store type hierarchy               *;
16         * UNIVERSE          Universe and Sample sizes for distribution              *;
17         * CODE              Hierarchy codes                                         *;
18         * DESC              Hierarchy code descriptions                             *;
19         * TIMEPERIOD        Time period translation file                            *;
20         *                                                                           *;
21         * OUTPUTS:                                                                  *;
22         * Aggall            Aggregation file                                        *;
23         *                                                                           *;
24         *  Notes:                                                                   *;
25         *    Numerical distribution calculated using values from the universe file. *;
26         *    This file contains the number of sample and universe stores by region  *;
27         *    and store type                                                         *;
28         *    The alternative is to use projection weights used for projecting sales *;
2                                                          The SAS System                              13:16 Sunday, August 26, 2018

29         *    PromoScan -- 8 single weeks reported                                   *;
30         *    InfoScan  -- 1 quad 4 week period + 4/5 WEEKS                          *;
31         *    Combined  -- 1 bi-month period                                         *;
32         *---------------------------------------------------------------------------*;
33         *  Update reason                      Author                  Date          *;
34         *  missing level codes for Promoscan  A.Agostinelli           2003/09/11    *;
35         *  measures added                     A.Agostinelli           2015/01/12    *;
36         *  consolidation with REDBULL engine  A.Agostinelli           2015/02/18    *;
37         *  Special pack added                 A.Agostinelli           2015/02/19    *;
38         *  Consolidation of all versions      R.Walter                2015/07/28    *;
39         *  Removing PACKTYPE from MF          R.Walter                2016/02/16    *;
40         *  Add Extra Measures M254-M257       R.Walter P.Katsaitis    2016/06/10    *;
41         /*========================================================================= */
42         /*                                                                          */
43         /*   CHANGES IMPLEMENTED WITH THE CONSOLIDATION OF THE DIFFERENT VERSIONS   */
44         /*   --------------------------------------------------------------------   */
45         /* - fileref.sas is not used anymore                                        */
46         /* - parameters are defined in new parameter-file                           */
47         /* - periods    are defined in new parameter-file                           */
48         /*                                                                          */
49         /*========================================================================= */
50         
51         
52         /****************************************************************************/
53         /* Flag identifying the max. length of the period-fields                    */
54         /* 3 = current production without having adapted environment to Week999     */
55         /* 4 = after having migrated the complete environment                       */
56         /****************************************************************************/
57         %let WEEK999LEN=4;
58         
59         %let address = %sysfunc(pathname(WORK));
60         %put &address;
/data/tmp1/SAS_work78E000003497_atlas
61         
62         
63         filename sasmac "/IRI_prod/PGM";    /*"&pmacros";*/    /* Location of external macros*/
64         
65         options mrecall mautosource sasautos=sasmac compress=yes linesize=max pagesize=max nocenter;
66         options nomprint nomacrogen nosymbolgen nonotes nosource;
69         
70         %let debug = 0;
71         %let obs   = 100;
72         
73         /*use this macro for debugging -- prints observations*/
74         %macro printdeb(dataset,title);
75            %if &debug=1 %then %do; proc print data=&dataset(obs=&obs); title "&title"; %end;
76         %mend;
77         
78         /*** 20150609 : block some dummy space in order to let SAS select a different SASWORK ***/
79         data _blockspace_(compress=NO); length block1-block10 $2000.; do i=1 to 256; output; end; run;

NOTE: Variable block1 is uninitialized.
NOTE: Variable block2 is uninitialized.
NOTE: Variable block3 is uninitialized.
NOTE: Variable block4 is uninitialized.
NOTE: Variable block5 is uninitialized.
NOTE: Variable block6 is uninitialized.
NOTE: Variable block7 is uninitialized.
NOTE: Variable block8 is uninitialized.
NOTE: Variable block9 is uninitialized.
NOTE: Variable block10 is uninitialized.
NOTE: The data set WORK._BLOCKSPACE_ has 256 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

80         
81         %let prjdir   =         %scan(&sysparm,1, " ");
82         %let category =         %scan(&sysparm,2, " ");
83         %let MaxWk    = %eval(%sysfunc(putn(%scan(&sysparm,3," "),z&WEEK999LEN..)));
84         %let service  =         %scan(&sysparm,4, " ");
85         %let schedule =         %scan(&sysparm,5, " ");
86         %let prod_id  = %upcase(%scan(&sysparm,6, " "));
87         
88         %global levels plevel meascnt measurelist geolist typelist sectot sample univ volfact glev slev typecnt geocnt;
89         
90         /*** Global variables for Prod_Parameters ***/
91         %let Prod_DirectoryInputRoot   = ;
92         %let Prod_DirectoryInputMaster = ;
93         %let Prod_DirectoryInputItem   = ;
94         %let Prod_FileAuditMaster      = ;
95         %let Prod_FileAuditPeriod      = ;
96         %let Prod_DirectoryOutput      = ;
97         %let Prod_OutputType           = ;
98         %let Prod_FormularInfoscanM006 = ;
99         %let Prod_ScannerStores        = ;
100        %let bp_types                  = ;
101        %let sp_types                  = ;
102        %let Prod_DirectoryData        = ;
103        %let Prod_DirectoryCategories  = ;
104        %let Prod_DirectoryCfiles      = ;
105        %let Prod_DirectoryDfiles      = ;
106        %let Prod_DirectoryUnbfiles    = ;
107        %let Prod_DirectoryProj        = ;
108        %let Prod_DeleteNoVolume       = YES;
109        %read_prod_parameters;
MPRINT(READ_PROD_PARAMETERS):   data prod_parameters;
MPRINT(READ_PROD_PARAMETERS):   infile "/IRI_prod/PARM/Prod_Parameters.txt" dlm='09'x lrecl=500 dsd missover firstobs=2;
MPRINT(READ_PROD_PARAMETERS):   input Prod_Id :$50. Prod_DirectoryInputRoot :$100. Prod_DirectoryInputMaster :$100. Prod_DirectoryInputItem :$100. Prod_FileAuditMaster :$50. Prod_FileAuditPeriod :$50. Prod_DirectoryOutput :$100. Prod_OutputType :$05. 
Prod_FormularInfoscanM006 :$100. Prod_ScannerStores :$100. Prod_BP_Types :$50. Prod_SP_Types :$50. Prod_DeleteNoVolume :$03.;
MPRINT(READ_PROD_PARAMETERS):   Prod_Id = upcase(Prod_Id);
MPRINT(READ_PROD_PARAMETERS):   Prod_OutputType = upcase(Prod_OutputType);
MPRINT(READ_PROD_PARAMETERS):   if Prod_Id = "DEFAULT_ALL" then do;
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryInputRoot", trim(left(Prod_DirectoryInputRoot )));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryInputMaster", trim(left(Prod_DirectoryInputMaster )));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryInputItem", trim(left(Prod_DirectoryInputItem )));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_FileAuditMaster", trim(left(Prod_FileAuditMaster )));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_FileAuditPeriod", trim(left(Prod_FileAuditPeriod )));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_ScannerStores", trim(left(Prod_ScannerStores )));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryOutput", trim(left(Prod_DirectoryOutput )));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_OutputType", trim(left(Prod_OutputType )));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_FormularInfoscanM006", trim(left(Prod_FormularInfoscanM006 )));
MPRINT(READ_PROD_PARAMETERS):   call symput("bp_types", trim(left(Prod_BP_Types )));
MPRINT(READ_PROD_PARAMETERS):   call symput("sp_types", trim(left(Prod_SP_Types )));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DeleteNoVolume", upcase(trim(left(Prod_DeleteNoVolume))));
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryData", trim(left(Prod_DirectoryInputRoot )) !! "/data" );
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryCategories", trim(left(Prod_DirectoryInputRoot )) !! "/categories" );
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryCfiles", trim(left(Prod_DirectoryInputRoot )) !! "/categories/cfiles" );
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryDfiles", trim(left(Prod_DirectoryInputRoot )) !! "/categories/dfiles" );
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryUnbfiles", trim(left(Prod_DirectoryInputRoot )) !! "/categories/unbfiles");
MPRINT(READ_PROD_PARAMETERS):   call symput("Prod_DirectoryProj", trim(left(Prod_DirectoryInputRoot )) !! "/proj" );
MPRINT(READ_PROD_PARAMETERS):   output;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   run;

NOTE: The infile "/IRI_prod/PARM/Prod_Parameters.txt" is:
      Filename=/IRI_prod/PARM/Prod_Parameters.txt,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Thu Aug  2 12:35:01 2018,
      File Size (bytes)=10361

NOTE: 45 records were read from the infile "/IRI_prod/PARM/Prod_Parameters.txt".
      The minimum record length was 178.
      The maximum record length was 264.
NOTE: The data set WORK.PROD_PARAMETERS has 1 observations and 13 variables.
NOTE: Compressing data set WORK.PROD_PARAMETERS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/IRI_prod/PARM/Prod_Parameters.txt) imported
MPRINT(READ_PROD_PARAMETERS):   data _null_;
MPRINT(READ_PROD_PARAMETERS):   errcode=0;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/data/prod/transition/audit")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryInputRoot   does not exist (/data/prod/transition/audit)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/start/allprod")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryInputMaster does not exist (/start/allprod)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/data/prod/transition/audit/data")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryInputItem   does not exist (/data/prod/transition/audit/data)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/data/prod/transition/audit")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryOutput      does not exist (/data/prod/transition/audit/data)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if "ALL" not in ("ALL" "WEEK" "MONTH") then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Wrong OutputType (ALL) defined in Parameterfile - valid values are (ALL,WEEK,MONTH)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/data/prod/transition/audit/data")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryData        does not exist (/data/prod/transition/audit/data)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/data/prod/transition/audit/categories")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryCategories  does not exist (/data/prod/transition/audit/categories)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/data/prod/transition/audit/categories/cfiles")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryCfiles      does not exist (/data/prod/transition/audit/categories/cfiles)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/data/prod/transition/audit/categories/dfiles")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryDfiles      does not exist (/data/prod/transition/audit/categories/dfiles)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/data/prod/transition/audit/categories/unbfiles")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryUnbfiles    does not exist (/data/prod/transition/audit/categories/unbfiles)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   if fileexist("/data/prod/transition/audit/proj")=0 then do;
MPRINT(READ_PROD_PARAMETERS):   put "ERROR: Directory Prod_DirectoryProj        does not exist (/data/prod/transition/audit/proj)";
MPRINT(READ_PROD_PARAMETERS):   errcode=1;
MPRINT(READ_PROD_PARAMETERS):   end;
MPRINT(READ_PROD_PARAMETERS):   call symput("errcode",trim(left(errcode)));
MPRINT(READ_PROD_PARAMETERS):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      109:154   
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

110        
111        /*** Global variables for New-Measure-Definition ***/
112        %let newmeasure_rb            = N;
113        %let newmeasure_bat           = N;
114        
115        /*** Global variables for Period-Manager ***/
116        %let ProductionPeriod         = ;
117        %let Period                   = ;
118        %let MinWk                    = ;
119        %let PDays                    = ;
120        %let Monthlyagg               = N;
121        %period_manager(_srv_=&service, _sched_=&schedule, _lwk_=&maxwk);
MPRINT(PERIOD_MANAGER):   data period_manager(drop=Periodn FirstWeekn LastWeekn);
MPRINT(PERIOD_MANAGER):   length Period $4.;
MPRINT(PERIOD_MANAGER):   infile "/IRI_prod/PARM/Period_Manager.txt" dlm='09'x dsd missover firstobs=2;
MPRINT(PERIOD_MANAGER):   input Service :$20. ProductionPeriod :$6. Schedule :$20. Periodn :$4. FirstWeekn :$4. LastWeekn :$4. NrWeeks :$2. PDays :$2.;
MPRINT(PERIOD_MANAGER):   if Periodn = . then Period = "";
MPRINT(PERIOD_MANAGER):   else Period = input(put(Periodn*1,z4.),$4.);
MPRINT(PERIOD_MANAGER):   FirstWeek = input(put(FirstWeekn*1,z4.),$4.);
MPRINT(PERIOD_MANAGER):   LastWeek = input(put(LastWeekn*1, z4.),$4.);
MPRINT(PERIOD_MANAGER):   if upcase(Service)=upcase("Infoscan") and upcase(Schedule)=upcase("S445") and LastWeek = 0870;
MPRINT(PERIOD_MANAGER):   run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      121:80    121:134   121:205   121:30    121:162   
NOTE: The infile "/IRI_prod/PARM/Period_Manager.txt" is:
      Filename=/IRI_prod/PARM/Period_Manager.txt,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Fri Dec 29 11:01:57 2017,
      File Size (bytes)=84842

NOTE: 2095 records were read from the infile "/IRI_prod/PARM/Period_Manager.txt".
      The minimum record length was 34.
      The maximum record length was 77.
NOTE: The data set WORK.PERIOD_MANAGER has 1 observations and 8 variables.
NOTE: Compressing data set WORK.PERIOD_MANAGER increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/IRI_prod/PARM/Period_Manager.txt) imported
MPRINT(PERIOD_MANAGER):   data _null_;
MPRINT(PERIOD_MANAGER):   set period_manager;
MPRINT(PERIOD_MANAGER):   call symput("ProductionPeriod", trim(left(ProductionPeriod)));
MPRINT(PERIOD_MANAGER):   call symput("Period", trim(left(Period)));
MPRINT(PERIOD_MANAGER):   call symput("MinWk", trim(left(FirstWeek)));
MPRINT(PERIOD_MANAGER):   call symput("PDays", trim(left(PDays)));
MPRINT(PERIOD_MANAGER):   if "ALL" ^= "WEEK" and trim(left(Period)) ^= "" then do;
MPRINT(PERIOD_MANAGER):   if upcase(Service) = "INFOSCAN" and FirstWeek = 0870 then call symput("Monthlyagg", "N");
MPRINT(PERIOD_MANAGER):   else call symput("Monthlyagg", "Y");
MPRINT(PERIOD_MANAGER):   end;
MPRINT(PERIOD_MANAGER):   else call symput("Monthlyagg", "N");
MPRINT(PERIOD_MANAGER):   if "ALL" = "WEEK" and trim(left(Period)) = "" and upcase(Service) = "INFOSCAN" then call symput("period", ".");
MPRINT(PERIOD_MANAGER):   run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      121:180   
NOTE: There were 1 observations read from the data set WORK.PERIOD_MANAGER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

122        
123        
124        %let ean_val =;
125        
126        
127        /*** Print all global variables including their values ***/
128        %showopt;
MPRINT(SHOWOPT):   proc sort data=sashelp.vmacro out=_vmacro_ nodupkey;
MPRINT(SHOWOPT):   by name;
MPRINT(SHOWOPT):   where scope="GLOBAL" and name^="SYSODSPATH";
MPRINT(SHOWOPT):   run;

NOTE: There were 51 observations read from the data set SASHELP.VMACRO.
      WHERE (scope='GLOBAL') and (name not = 'SYSODSPATH');
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK._VMACRO_ has 51 observations and 4 variables.
NOTE: Compressing data set WORK._VMACRO_ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.07 seconds
      cpu time            0.06 seconds
      

MPRINT(SHOWOPT):   proc sql noprint;
MPRINT(SHOWOPT):   select max(length(name)) into: l_name from _vmacro_;
MPRINT(SHOWOPT):   select max(length(value)) into: l_value from _vmacro_;
MPRINT(SHOWOPT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(SHOWOPT):   data _null_;
MPRINT(SHOWOPT):   set _vmacro_ end=last;
MPRINT(SHOWOPT):   if _N_=1 then put "INFO:    +" 75*"-" "+";
MPRINT(SHOWOPT):   put "INFO:    |" 75*"." @14 "(" name +(-1) ")" @14 + 25 + 5 "(" value +(-1) ")" @11 + 75 "|";
MPRINT(SHOWOPT):   if last then put "INFO:    +" 75*"-" "+";
MPRINT(SHOWOPT):   run;

INFO:    +---------------------------------------------------------------------------+
INFO:    |...(ADDRESS).....................(/data/tmp1/SAS_work78E000003497_atlas)...|
INFO:    |...(BP_TYPES)....................(BP)......................................|
INFO:    |...(CATEGORY)....................(bschfrvNI)...............................|
INFO:    |...(DEBUG).......................(0).......................................|
INFO:    |...(EAN_VAL).....................( ).......................................|
INFO:    |...(ERRCODE).....................(0).......................................|
INFO:    |...(GEOCNT)......................( ).......................................|
INFO:    |...(GEOLIST).....................( ).......................................|
INFO:    |...(GLEV)........................( ).......................................|
INFO:    |...(LEVELS)......................( ).......................................|
INFO:    |...(MAXWK).......................(0870)....................................|
INFO:    |...(MEASCNT).....................( ).......................................|
INFO:    |...(MEASURELIST).................( ).......................................|
INFO:    |...(MINWK).......................(0867)....................................|
INFO:    |...(MONTHLYAGG)..................(Y).......................................|
INFO:    |...(NEWMEASURE_BAT)..............(N).......................................|
INFO:    |...(NEWMEASURE_RB)...............(N).......................................|
INFO:    |...(OBS).........................(100).....................................|
INFO:    |...(PDAYS).......................( ).......................................|
INFO:    |...(PERIOD)......................(0128)....................................|
INFO:    |...(PLEVEL)......................( ).......................................|
INFO:    |...(PRJDIR)......................(/data/prod/transition)...................|
INFO:    |...(PRODUCTIONPERIOD)............(201308)..................................|
INFO:    |...(PROD_DELETENOVOLUME).........(YES).....................................|
INFO:    |...(PROD_DIRECTORYCATEGORIES)....(&prjdir/audit/categories)................|
INFO:    |...(PROD_DIRECTORYCFILES)........(&prjdir/audit/categories/cfiles).........|
INFO:    |...(PROD_DIRECTORYDATA)..........(&prjdir/audit/data)......................|
INFO:    |...(PROD_DIRECTORYDFILES)........(&prjdir/audit/categories/dfiles).........|
INFO:    |...(PROD_DIRECTORYINPUTITEM).....(&prjdir/audit/data)......................|
INFO:    |...(PROD_DIRECTORYINPUTMASTER)...(/start/allprod)..........................|
INFO:    |...(PROD_DIRECTORYINPUTROOT).....(&prjdir/audit)...........................|
INFO:    |...(PROD_DIRECTORYOUTPUT)........(&prjdir/audit)...........................|
INFO:    |...(PROD_DIRECTORYPROJ)..........(&prjdir/audit/proj)......................|
INFO:    |...(PROD_DIRECTORYUNBFILES)......(&prjdir/audit/categories/unbfiles).......|
INFO:    |...(PROD_FILEAUDITMASTER)........(amaster.p[period]).......................|
INFO:    |...(PROD_FILEAUDITPERIOD)........(sdates.[period]).........................|
INFO:    |...(PROD_FORMULARINFOSCANM006)...(M006=100*(volume/pnums);)................|
INFO:    |...(PROD_ID).....................(DEFAULT_ALL).............................|
INFO:    |...(PROD_OUTPUTTYPE).............(ALL).....................................|
INFO:    |...(PROD_SCANNERSTORES)..........(('00' '01' '03' '61' '62' '63' '64'))....|
INFO:    |...(SAMPLE)......................( ).......................................|
INFO:    |...(SCHEDULE)....................(S445)....................................|
INFO:    |...(SECTOT)......................( ).......................................|
INFO:    |...(SERVICE).....................(Infoscan)................................|
INFO:    |...(SLEV)........................( ).......................................|
INFO:    |...(SP_TYPES)....................(('BD' 'BS' 'EF' 'PO'))...................|
INFO:    |...(TYPECNT).....................( ).......................................|
INFO:    |...(TYPELIST)....................( ).......................................|
INFO:    |...(UNIV)........................( ).......................................|
INFO:    |...(VOLFACT).....................( ).......................................|
INFO:    |...(WEEK999LEN)..................(4).......................................|
INFO:    +---------------------------------------------------------------------------+
NOTE: There were 51 observations read from the data set WORK._VMACRO_.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(SHOWOPT):   proc delete data=_vmacro_;
MPRINT(SHOWOPT):   run;

NOTE: Deleting WORK._VMACRO_ (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

129        
130        options mprint macrogen notes source;
131        
132        *----------------------------------------------------------------------------------------------;
133        *--- MAIN MACRO: Executes Aggregation Engine Macros -------------------------------------------;
134        *----------------------------------------------------------------------------------------------;
135        /* Note: within each of the sub-macros contained in the MAIN macro below a macro variable     */
136        /*       called service is passed through by the GUI and the resolved value will identify     */
137        /*       what code should be executed                                                         */
138        
139        %macro MAIN;
140        
141           /*** 20131121 : Performance monitoring *************/
142           %monitor(_var_=agg_eng,  _val_="aggeng",    _mod_=1);
143           %monitor(_var_=category, _val_="&category", _mod_=1);
144           %monitor(_var_=service,  _val_="&service",  _mod_=1);
145           %monitor(_var_=minweek,  _val_=&minwk,      _mod_=1);
146           %monitor(_var_=maxweek,  _val_=&maxwk,      _mod_=1);
147           /*** 20131121 : Performance monitoring *************/
148        
149           /*---------------------------------------------------------------------*/
150           /* Create Directory-structure according to service                     */
151           /*---------------------------------------------------------------------*/
152           %if %sysfunc(fileexist(&Prod_DirectoryOutput/aggregate/data/&service))=0 %then %do;
153              data _null_; x "mkdir &Prod_DirectoryOutput/aggregate/data/&service"; run;
154           %end;
155           %if &service=Combined %then %do;
156              %if %sysfunc(fileexist(&Prod_DirectoryOutput/aggregate/data/&service/period&period))=0 %then %do;
157                 data _null_; x "mkdir &Prod_DirectoryOutput/aggregate/data/&service/period&period"; run;
158               %end;
159           %end;
160           %if &service=Infoscan %then %do;
161              %if &Prod_OutputType ^= MONTH %then %do;
162                 %do j=&MinWk %to &MaxWk;
163                    %if %sysfunc(fileexist(&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))))=0 %then %do;
164                       data _null_; x "mkdir &Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))"; run;
165                    %end;
166                 %end;
167              %end;
168              %if %sysfunc(upcase(&Monthlyagg))=Y %then %do;
169                 %if %sysfunc(fileexist(&Prod_DirectoryOutput/aggregate/data/&service/period&period))=0 %then %do;
170                    data _null_; x "mkdir &Prod_DirectoryOutput/aggregate/data/&service/period&period"; run;
171                 %end;
172              %end;
173           %end;
174           %if &service=Promoscan %then %do;
175              %do j=&MinWk %to &MaxWk;
176                 %if %sysfunc(fileexist(&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))))=0 %then %do;
177                    data _null_; x "mkdir &Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))"; run;
178                 %end;
179              %end;
180           %end;
181        
182           /*---------------------------------------------------------------------*/
183           /* Initialize Output-area                                              */
184           /*---------------------------------------------------------------------*/
185           %if &service=Combined %then %do;
186              data _null_; x "rm &Prod_DirectoryOutput/aggregate/data/&service/period&period/&category..p&period      2>/dev/null"; run;
187              data _null_; x "rm &Prod_DirectoryOutput/aggregate/data/&service/period&period/geog.&category..p&period 2>/dev/null"; run;
188           %end;
189           %if &service=Infoscan %then %do;
190              %if &Prod_OutputType ^= MONTH %then %do;
191                 %do j=&MinWk %to &maxwk;
192                    data _null_; x "rm &Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))      2>/dev/null"; run;
193                    data _null_; x "rm &Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/geog.&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..))) 2>/dev/null"; run;
194                 %end;
195              %end;
196              %if %sysfunc(upcase(&Monthlyagg))=Y %then %do;
197                 data _null_; x "rm &Prod_DirectoryOutput/aggregate/data/&service/period&period/&category..p&period      2>/dev/null"; run;
198                 data _null_; x "rm &Prod_DirectoryOutput/aggregate/data/&service/period&period/geog.&category..p&period 2>/dev/null"; run;
199              %end;
200           %end;
201           %if &service=Promoscan %then %do;
202              %do j=&MinWk %to &maxwk;
203                 data _null_; x "rm &Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))      2>/dev/null"; run;
204                 data _null_; x "rm &Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/geog.&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..))) 2>/dev/null"; run;
205              %end;
206           %end;
207        
208           %readinputs;                         /* Read all input files*/
209           %datapreparation;                    /* Combine input files*/
210           %if &service=Promoscan %then %do;
211              %AGGREGATION_Promoscan;           /* Aggregate scanner data across levels*/
212              %setupmeasures_Promoscan;
213              %createmeasures;
214              %adddescriptions;
215              %outputs;
216           %end;
217           %else %if &service=Combined %then %do;
218              %AGGREGATION_Combined;
219              %createmeasures;
220              %adddescriptions;
221              %outputs;
222           %end;
223           %else %if &service=Infoscan %then %do;
224              %AGGREGATION_ISCAN;
225              %createmeasures;
226              %adddescriptions;
227              %outputs;
228           %end;
229        
230        %mend MAIN;
231        
232        *----------------------------------------------------------------------------------------------;
233        *--- READINPUTS MACRO: Reads input files to aggregation engine---------------------------------;
234        *----------------------------------------------------------------------------------------------;
235        
236        %macro READINPUTS;
237           /*%readperiod; - not defined as macro*/
238           %readkey(&category);
239        
240           /*** 20130906 : New conversion-file at subcategory-level - this step is moved to here from the end ***/
241           /* The readdesc_v9 file reads in the description file .dsc file*/
242           %readdesc_v10(&category);
243           proc sort data=desc(where=(lev1^=0 and lev2^=0 and lev3=0))
244                     out=desc_conv(keep=levname lev1 lev2) nodupkey;
245                     by levname;
246           run;
247           proc sort data=subkeycats                                 nodupkey; by levname;               run;
248           data subkeycats; merge subkeycats(in=a1) desc_conv(in=a2);          by levname; if a1 and a2; run;
249           proc sort data=subkeycats nodupkey;                                 by lev1 lev2;             run;
250           /*** 20130906 : New conversion-file at subcategory-level - this step is moved to here from the end ***/
251        
252           /* first argument is filename, second arguement is title for printed output*/
253           %printdeb(keycats,keycats from keycat file); run;
254        
255           %catspec(&category,&service);
256        
257           /*** 20131121 : Performance monitoring *****************/
258           %monitor(_var_=nr_measure,   _val_=&meascnt,    _mod_=1);
259           %monitor(_var_=nr_geography, _val_=&geocnt,     _mod_=1);
260           %monitor(_var_=nr_type,      _val_=&typecnt,    _mod_=1);
261           %monitor(_var_=bounding,     _val_="&unb_flag", _mod_=1);
262           /*** 20131121 : Performance monitoring *****************/
263        
264           /* read projections for SCANNER sample */
265           %if %sysfunc(exist(proj)) %then %do; proc delete data=proj; run; %end;
266           %do iw=&minwk %to &maxwk;
267              %readproj(&sample_name.week%eval(%sysfunc(putn(&iw,z&WEEK999LEN..))).csv, proj%eval(%sysfunc(putn(&iw,z&WEEK999LEN..))));
268              data proj%eval(%sysfunc(putn(&iw,z&WEEK999LEN..)));
269              set proj%eval(%sysfunc(putn(&iw,z&WEEK999LEN..)));
270              week=%eval(%sysfunc(putn(&iw,z&WEEK999LEN..)));
271              run;
272              proc append data= proj%eval(%sysfunc(putn(&iw,z&WEEK999LEN..))) base=proj;
273              proc delete data= proj%eval(%sysfunc(putn(&iw,z&WEEK999LEN..)));
274              run;
275           %end;
276        
277           /*** 20120709 : R. Walter : New Measure for Red Bull ***/
278           /*** 20150218 : A. AGOSTINELLI : consolidation of engines ***/
279           %global newmeasure_rb newmeasure_bat; %let newmeasure_rb=N; %let newmeasure_bat=N;
280        /*** changed due to error "The quoted string currently being processed has become more than 262 characters long" ***
281           data _null_;
282              length string $500 newmeasure_rb newmeasure_bat $1.;
283              string="&measlist";
284              if index(string,'245')>0 or index(string,'246')>0 or index(string,'247')>0 then do;
285                 newmeasure_rb='Y';
286                 call symput('newmeasure_rb', trim(left(newmeasure_rb)));
287              end;
288              if index(string,'248') or index(string,'249') or index(string,'250') or index(string,'251') or index(string,'252') or index(string,'253') then do;
289                 newmeasure_bat='Y';
290                 call symput('newmeasure_bat', trim(left(newmeasure_bat)));
291              end;
292           run;
293        *** changed due to error "The quoted string currently being processed has become more than 262 characters long" ***/
294           data _null_;
295              length string $3. newmeasure_rb newmeasure_bat $1.;
296              %do hh=1 %to &meascnt;
297                 string="%scan(&measlist,&hh)";
298                 if index(string,'245')>0 or index(string,'246')>0 or index(string,'247')>0 then do;
299                    newmeasure_rb='Y';
300                    call symput('newmeasure_rb', trim(left(newmeasure_rb)));
301                 end;
302                 if index(string,'248') or index(string,'249') or index(string,'250') or index(string,'251') or index(string,'252') or index(string,'253') then do;
303                    newmeasure_bat='Y';
304                    call symput('newmeasure_bat', trim(left(newmeasure_bat)));
305                 end;
306              %end;
307           run;
308        /*** changed due to error "The quoted string currently being processed has become more than 262 characters long" ***/
309        
310           %if &newmeasure_rb=Y %then %do;
311              %do iw=&minwk %to &maxwk;
312                 %readnumeric(&sample_name.week%eval(%sysfunc(putn(&iw,z&WEEK999LEN..))).num, numerical%eval(%sysfunc(putn(&iw,z&WEEK999LEN..))));
313                 data numerical%eval(%sysfunc(putn(&iw,z&WEEK999LEN..))); set numerical%eval(%sysfunc(putn(&iw,z&WEEK999LEN..))); week=%eval(%sysfunc(putn(&iw,z&WEEK999LEN..))); run;
314                 proc append data=numerical%eval(%sysfunc(putn(&iw,z&WEEK999LEN..))) base=numerical;  run;
315                 proc delete data=numerical%eval(%sysfunc(putn(&iw,z&WEEK999LEN..)));                 run;
316              %end;
317              proc sort         data=numerical nodupkey;                 by week g1 s1;                   run;
318              proc sort         data=proj out=num_check nodupkey;        by week g1 s1;                   run;
319              data num_missing; merge numerical(in=a1) num_check(in=a2); by week g1 s1; if a2 and not a1; run;
320              data _null_;
321                 set num_missing end=last;
322                 put "ERROR: Missing storecount for " WEEK= " - " G1= " - " S1=;
323                 if last then do;
324               put "ERROR: Please contact the MS-department in order to correct the numerical-file(s)";
325               abort abend;
326                 end;
327              run;
328           %end;
329           /*** 20120926 : R. Walter : Import stock- and ean-file (only for BAT) ***/
330           %if &service=Promoscan %then %do;
331              %if &newmeasure_bat=Y %then %do;
332                 %let maxwk_1 = %eval(%sysfunc(putn(%eval(&maxwk - 1),z&WEEK999LEN..)));
333                 %let filecheck=0;
334                 %if %sysfunc(fileexist(&Prod_DirectoryData/&category.week&maxwk..stock)) = 0 %then %do;
335                    %put ERROR: Missing file (&Prod_DirectoryData/&category.week&maxwk..stock) - please verify and restart;
336                    %let filecheck=1;
337                 %end;
338                 %if %sysfunc(fileexist(&Prod_DirectoryData/&category.week&maxwk_1..stock)) = 0 %then %do;
339                    %put ERROR: Missing file (&Prod_DirectoryData/&category.week&maxwk_1..stock) - please verify and restart;
340                    %let filecheck=1;
341                 %end;
342                 %if %sysfunc(fileexist(&Prod_DirectoryData/&category.week&maxwk..audit)) = 0 %then %do;
343                    %put ERROR: Missing file (&Prod_DirectoryData/&category.week&maxwk..audit) - please verify and restart;
344                    %let filecheck=1;
345                 %end;
346                 %if &filecheck=1 %then %do; data _null_; abort abend; run; %end;
347                 %else %do;
348                    /* read list of ean in audit */
349                    data eanaudit(keep=ean);
350                       infile "&Prod_DirectoryData/&category.week&maxwk..audit" pad;
351                       input @22 s     2.
352                             @25 g     2.
353                             @28 v     5.
354                             @34 i     5.;
355                       ean=input(put(s,z2.),$2.) !! input(put(g,z2.),$2.) !! input(put(v,z5.),$5.) !! input(put(i,z5.),$5.);
356                    run;
357        
358                    %if &syserr = 0 %then %do;
359                       %put USER-NOTE: File (&Prod_DirectoryData/&category.week&maxwk..audit) imported;
360                    %end;
361                    %else %do;
362                       %put ERROR: Importing file (&Prod_DirectoryData/&category.week&maxwk..audit) failed;
363                       data _null_; endsas; run;
364                    %end;
365        
366                    proc sort data=eanaudit nodupkey; by ean; run;
367                    %let dsid     = %sysfunc(open(eanaudit));
368                    %let eanaudit = %sysfunc(attrn(&dsid,nlobs));
369                    %let rc       = %sysfunc(close(&dsid));
370                    %if &eanaudit = 0 %then %do;
371                       %put WARNING: No ean in audit found for period &maxwk - process continues without data;
372                    %end;
373                    /* read stock-information from current period */
374                    data stock_curr(keep=store ean stock_curr);
375                       infile "&Prod_DirectoryData/&category.week&maxwk..stock" pad;
376                       input @01 store 5. @32 s 2. @35 g 2. @38 v 5. @44 i 5. @52 stock_curr 1.;
377                       ean=input(put(s,z2.),$2.) !! input(put(g,z2.),$2.) !! input(put(v,z5.),$5.) !! input(put(i,z5.),$5.);
378                    run;
379        
380                    %if &syserr = 0 %then %do;
381                       %put USER-NOTE: File (&Prod_DirectoryData/&category.week&maxwk..stock) imported;
382                    %end;
383                    %else %do;
384                       %put ERROR: Importing file (&Prod_DirectoryData/&category.week&maxwk..stock) failed;
385                       data _null_; endsas; run;
386                    %end;
387        
388                    proc sql; delete from stock_curr where ean not in (select ean from eanaudit); quit;
389                    %let dsid       = %sysfunc(open(stock_curr));
390                    %let stock_curr = %sysfunc(attrn(&dsid,nlobs));
391                    %let rc         = %sysfunc(close(&dsid));
392                    %if &stock_curr = 0 %then %do;
393                       %put WARNING: No stock information found for period &maxwk - process continues without data;
394                    %end;
395                    /* read stock information from previous period */
396                    data stock_prev(keep=store ean stock_prev);
397                       infile "&Prod_DirectoryData/&category.week&maxwk_1..stock" pad;
398                       input @01 store 5. @32 s 2. @35 g 2. @38 v 5. @44 i 5. @52 stock_prev 1.;
399                       ean=input(put(s,z2.),$2.) !! input(put(g,z2.),$2.) !! input(put(v,z5.),$5.) !! input(put(i,z5.),$5.);
400                    run;
401        
402                    %if &syserr = 0 %then %do;
403                       %put USER-NOTE: File (&Prod_DirectoryData/&category.week&maxwk_1..stock) imported;
404                    %end;
405                    %else %do;
406                       %put ERROR: Importing file (&Prod_DirectoryData/&category.week&maxwk_1..stock) failed;
407                       data _null_; endsas; run;
408                    %end;
409        
410                    proc sql; delete from stock_prev where ean not in (select ean from eanaudit); quit;
411                    %let dsid       = %sysfunc(open(stock_prev));
412                    %let stock_prev = %sysfunc(attrn(&dsid,nlobs));
413                    %let rc         = %sysfunc(close(&dsid));
414                    %if &stock_prev = 0 %then %do;
415                       %put WARNING: No stock information found for period &maxwk_1 - process continues without data;
416                    %end;
417                    /**/
418                    proc sort data=stock_curr nodupkey;      by store ean; run;
419                    proc sort data=stock_prev nodupkey;      by store ean; run;
420                    data stock; merge stock_curr stock_prev; by store ean; run;
421                    proc sort data=stock nodupkey;           by store ean; run;
422                    data _null_;
423                       length cmd $100.;
424                       cmd = "USER-NOTE: Number of rows selected for for eanaudit                   : " !! right(input(put(&eanaudit,   commax10.0),$10.)); put cmd;
425                       cmd = "USER-NOTE: Number of rows selected for for stock (current  period)    : " !! right(input(put(&stock_curr, commax10.0),$10.)); put cmd;
426                       cmd = "USER-NOTE: Number of rows selected for for stock (previous period)    : " !! right(input(put(&stock_prev, commax10.0),$10.)); put cmd;
427                    run;
428                 %end;
429              %end;
430           %end;
431           /*** 20120926 : R. Walter : Import stock- and ean-file (only for BAT) ***/
432           /*** 20120709 : R. Walter : New Measure for Red Bull ***/
433           /*** 20150218 : A. AGOSTINELLI : consolidation of engines ***/
434        
435           /* new added A.A.28.10.2003 */
436           /* determine the keycat of the eans of the client category */
437           /* then set a macro variable &kclist that contains the list of keycats */
438           /* and use that list to subselect the input of scanner data */
439           %readcode_v10(&category);      /*reads code and sectot files with EANcode included*/
440        
441           /*** 20131121 : Performance monitoring *********************************************/
442           %monitor(_var_=secondary_total, _val_= %if &sectot > 0 %then %do; "Y" %end; %else %do; "N" %end;, _mod_=1);
443           %monitor(_var_=nr_level,        _val_=&levels,                              _mod_=1);
444           %monitor(_var_=record_cde,      _val_=work.code,                            _mod_=2);
445           /*** 20131121 : Performance monitoring *********************************************/
446        
447           %readitem;
448        
449           /*** 20131121 : Performance monitoring **************/
450           %monitor(_var_=record_item, _val_=work.item, _mod_=2);
451           /*** 20131121 : Performance monitoring **************/
452        
453           /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
454           %sortem(item(keep=ean vol1 vol2 vol3 vol4 sku keycat packtype wkadd) nodupkey,ean);
455           /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
456        
457           %sortem(code(drop=item),ean);           /*dropping item because numeric in one dataset and character in another*/
458           %sortem(code(keep=ean) out=eanlist,ean);   /*creating list of unique EANs from code and secttot files*/
459        
460           %if &sectot > 0 %then %do;
461              data eanlist;
462                 set eanlist sectot(keep=ean);
463              run;
464           %end;
465           %sortem(eanlist nodupkey,ean);
466           %matchmerge (item,item,eanlist,ean);   /* merge dictionary and unique EAN list to get subsetted dict*/
467        
468           %sortem(item(keep=keycat) nodupkey out=kclist,keycat);  /*A.A.28.10.2003 */
469           data kclist;
470           set kclist end=fine;
471           length kclist $2000.;
472           retain kclist;
473           kclist=compbl(kclist || keycat);
474           if fine then do;
475           call symput("kclist", compbl(kclist));
476           end;
477           run;                                      /* end new added A.A.28.10.2003 */
478        
479           /*read Master files for service selected*/
480           %if &SERVICE=Promoscan %then %do;
481              /* read separately the files of mastcan, in order to have lighter files to sort */
482              %if %sysfunc(exist(mastscan)) %then %do; proc delete data=mastscan; run; %end;
483              %do wki = &minwk %to &maxwk;
484                 %readmastscan(%eval(%sysfunc(putn(&wki,z&WEEK999LEN..))), /*&kclist*/);  /*read in 8 single weekly Scanner Master files*/   /*** 20160422 : eliminate KEYCAT-filter ***/
485                 proc sql;
486                 create table _mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..)))(drop=_ean)
487                 as select b.*, a.*
488                 from code(rename=ean=_ean) a, mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..))) b
489                 where b.ean=a._ean;
490                 quit;
491                 proc append data=_mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..))) base=mastscan; run;
492                 proc delete data=_mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..)));               run;
493              %end;
494           %end;
495           %else %if &SERVICE=Combined %then %do;
496              %readdays(&period);           /*required for Audit service*/
497              %readmastaudit(&period);      /*read audit data for bi-month */
498              /* read separately the files of mastcan, in order to have lighter files to sort */
499              %if %sysfunc(exist(mastscan)) %then %do; proc delete data=mastscan; run; %end;
500              %do wki = &minwk %to &maxwk;
501                 %readmastscan(%eval(%sysfunc(putn(&wki,z&WEEK999LEN..))), /*&kclist*/);   /*read in 8 single weekly Scanner Master files*/   /*** 20160422 : eliminate KEYCAT-filter ***/
502                 proc sql;
503                 create table _mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..)))(drop=_ean)
504                 as select b.*, a.*
505                 from code(rename=ean=_ean) a, mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..))) b
506                 where b.ean=a._ean;
507                 quit;
508                 proc append data=_mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..))) base=mastscan; run;
509                 proc delete data=_mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..)));               run;
510              %end;
511              /* read projections and universe for Audit sample */
512              %readproj(&sample,proj_a);
513              data proj_a;
514              set proj_a;
515              week=&maxwk;
516              run;
517              /* select only stores that are not already included in scanner projections */
518              %sortem(proj_a,store);
519              %sortem(proj_a(keep=store) nodupkey out=sto_a,store);
520              %sortem(proj(keep=store week where=(week=&maxwk)) nodupkey out=sto_s,store);
521              data sto_a;
522              merge sto_a(in=aa) sto_s(in=bb);
523              by store;
524              if aa and not bb;
525              keep store;
526              run;
527              %sortem(sto_a,store);
528              %matchmerge (proj_a,proj_a,sto_a,store);
529              data proj;
530              set proj proj_a;
531              run;
532              proc delete data=proj_a;
533              run;
534              %printdeb(proj,obs from projection file);
535              run;
536           %end;
537           %else %if &SERVICE=Infoscan %then %do;
538              /* read separately the files of mastcan, in order to have lighter files to sort */
539              %if %sysfunc(exist(mastscan)) %then %do; proc delete data=mastscan; run; %end;
540              %do wki = &minwk %to &maxwk;
541                 %readmastscan(%eval(%sysfunc(putn(&wki,z&WEEK999LEN..))), /*&kclist*/);   /*read in 8 single weekly Scanner Master files*/   /*** 20160422 : eliminate KEYCAT-filter ***/
542                 proc sql;
543                 create table _mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..)))(drop=_ean)
544                 as select b.*, a.*
545                 from code(rename=ean=_ean) a, mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..))) b
546                 where b.ean=a._ean;
547                 quit;
548                 proc append data=_mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..))) base=mastscan; run;
549                 proc delete data=_mastscan%eval(%sysfunc(putn(&wki,z&WEEK999LEN..)));               run;
550              %end;
551              data mastscan;
552              set mastscan;
553              period=&period;
554              run;
555           %end;
556        
557           /*** 20131121 : Performance monitoring **********************/
558           %monitor(_var_=record_mastscan, _val_=work.mastscan, _mod_=2);
559           /*** 20131121 : Performance monitoring **********************/
560        
561           %readgeog(&category,&glev,&slev);
562        
563           %readstore;
564           data store;
565           set store;
566           keep store sqrmtr storetype;
567           run;
568        
569           %readcatmax(&category);
570        
571           /*** 20131121 : Performance monitoring ***/
572           %monitor(_mod_=4);
573           /*** 20131121 : Performance monitoring ***/
574        
575           /*** 20120926 : R. Walter : Add missing combinations of store/ean (audited) to masterfile (only for BAT) ***/
576           %if &service=Promoscan %then %do;
577              %if "&newmeasure_bat"="Y" %then %do;
578                 proc sql;
579                    create table ko as select store, ean from stock where stock_curr=. and store in (select store from proj);
580                 quit;
581                 data _null_;
582                    set ko end=last;
583                    put "ERROR: Current stock-information not available for audited EAN - " STORE= " - " EAN=;
584                    if last then do;
585                       put "ERROR: Correct the input-files and restart the process";
586                       abort abend;
587                    end;
588                 run;
589                 proc sort data=mastscan(keep=store ean week) out=_base_1 nodupkey;      by store ean week;              run;
590                 proc sql; delete from _base_1 where store not in (select store from proj); quit;
591                 proc sql noprint; select count(distinct(store)) into: store_masterfile from _base_1; quit;
592                 data _null_;
593                    length cmd $100.;
594                    cmd = "USER-NOTE: Number of STORES in Masterfile (projected)                 : " !! right(input(put(&store_masterfile, commax10.0),$10.)); put cmd;
595                 run;
596                 proc sort data=_base_1(keep=store week) out=_base_2 nodupkey;           by store week;                  run;
597                 proc sql noprint; create table _base_3 as select * from _base_2, eanaudit order by store, ean;         quit;
598                 data _base_3; merge _base_3(in=a1) stock(in=a2);                        by store ean; if a1 and a2;     run;
599                 data _base_4(keep=store ean week); merge _base_1(in=a1) _base_3(in=a2); by store ean; if not a1 and a2; run;
600                 data _base_4;  set _base_4; units=0; price=0; value=0; keycat=0; period=week;                           run;
601                 proc sql noprint; select count(distinct(store)) into: store_toadd from _base_4; quit;
602                 data _null_;
603                    length cmd $100.;
604                    cmd = "USER-NOTE: Number of STORES with missing EAN but available stock-info : " !! right(input(put(&store_toadd, commax10.0),$10.)); put cmd;
605                 run;
606                 proc sort data=code out=_code nodupkey;          by ean;               run;
607                 proc sort data=_base_4;                          by ean;               run;
608                 data _base_4; merge _base_4(in=a1) _code(in=a2); by ean; if a1 and a2; run;
609                 data mastscan; set mastscan _base_4; run;
610              %end;
611           %end;
612           /*** 20120926 : R. Walter : Add missing combinations of store/ean (audited) to masterfile (only for BAT) ***/
613        
614        %mend READINPUTS;
615        
616        
617        *----------------------------------------------------------------------------------------------;
618        *--- DATAPREPARATION MACRO: Prepare Data for Aggregation ---------------------------------------;
619        *----------------------------------------------------------------------------------------------;
620        %macro DATAPREPARATION;
621        
622           /* SUBSETMASTER MACRO: Subset Master file by Code file*/
623           %macro subsetmaster;
624        
625           %if &SERVICE=Combined %then %do;
626        
627        *   %sortem(item nodupkey out=skulist(keep=ean sku vol1 vol2 vol3 vol4),sku); /* Commented out by Souzas on 2506 */
628        
629        /* arbitrarily only keeping one of EANs mapping to SKU*/
630        /* all EANs will be in code file so OK since aggrgeating up to SKU level*/
631        /* added vol1-vol4 to have volumes*/
632        
633        /* Start insert by Souzas on 2506*/
634        
635        * %sortem(item nodupkey out=skulist(keep=ean sku),sku);  /*Commented out by Souzas on 1704*/
636        
637        /* Start insert by Souzas on 1704 */
638        
639        data item_4audit;
640         length sku $8.;
641        
642        %if &WEEK999LEN = 3 %then %do;
643         infile "&Prod_DirectoryInputItem/item"  recfm=f lrecl=224;
644         input
645          @1 sys         2.    /* System number (A) */
646          @3 gen         2.    /* Generation number (IRI created) (A) */
647          @5 vendor      5.    /* Vendor number (Manufacturer identifier) (A) */
648          @10 item       5.    /* Item number (Product identifier) (A) */
649          @15 desc     $36.    /* Description of product (M) */
650          @51 volume     5.    /* Volume of product (M) */
651          @56 vol_type  $2.    /* Volume unit of measurement (eg., ml, gr, oz) (M) */
652          @58 wkadd      3.    /* Week product was added to the dictionary (A) */
653          @61 wk_lmove   3.    /* Week product last moved (A) */
654          @64 price      6.    /* Price per unit (M) */
655          @70 new_item   1.    /* Product is considered new to the dictionary (A) */
656          @71 complete   1.    /* Products dictionary record is complete (M) */
657          @72 volcount   3.    /* Number of items in pack (eg., 2, 4, 6-pack) (M) */
658          @75 packtype  $2.    /* Regular Pack (RP), Special Pack (SP), etc. (M) */
659          @77 keycat     4.    /* Category number (M?) */
660          @81 brand    $20.    /* Brand (M) */
661          @101 company  $30.    /* Company name (M) */
662          @131 prntcomp $30.   /* Parent company */
663          @161 prodtype $10.   /* Product type (eg., liquid, powder, concentrate) (M)*/
664          @171 wraptype $10.   /* Packaging type (eg., plastic) (M)*/
665          @181 movecnt    3.   /* Count of the number of times the item has moved (A)*/
666          @184 sku2      $8.     /*new Retail Audit SKU code*/
667          @192 vol1   8.2
668          @200 vol2   8.2
669          @208 vol3   8.2
670          @216 vol4   8.2
671          ;
672        %end;
673        %else %if &WEEK999LEN = 4 %then %do;
674         infile "&Prod_DirectoryInputItem/item"  recfm=f lrecl=226;
675         input
676          @1 sys         2.    /* System number (A) */
677          @3 gen         2.    /* Generation number (IRI created) (A) */
678          @5 vendor      5.    /* Vendor number (Manufacturer identifier) (A) */
679          @10 item       5.    /* Item number (Product identifier) (A) */
680          @15 desc     $36.    /* Description of product (M) */
681          @51 volume     5.    /* Volume of product (M) */
682          @56 vol_type  $2.    /* Volume unit of measurement (eg., ml, gr, oz) (M) */
683          @58 wkadd      4.    /* Week product was added to the dictionary (A) */
684          @62 wk_lmove   4.    /* Week product last moved (A) */
685          @66 price      6.    /* Price per unit (M) */
686          @72 new_item   1.    /* Product is considered new to the dictionary (A) */
687          @73 complete   1.    /* Products dictionary record is complete (M) */
688          @74 volcount   3.    /* Number of items in pack (eg., 2, 4, 6-pack) (M) */
689          @77 packtype  $2.    /* Regular Pack (RP), Special Pack (SP), etc. (M) */
690          @79 keycat     4.    /* Category number (M?) */
691          @83 brand    $20.    /* Brand (M) */
692          @103 company  $30.    /* Company name (M) */
693          @133 prntcomp $30.   /* Parent company */
694          @163 prodtype $10.   /* Product type (eg., liquid, powder, concentrate) (M)*/
695          @173 wraptype $10.   /* Packaging type (eg., plastic) (M)*/
696          @183 movecnt    3.   /* Count of the number of times the item has moved (A)*/
697          @186 sku2      $8.     /*new Retail Audit SKU code*/
698          @194 vol1   8.2
699          @202 vol2   8.2
700          @210 vol3   8.2
701          @218 vol4   8.2
702          ;
703        %end;
704        
705         drop price;
706         EAN=put(sys,z2.)||put(gen,z2.)||put(vendor,z5.)||put(item,z5.);
707         drop item;
708         /*add zeros to front of SKU code if less than 8 characters in length*/
709         l=length(sku2);
710         sku=sku2;
711         if l=5 then do; sku='000'||sku2; end;
712         if l=6 then do; sku='00' ||sku2; end;
713         if l=7 then do; sku='0'  ||sku2; end;
714         drop sku2;
715         drop l;   /*added by souzas*/
716         *  drop sys gen vendor item desc volume vol_type wkadd wk_lmove price new_item complete volcount packtype keycat brand company prntcomp prodtype wraptype movecnt vol1 vol2 vol3 vol4;  /*Commented out by Souzas 0n 2009*/
717          drop sys gen vendor item desc volume vol_type wkadd wk_lmove price new_item complete volcount packtype keycat brand company prntcomp prodtype wraptype movecnt sku vol1 vol2 vol3 vol4;  /*Added by Souzas 0n 2009*/
718         run;
719        
720           %if &syserr = 0 %then %do;
721              %put USER-NOTE: File (&Prod_DirectoryInputItem/item) imported;
722           %end;
723           %else %do;
724              %put ERROR: Importing file (&Prod_DirectoryInputItem/item) failed;
725              data _null_; endsas; run;
726           %end;
727        
728         proc sort data=item_4audit nodupkey;
729         by ean;
730         run;
731        
732        
733        /* Start insert by Souzas on 2009 */
734        
735        data rawhier6;
736           infile "&Prod_DirectoryCategories/&category..csv" delimiter=',' dsd lrecl=2000 missover;
737           %if &sectot^=0 %then %do;
738              %do x=1 %to &levels; length l&x $15; length ld&x $40; %end;
739              %do y=1 %to &sectot; length s&y $15; length sd&y $40; %end;
740           %end;
741           %else %do;
742              %do x=1 %to &levels; length l&x $15; length ld&x $40; %end;
743           %end;
744           input
745              %do x=1 %to &levels; l&x $ ld&x $ %end;
746              %do y=1 %to &sectot; s&y $ sd&y $ %end;
747           ;
748           lnum=_n_;
749           %do b=1 %to &levels; l&b=upcase(l&b); %end;
750        run;
751        
752           %if &syserr = 0 %then %do;
753              %put USER-NOTE: File (&Prod_DirectoryCategories/&category..csv) imported;
754           %end;
755           %else %do;
756              %put ERROR: Importing file (&Prod_DirectoryCategories/&category..csv) failed;
757              data _null_; endsas; run;
758           %end;
759        
760            data eansku6;
761            set rawhier6(keep=l1 l2);
762            length ean $14;
763            length _sku $14 sku $8.;
764            ean =substr(l1,2,14);
765            _sku=substr(l2,2,14);
766            l=length(_sku);
767            if l ne 8 then delete;
768            sku=substr(_sku,1,8);
769            drop l l1 l2 _sku;
770            run;
771        
772        
773        proc sort data=eansku6 out=eansku6 nodupkey ; by ean;
774        run;
775        
776        
777        data item_4audit;
778         merge item_4audit (in=a) eansku6 (in=b) ;
779         by EAN;
780         if a;
781        run;
782        
783        /* End insert by Souzas on 2009 */
784        
785        
786        
787        
788               %sortem(code,ean);
789               %matchmerge (item_4audit,item_4audit,code,ean);   /* merge master and code file*/
790        
791        proc sort data=item_4audit nodupkey;
792        by sku;
793        run;
794        
795        
796        
797        *%sortem(item_4audit,sku); /*I added the above three lines instead*/
798        
799        
800        
801        
802        *data skulist;
803        *set item_4audit;
804        *if sys=25;
805        *run;
806        
807        *%sortem(skulist nodupkey out=skulist(keep=ean sku),sku);
808        
809        *%sortem(item_4audit nodupkey out=skulist(keep=ean sku),sku);
810        
811        /* End insert by Souzas on 1704 */
812        
813         data raitem;
814         infile "&Prod_DirectoryInputItem/ra_itemmast";
815         input
816         @1 sku      $8.
817         @9 comp     $3.
818         @12 desc    $12.
819         @24 vol1    5.
820         @30 vol2    8.2
821         @39 vol3    8.2
822         @48 vol4    8.2
823         @56 price   7.
824         ;
825         drop comp desc price;
826         run;
827        
828           %if &syserr = 0 %then %do;
829              %put USER-NOTE: File (&Prod_DirectoryInputItem/ra_itemmast) imported;
830           %end;
831           %else %do;
832              %put ERROR: Importing file (&Prod_DirectoryInputItem/ra_itemmast) failed;
833              data _null_; endsas; run;
834           %end;
835        
836        proc sort data=raitem;
837        by sku;
838        run;
839        
840        %matchmerge (item_4audit,item_4audit,raitem,sku);
841        
842        /* End insert by Souzas on 2506*/
843        
844        
845        
846              %sortem(mastaudit,sku);
847              proc sort data=item_4audit nodupkey;
848              by sku;
849              run;
850        
851        *%sortem(item_4audit,sku); /*I added the above three lines instead*/
852        
853               %matchmerge (mastaudit,mastaudit,item_4audit,sku);   /*merge audit data and dictionary*/
854        
855               %sortem(mastaudit,ean);
856        *       %sortem(code,ean);
857        *       %matchmerge (mastaudit,mastaudit,code,ean);   /* merge master and code file*/
858        
859               /*scanner data*/
860               %apply_unb( _master_ = mastscan,
861                             _item_ = item,
862                         _category_ = &category,
863                        _prod_flag_ = &unb_flag,
864                         _service_  = &service,
865                            maxweek = &maxwk,
866                            minweek = &minwk
867                             );     /* apply unbundling */
868        
869        
870               %sortem(mastscan,ean);
871               %sortem(item,ean);
872        
873            /* Start insert by Souzas on 2009 */
874        
875               %sortem(item(keep=ean vol1 vol2 vol3 vol4 keycat) nodupkey,ean);
876        
877               data item;
878               merge item (in=a) eansku6 (in=b) ;
879               by EAN;
880               if a;
881               run;
882        
883             /* End insert by Souzas on 2009 */
884        
885               %matchmerge (mastscan,mastscan,item,ean);    /* merge scanner data and dictionary*/
886        
887        /* Start commenting out by Souzas on 2506 */
888        
889        /*       proc summary data=mastscan noprint nway;
890                         class store week sku;
891                         id ean vol1-vol4;                           /*keep EAN to merge with code file again to get level codes*/
892        /*                 var units value numfac lenfac;
893                         output out=smaster(drop=_type_ _freq_) sum= ;
894               run;
895        
896        /* End commenting out by Souzas on 2506 */
897        
898        
899        /* Start commenting out by Souzas on 2506 */
900           data smaster;
901           set mastscan;
902           keep store week sku ean vol1 vol2 vol3 vol4 units value numfac lenfac;
903           run;
904        
905        /* End commenting out by Souzas on 2506 */
906        
907        
908               /* set separately audit and scanner for Combined service */
909               data mastscan;
910               set smaster;
911               period=&period;
912               run;
913        
914               data master;
915               set mastaudit;
916               week=&maxwk;
917               period=&period;
918               run;
919        
920           %end;
921        
922           %else %if &service=Promoscan %then %do;
923              %sortem(mastscan,ean);
924              %matchmerge (master,mastscan,code,ean);   /* merge master and code file by item and subset by item*/
925              %apply_unb(_master_    = master,
926                         _item_      = item,
927                         _category_  = &category,
928                         _prod_flag_ = &unb_flag,
929                         _service_   = &service,
930                         maxweek     = &maxwk,
931                         minweek     = &minwk
932                        );     /* apply unbundling */
933           %end;
934           %else %if &service=Infoscan %then %do;
935              %sortem(mastscan,ean);
936              %matchmerge (master,mastscan,code,ean);    /* merge master and code file by item and subset by item*/
937              %apply_unb(_master_   = master,
938                         _item_     = item,
939                         _category_ = &category,
940                         _prod_flag_= &unb_flag,
941                         _service_  = &service,
942                         maxweek    = &maxwk,
943                         minweek    = &minwk
944                        );     /* apply unbundling */
945           %end;
946        
947           /*** 20131121 : Performance monitoring ***/
948           %monitor(_mod_=4);
949           /*** 20131121 : Performance monitoring ***/
950        
951        %mend subsetmaster;
952        %subsetmaster;
953        
954        
955        /* MERGEPROJ MACRO: Merge projections with geography file by g1 s1*/
956        %macro mergeproj;
957        
958           %sortem(proj,store);
959           %sortem(store nodupkey,store);
960           %matchmerge (proj,proj,store,store);         /* merge proj and storemaster by store*/
961        
962           %sortem(proj,g1);
963           %sortem(gcode,g1);
964           %matchmerge (proj,proj,gcode,g1);            /* merge proj and gcode by g1*/
965        
966           %sortem(proj,s1);
967           %sortem(scode,s1);
968           %matchmerge (proj,proj,scode,s1);            /* merge proj and scode by s1*/
969        
970           /* assign factor for numeric distribution */
971        
972           %if &service=Combined %then %do;
973              /* calculates the numeric factor as the minimum of weekly factors per store */
974              proc summary data=proj sum nway;
975              class store;
976              var factor;
977              output out=projmin(drop=_type_ _freq_) min=minfactor;
978              run;
979              %sortem(proj,store week);
980              %sortem(projmin,store);
981              %matchmerge (proj,proj,projmin,store);
982           %end;
983            %else
984           %if &service=Infoscan %then %do;
985              data proj;
986              set proj;
987              minfactor=factor;
988              run;
989           %end;
990           %else
991           %if &service=Promoscan %then %do;
992              data proj;
993              set proj;
994              minfactor=factor;
995              run;
996           %end;
997        
998           data projs;
999           set proj;
1000          run;
1001       
1002         %sortem(proj,g1 s1 week);
1003       
1004         data proj;
1005         set proj;
1006         rename
1007         %do yt=1 %to &slev;
1008          s&yt=st&yt
1009         %end;
1010         %do zx=1 %to &glev;
1011          g&zx=gc&zx
1012         %end;;
1013       
1014         numult=minfactor;        /*"numeric factor" is equal to "min factor"*/
1015         drop minfactor;
1016         run;
1017       
1018         data proj;
1019         set proj;
1020         %do uk=1 %to &glev;
1021          %do uz=1 %to &slev;
1022           s1=st&uz ;
1023           g1=gc&uk ;
1024           drop gc&uk st&uz;
1025           output;
1026          %end;
1027         %end;
1028         proc sort;by g1 s1 week ;
1029       
1030       
1031         /*Calculate number of universe stores per geography-store type*/
1032          %if &service=Combined %then %do;
1033              proc sort data=proj(keep=store g1 s1 week numult) out=projsum nodupkey;
1034              by store g1 s1 ;
1035              run;
1036       
1037              data projsum;
1038              set projsum;
1039              week=&maxwk;
1040              run;
1041       
1042              proc summary data=projsum sum nway;
1043                class  g1 s1 ;
1044                var numult;
1045                id week; /* = max week of Combined: kept only for consistency with further programs */
1046                output out=numdenom(drop=_type_ _freq_) sum=regfact;/*NUMDENOM: contains num universe stores*/
1047              run;                                                /*REGFACT used for numerical distribution*/
1048          %end;
1049           %else
1050          %if &service=Infoscan %then %do;
1051               data projsum; set proj;
1052               output;
1053               %if %sysfunc(upcase(&Monthlyagg))=Y %then %do; week=0; output; %end;
1054               keep g1 s1 week store numult;
1055               run;
1056       
1057               proc summary data=projsum sum nway;
1058                   class g1 s1 week store ;
1059                   var numult;
1060                   output out=projsum(drop=_type_ _freq_) min=numult;
1061                   run;
1062       
1063               proc summary data=projsum sum nway;
1064                   class g1 s1 week ;
1065                   var numult;
1066                   output out=numdenom(drop=_type_ _freq_) sum=regfact;/*NUMDENOM: contains num universe stores*/
1067                   run;                                                 /*REGFACT used for numerical distribution*/
1068       
1069          %end;
1070          %else
1071          %if &service=Promoscan %then %do;
1072              proc summary data=proj;   /*NUMULT= # universe stores/# sample stores*/
1073                  by   g1 s1 week;
1074                  var numult;
1075                  output out=numdenom(drop=_type_ _freq_) sum=regfact;/*NUMDENOM: contains num universe stores*/
1076                  run;                                                /*REGFACT used for numerical distribution*/
1077          %end;
1078        run;
1079       
1080       
1081          /*** 20131121 : Performance monitoring ***/
1082          %monitor(_mod_=4);
1083          /*** 20131121 : Performance monitoring ***/
1084       
1085       
1086       %mend mergeproj;
1087       %mergeproj;
1088       
1089       
1090        /* MERGMAST MACRO: Merge Master files with projections,days,universe and dictionary files*/
1091       %macro mergmast;
1092       
1093       %if &service=Combined %then
1094           %do;
1095               %sortem(master, week store);
1096               %sortem(mastscan, week store);
1097               %sortem(projs, week store);                    /* note that projection file and universe files change week to week */
1098               %matchmerge (master,master,projs,week store);   /* merge master and projs by week store */
1099               %matchmerge (mastscan,mastscan,projs,week store);  /* merge master scanner and projs by week store */
1100               /*** 20160113 - Additional check in order to guarantee that mf and proj are ok ***/
1101               %if &sysnobs = 0 %then %do;
1102                  %put DEBUG: No data found after merge between MASTER and PROJECTION - check logfile;
1103                  /*** 20160203 : %put ERROR: No data found after merge between MASTER and PROJECTION - check logfile; ***/
1104                  /*** 20160203 : do not stop anymore : data _null_; endsas; run; ***/
1105               %end;
1106               /*** 20160113 - Additional check in order to guarantee that mf and proj are ok ***/
1107       
1108               %printdeb(master,obs from master file after merging with projection file);run;
1109               %printdeb(mastscan,obs from master file SCANNER after merging with projection file);run;
1110       
1111               %sortem(master,g1 s1 week);
1112                     data master;
1113                      set master;
1114                      rename
1115                      %do et=1 %to &slev;
1116                        s&et=st&et
1117                      %end;
1118                      %do ex=1 %to &glev;
1119                        g&ex=gc&ex
1120                      %end;;
1121                         run;
1122                         data master;
1123                         set master;
1124                          %do hk=1 %to &glev;
1125                            %do zh=1 %to &slev;
1126                              g1=gc&hk ;
1127                              s1=st&zh ;
1128                                  drop gc&hk st&zh;
1129                              output;
1130                            %end;
1131                          %end;
1132                     run;
1133       
1134                     data mastscan;
1135                      set mastscan;
1136                      rename
1137                      %do et=1 %to &slev;
1138                        s&et=st&et
1139                      %end;
1140                      %do ex=1 %to &glev;
1141                        g&ex=gc&ex
1142                      %end;;
1143                          run;
1144                         data mastscan;
1145                          set mastscan;
1146                          %do hk=1 %to &glev;
1147                            %do zh=1 %to &slev;
1148                              g1=gc&hk ;
1149                              s1=st&zh ;
1150                                  drop gc&hk st&zh;
1151                              output;
1152                            %end;
1153                          %end;
1154                     run;
1155       
1156       
1157         %end;
1158           %else
1159                %if &service=Promoscan or &service=Infoscan %then
1160                  %do;
1161                       %sortem(master,ean);
1162                       %sortem(item,ean);
1163                       %matchmerge (master,master,item,ean);          /* merge master and dictionary by ean*/
1164                      /*** 20160113 - Additional check in order to guarantee that mf and dict are ok ***/
1165                      %if &sysnobs = 0 %then %do;
1166                         %put ERROR: No data found after merge between MASTER and DICTIONARY - check logfile;
1167                         data _null_; endsas; run;
1168                      %end;
1169                      /*** 20160113 - Additional check in order to guarantee that mf and dict are ok ***/
1170       
1171                       %sortem(master, week store);
1172                       %sortem(projs,  week store);                  /* note that projection file and universe files change week to week */
1173                       %matchmerge (master,master,projs,week store);/* merge master and projs by week store */
1174                      /*** 20160111 - Additional check in order to guarantee that mf and proj are ok ***/
1175                      %if &sysnobs = 0 %then %do;
1176                         %put ERROR: No data found after merge between MASTER and PROJECTION - check logfile;
1177                         data _null_; endsas; run;
1178                      %end;
1179                      /*** 20160111 - Additional check in order to guarantee that mf and proj are ok ***/
1180       
1181                      %printdeb(master,obs from master file after merging with projection file);run;
1182       
1183                      %sortem(master,g1 s1 week);
1184                     data master;
1185                      set master;
1186                      rename
1187                      %do et=1 %to &slev;
1188                        s&et=st&et
1189                      %end;
1190                      %do ex=1 %to &glev;
1191                        g&ex=gc&ex
1192                      %end;;
1193                          run;
1194       
1195       
1196                         data master;
1197                          set master;
1198                          %do hk=1 %to &glev;
1199                            %do zh=1 %to &slev;
1200                              g1=gc&hk ;
1201                              s1=st&zh ;
1202                                  drop gc&hk st&zh;
1203                              output;
1204                            %end;
1205                          %end;
1206                         run;
1207       
1208       
1209       
1210       
1211             /*** 20150217 : Roger Walter : Keep only the geographies to be processed ***/
1212             /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1213             proc sort    data=master;                                  by g1 s1; run;
1214             data master; merge master(in=a1) catmax(in=a2 keep=g1 s1); by g1 s1;
1215                          if a1 and a2;
1216                          if packtype in &sp_types then spack  =1; else spack  =0; drop packtype;  /* sp w/o wear-out condition: Test1 */
1217             run;
1218             /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1219             /*** 20150217 : Roger Walter : Keep only the geographies to be processed ***/
1220       
1221       
1222         %end;
1223       run;
1224       
1225       
1226       /*** 20131121 : Performance monitoring ***/
1227       %monitor(_mod_=4);
1228       /*** 20131121 : Performance monitoring ***/
1229       
1230       
1231       %mend mergmast;
1232       
1233       %mergmast;
1234       
1235       
1236        /* preparation of Audit Data */
1237       %macro Audit_prep;
1238        %if &service=Combined %then
1239          %do;
1240            /* prepare scanner data for Combined */
1241             data mastscan;
1242             set mastscan;
1243             sales=units;
1244             numult=minfactor;
1245             sales=sales*factor;             * project sales;
1246             volume=sales*vol&volfact;       * change --was multiplied by volfact;;
1247             value=value*factor;
1248             units=units*factor;
1249             pnumfac=numfac*factor;          * projecting facings number and length;
1250             plenfac=lenfac*factor;
1251            run;
1252       
1253            proc summary data=mastscan noprint nway;
1254               class store ean g1 s1 ;
1255               id period storetype factor numult vol1-vol4 sku;   /*keep EAN to merge with code file again to get level codes*/
1256               var sales units volume value numfac lenfac pnumfac plenfac;
1257               output out=smaster(drop= _type_ _freq_) sum= ;
1258            run;
1259       
1260           %sortem(smaster,ean);                     /*merge scanner data with code file to get only items of interest*/
1261           %sortem(code,ean);
1262           %matchmerge (mastscan,smaster,code,ean); /* merge monthly scanner data and code file*/
1263           %sortem(store nodupkey,store);
1264           %sortem(mastscan,store);
1265           %matchmerge (mastscan,mastscan,store,store);    /* merge monthly scanner data and storemaster by store*/
1266            data mastscan;
1267            set mastscan;
1268            price=value/units;
1269            run;
1270       
1271           /* prepare audit data for Combined */
1272           %sortem(master,store);
1273           %sortem(days,store);                          /*Read days file*/
1274           %matchmerge (master,master,days,store);       /*Merge Master with Days file*/
1275       
1276            data master;
1277            set master;
1278            pdays=&pdays ;
1279            dfact=pdays/days;* adjustment for days between audits;
1280       
1281            if storetype='S' then   /*scanner stores*/
1282                   do;
1283                      sales=units;
1284                   end;
1285                 else                   /*audit stores*/
1286               do;
1287                 purch=purch*dfact;
1288                 sales=(pstocks*dfact)+purch-(stocks*dfact); *change need to scale stocks to preserve consistency in sales equation;
1289                 stocks=stocks*factor;       /*project stocks, Commented in by Souzas on 15/10/2003*/
1290                 stocks=stocks*vol&volfact;  /*volume stocks, change-was multiplied by volfact, Commented in by Souzas on 15/10/2003*/
1291                 purch=purch*factor;             * project purchases;
1292                 pvalue=purch*price;             * purchase value;
1293                 purch=purch*vol&volfact;        * purchase volume; *change -- was multiplied by volfact;
1294                 fstocks=fstocks*factor;         * project front stocks;
1295                 fstocks=fstocks*vol&volfact;    * front stock volume; *change -- was multiplied by volfact;
1296                 value=sales*price;
1297               end;
1298       
1299             numult=minfactor;
1300             sales=sales*factor;             * project sales;
1301             volume=sales*vol&volfact;
1302             value=value*factor;
1303             units=units*factor;
1304             pnumfac=numfac*factor;           *projecting facings number and length;
1305             plenfac=lenfac*factor;
1306             drop minfactor;
1307             run;
1308       
1309             /* set Audit and Scanner together */
1310             data master;
1311             set master mastscan(in=aa);
1312             week=&maxwk;
1313             run;
1314             %end;
1315        run;
1316       
1317       
1318       /*** 20131121 : Performance monitoring ***/
1319       %monitor(_mod_=4);
1320       /*** 20131121 : Performance monitoring ***/
1321       
1322       
1323        %mend Audit_prep;
1324       
1325       %Audit_prep;
1326       
1327        %macro project_Iscan; /*Project InfoScan data*/
1328          %if &service=Infoscan %then
1329            %do;
1330              data master;
1331               set master;
1332               period=1;
1333       
1334               numult=minfactor;
1335       
1336       
1337       %if &Prod_DeleteNoVolume = YES %then %do;
1338               if vol&volfact=. or vol&volfact=0 then delete;   /* ADDED BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
1339       %end;
1340       
1341       
1342               weight=factor;                /*factor in proj file*/
1343               units=units*weight;           /*project data*/
1344       
1345       
1346            /* value=value*weight; */  /* COMMENTED OUT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
1347            /* value=value;        */  /* COMMENTED OUT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
1348       
1349               value=price*units/&valcon;  /* ADDED BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
1350       
1351       
1352          /*   volume=units*vol&volfact;           /* Commented out by Souzas on 1904 */
1353               volume=units*vol&volfact/&volcon;   /* Added by Souzas on 1904 */
1354       
1355               pnumfac=numfac*weight;       *projecting facings number and length;
1356               plenfac=lenfac*weight;
1357               drop minfactor;
1358       
1359       
1360               b_units=b_units*weight;                   /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1361       
1362               bvalue=b_price*b_units/&valcon;           /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1363       
1364               bvolume = b_units*vol&volfact/&volcon;    /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1365       
1366               b_price=(bvalue)/b_units;                 /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1367       
1368               price=(value)/units;                      /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1369       
1370               if (b_price*.95)>=price then prdn=1; else prdn=0;  /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1371       
1372               incvolm = 0;                                       /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1373               bvolm   = 0;                                       /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1374       
1375               if prdn=1 then mkvalue=(b_price-price)*units; else mkvalue=0;  /*Added by A.A. 2015/01/12 - create markdown value for wgtavbp */
1376               mkvalm  = 0;                                                   /*Added by A.A. 2015/01/12 - create markdown value for wgtavbp */
1377               incvalm = 0;                                       /* Added by A.A. 2015/01/12 */
1378               bvalm   = 0;                                       /* Added by A.A. 2015/01/12 */
1379       
1380       
1381       /*** 20130906 : Add new measure M260/M261 ***/
1382               /*value=value;  => useless!!!  */
1383               bvalue=b_price*b_units;
1384               if ((b_price*.95)>=price) then do; incvalp=value-bvalue; bvalp=bvalue; end; /* any price-reduction */
1385               else                           do; incvalp=0;            bvalp=0;      end;
1386               if ((b_price*.95)>=price) then do; valp=value; end;
1387               else                           do; valp=0;     end;
1388               drop bvalue;
1389       /*** 20130906 : Add new measure M260/M261 ***/
1390       
1391       
1392               /*create flags variables for ANY MERCH */          /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1393       
1394               if feat1>0 or disp1>0 or prdn=1 then               /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1395                  do;                                             /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1396                     incvolm=volume-bvolume;                      /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1397                     bvolm=bvolume;                               /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1398       
1399                     mkvalm=mkvalue;                              /* Added by A.A. 2015/01/12 */
1400                     incvalm=value-bvalue;                        /* Added by A.A. 2015/01/12 */
1401                     bvalm=bvalue;                                /* Added by A.A. 2015/01/12 */
1402                  end;                                            /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1403               volamspack=0;                                      /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1404               valamspack=0;                                      /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1405               if feat1>0 or disp1>0 or prdn=1 or spack=1 then    /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1406                  do;                                             /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1407                     volamspack=volume;                           /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1408                     valamspack=value;                            /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1409                  end;                                            /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1410       
1411               drop bvolume;                                      /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1412               drop bvalue mkvalue;                               /* Added by A.A. 2015/01/12 */
1413               run;                                               /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1414       
1415       
1416       
1417       
1418                /* create monthly data if required */
1419                %if %sysfunc(upcase(&Monthlyagg))=Y %then %do;
1420                     data monthmast0;
1421                     set master;
1422                     week=0;
1423                     b_value=b_price*b_units;
1424                     if (b_price*.95)>=price then prdn=1; else prdn=0;  /* ADDED BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
1425       
1426                     keep store g1 s1 ean period week /*packyype*/ keycat units value volume numfac
1427                          lenfac pnumfac plenfac factor weight feat1 feat bund infeat instore disp
1428                          disp1 dispend b_value b_units incvolm bvolm incvalm bvalm mkvalm prdn
1429       
1430       /*** 20130906 : Add new measure M260/M261 ***/
1431                          bvalp incvalp valp
1432       /*** 20130906 : Add new measure M260/M261 ***/
1433       
1434                          volamspack valamspack;         /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1435                     run;
1436                     /* %sortem(monthmast0,store g1 s1 ean);*/
1437                     proc summary data=monthmast0 sum nway;
1438                               class store g1 s1 ean;
1439                               id period week /*packyype*/ keycat;
1440                               var units value volume numfac lenfac pnumfac plenfac
1441                                   factor weight
1442                                   feat1 feat bund infeat instore disp disp1 dispend
1443                                   b_value b_units
1444                                   /*** 20130906 : Add new measure M260/M261 ***/ bvalp incvalp valp
1445                                   incvolm bvolm        /* Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1446                                   incvalm bvalm mkvalm /* Added by A.A. 2015/01/12 */
1447                                   volamspack valamspack    /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1448                                   prdn                 /* ADDED BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
1449                               ;
1450                               output out=monthmast1(drop=_type_ _freq_)
1451       
1452                                          /*   sum(units value volume numfac lenfac pnumfac plenfac b_value b_units)=
1453                               units value volume numfac lenfac pnumfac plenfac b_value b_units        */    /* Commented out by Souzas on 1904 COMMENTED OUT BY A.A. on 18/02/2005 */
1454       
1455                               sum(units value volume numfac lenfac pnumfac plenfac b_value b_units
1456                               /*** 20130906 : Add new measure M260/M261 ***/ bvalp incvalp valp
1457                               incvolm bvolm incvalm bvalm mkvalm volamspack valamspack) =
1458                               units value volume numfac lenfac pnumfac plenfac b_value b_units
1459                               /*** 20130906 : Add new measure M260/M261 ***/ bvalp incvalp valp
1460                               incvolm bvolm incvalm bvalm mkvalm volamspack valamspack
1461                               /* incvalm, bvalm, mkvalm Added by A.A. 2015/01/12 -Added by Souzas on 1904 ADDED BY A.A. on 18/02/2005 */
1462                               /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1463       
1464                               min(factor weight)=factor weight
1465                               max(feat1 feat bund infeat instore disp disp1 dispend prdn)=feat1 feat bund infeat instore disp disp1 dispend prdn;  /* prdn ADDED BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
1466                               run;
1467       
1468                               * normalize monthly data to weekly record format ;
1469                               %sortem(projsum(where=(week=0)),store g1 s1);
1470                               %matchmerge(monthmast1,monthmast1,projsum,store g1 s1);
1471       
1472                               %sortem(store,store);
1473                               %matchmerge(monthmast1,monthmast1,store,store);
1474       
1475                               %sortem(code,ean);
1476                               %sortem(monthmast1,ean);
1477                               %matchmerge(monthmast1,monthmast1,code,ean);
1478       
1479                               %sortem(item,ean);
1480                               %matchmerge(monthmast1,monthmast1,item,ean);
1481       
1482                               data monthmast1;
1483                               set monthmast1;
1484                               price=value/units;
1485                               b_price=b_value/b_units;
1486                               drop b_value;
1487                               run;
1488       
1489                               /*** 20150728 : added feature from _TEST2 ***/
1490                               data master;
1491                               set
1492                                  %if       &Prod_OutputType = WEEK   %then %do; master            %end;
1493                                  %else %if &Prod_OutputType = ALL    %then %do; master monthmast1 %end;
1494                                  %else %if &Prod_OutputType = MONTH  %then %do; monthmast1        %end;
1495                                  ;
1496                               run;
1497                               /*** 20150728 : added feature from _TEST2 ***/
1498       
1499                       %end;
1500            %end;
1501       run;
1502       
1503       
1504       /*** 20131121 : Performance monitoring ***/
1505       %monitor(_mod_=4);
1506       /*** 20131121 : Performance monitoring ***/
1507       
1508       
1509       %mend Project_Iscan;
1510       
1511       %Project_Iscan;
1512       
1513        %macro createpromoflags;
1514          %if &service=Promoscan %then
1515          %do;
1516           data master /*promo*/;
1517           set master;
1518           numult=minfactor;
1519       
1520           if vol&volfact=. or vol&volfact=0 then delete;   /*Modified by Souzas on 03/02, change --was multiplied by vol1*/
1521       
1522           stcount=1;
1523         weight=factor;                /*factor in proj file*/
1524       
1525         pnumfac=numfac*weight;        *projecting facings number and length;
1526         plenfac=lenfac*weight;
1527       
1528         units=units*weight;           /*project data*/
1529         b_units=b_units*weight;
1530       
1531         value=price*units/&valcon;
1532         pvalue=price*units/&valcon;
1533         bvalue=b_price*b_units/&valcon;
1534       
1535         volume=units*vol&volfact/&volcon;   /*Modified by Souzas on 03/02, change --was multiplied by vol1*/
1536       
1537         pvolume=units*vol&volfact/&volcon;   /*Modified by Souzas on 03/02, change --was multiplied by vol1*/
1538       
1539         bvolume=b_units*vol&volfact/&volcon;   /*Modified by Souzas on 03/02, change --was multiplied by vol1*/
1540       
1541         b_price=(bvalue)/b_units;
1542         price=(value)/units;
1543         if (b_price*.95)>=price then prdn=1; else prdn=0;
1544         if prdn=1 then mkvalue=(b_price-price)*units; else mkvalue=0;  /*create markdown value for wgtavbp*/
1545         mkvalm=0; incvolm=0; incvalm=0; incunim=0; bvolm=0; bvalm=0; bunim=0; flagm=0;
1546       
1547         /*create flags variables for each of the merchandising conditions*/
1548       
1549       if feat1>0 or disp1>0 or prdn=1 then
1550       
1551          do;
1552            mkvalm=mkvalue;                  /* Any merch*/
1553            incvolm=volume-bvolume;
1554            incvalm=value-bvalue;
1555            incunim=units-b_units;
1556            bvolm=bvolume;
1557            bvalm=bvalue;
1558            bunim=b_units;
1559            flagm=1;
1560            mkvalfd=0;incvolfd=0;incvalfd=0;incunifd=0;bvolfd=0;bvalfd=0;bunifd=0;flagfd=0;
1561            mkvalf=0;incvolf=0;incvalf=0;incunif=0;bvolf=0;bvalf=0;bunif=0;flagf=0;/*feature*/
1562            mkvald=0;incvold=0;incvald=0;incunid=0;bvold=0;bvald=0;bunid=0;flagd=0;/*display*/
1563            mkvalp=0;incvolp=0;incvalp=0;incunip=0;bvolp=0;bvalp=0;bunip=0;flagp=0;/*price red*/
1564            flagaf=0; flagad=0; /*any feature, any display*/
1565            flagof=0; bvolof=0; bvalof=0; buniof=0; /* Feature only */
1566            flagod=0; bvolod=0; bvalod=0; buniod=0; /* Display only */
1567            flagop=0; bvolop=0; bvalop=0; buniop=0; /* TPR only */
1568            flagofdp=0; bvolofdp=0; bvalofdp=0; buniofdp=0; /* Feature and Display and TPR only */
1569            flagofd=0; bvolofd=0; bvalofd=0; buniofd=0; /* Feature and Display only */
1570            flagofp=0; bvolofp=0; bvalofp=0; buniofp=0; /* Feature and TPR only */
1571            flagodp=0; bvolodp=0; bvalodp=0; buniodp=0; /* Display and TPR only */
1572            incvolof=0; incvalof=0; incuniof=0;
1573            incvolod=0; incvalod=0; incuniod=0;
1574            incvolop=0; incvalop=0; incuniop=0;
1575            incvolofdp=0; incvalofdp=0; incuniofdp=0;
1576            incvolofd=0; incvalofd=0; incuniofd=0;
1577            incvolofp=0; incvalofp=0; incuniofp=0;
1578            incvolodp=0; incvalodp=0; incuniodp=0;
1579       
1580       
1581            if feat1>0 then flagaf=1;            /*any feat*/
1582            if disp1>0 then flagad=1;            /*any display*/
1583       
1584       
1585       /************* 05022018 New Measures ***/
1586            if feat1>0 and disp1=0 and prdn=0 then
1587            do;
1588             bvolof=bvolm;
1589             bvalof=bvalm;
1590             buniof=bunim;
1591             incvolof=incvolm;
1592             incvalof=incvalm;
1593             incuniof=incunim;
1594             flagof=1;
1595            end;
1596       
1597            if feat1=0 and disp1>0 and prdn=0 then
1598            do;
1599             bvolod=bvolm;
1600             bvalod=bvalm;
1601             buniod=bunim;
1602             incvolod=incvolm;
1603             incvalod=incvalm;
1604             incuniod=incunim;
1605             flagod=1;
1606            end;
1607       
1608            if feat1=0 and disp1=0 and prdn>0 then
1609            do;
1610             bvolop=bvolm;
1611             bvalop=bvalm;
1612             buniop=bunim;
1613             incvolop=incvolm;
1614             incvalop=incvalm;
1615             incuniop=incunim;
1616             flagop=1;
1617            end;
1618       
1619            if feat1>0 and disp1>0 and prdn>0 then
1620            do;
1621             bvolofdp=bvolm;
1622             bvalofdp=bvalm;
1623             buniofdp=bunim;
1624             incvolofdp=incvolm;
1625             incvalofdp=incvalm;
1626             incuniofdp=incunim;
1627             flagofdp=1;
1628            end;
1629       
1630            if feat1>0 and disp1>0 and prdn=0 then
1631            do;
1632             bvolofd=bvolm;
1633             bvalofd=bvalm;
1634             buniofd=bunim;
1635             incvolofd=incvolm;
1636             incvalofd=incvalm;
1637             incuniofd=incunim;
1638             flagofd=1;
1639            end;
1640       
1641            if feat1>0 and disp1=0 and prdn>0 then
1642            do;
1643             bvolofp=bvolm;
1644             bvalofp=bvalm;
1645             buniofp=bunim;
1646             incvolofp=incvolm;
1647             incvalofp=incvalm;
1648             incuniofp=incunim;
1649             flagofp=1;
1650            end;
1651       
1652            if feat1=0 and disp1>0 and prdn>0 then
1653            do;
1654             bvolodp=bvolm;
1655             bvalodp=bvalm;
1656             buniodp=bunim;
1657             incvolodp=incvolm;
1658             incvalodp=incvalm;
1659             incuniodp=incunim;
1660             flagodp=1;
1661            end;
1662       
1663       
1664       /************* 05022018 New Measures ***/
1665       
1666       
1667            if feat1>0 and disp1>0 then          /*Feature and Display flags*/
1668             do;
1669              mkvalfd=mkvalue;
1670              incvolfd=volume-bvolume;
1671              incvalfd=value-bvalue;
1672              incunifd=units-b_units;
1673              bvolfd=bvolume;
1674              bvalfd=bvalue;
1675              bunifd=b_units;
1676              flagfd=1;
1677           end;
1678           else if feat1>0 and disp1=0 then    /*Feature only flags*/
1679             do;
1680              mkvalf=mkvalue;
1681              incvolf=volume-bvolume;
1682              incvalf=value-bvalue;
1683              incunif=units-b_units;
1684              bvolf=bvolume;
1685              bvalf=bvalue;
1686              bunif=b_units;
1687              flagf=1;
1688           end;
1689           else if feat1=0 and disp1>0 then     /*Display only flags*/
1690                 do;
1691              mkvald=mkvalue;
1692              incvold=volume-bvolume;
1693              incvald=value-bvalue;
1694              incunid=units-b_units;
1695              bvold=bvolume;
1696              bvald=bvalue;
1697              bunid=b_units;
1698              flagd=1;
1699            end;
1700           else
1701             do;
1702              mkvalp=mkvalue;                /*price reduction only */
1703              incvolp=volume-bvolume;
1704              incvalp=value-bvalue;
1705              incunip=units-b_units;
1706              bvolp=bvolume;
1707              bvalp=bvalue;
1708              bunip=b_units;
1709              flagp=1;
1710           end;
1711        end;
1712       
1713        volamspack=0;                                      /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1714        valamspack=0;                                      /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1715        if feat1>0 or disp1>0 or prdn=1 or spack=1 then    /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1716           do;                                             /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1717              volamspack=volume;                           /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1718              valamspack=value;                            /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1719           end;                                            /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
1720       
1721       run;
1722       %end;                     /*end of if condition regarding service*/
1723       run;
1724       
1725       
1726       /*** 20131121 : Performance monitoring ***/
1727       %monitor(_mod_=4);
1728       /*** 20131121 : Performance monitoring ***/
1729       
1730       
1731       %mend createpromoflags;
1732       
1733       %createpromoflags;
1734       
1735       /*Create ACV numbers for stores and regions to calculate distribution*/
1736       
1737       
1738       %macro createacvs;
1739       
1740       %sortem(master, g1 s1 week store);
1741       
1742         data mastacv;                                      /* create mastacv --  a copy of master*/
1743         set master (keep= g1 s1 store week value);         /* use to calculate total ACV at store and region level */
1744         run;
1745       
1746         proc summary data=mastacv sum nway;
1747         by g1 s1 week store;
1748         var value;
1749         output out=acvtot(drop=_type_ _freq_) sum=stacv;     /*STACV: store level ACVs*/
1750       
1751       %sortem(acvtot, g1 s1 week store);
1752       
1753        data master;
1754        merge master(in=a) acvtot(in=b);
1755        by g1 s1 week store;
1756        if a and b;
1757        run;
1758       
1759        proc summary data=mastacv;                       /*REGACV: region level ACVs*/
1760        by g1 s1 week;
1761        var value;
1762        output out=acvreg(drop=_type_ _freq_) sum=regacv;
1763       
1764        data master;
1765        merge master(in=a) acvreg(in=b);
1766        by g1 s1 week;
1767        if a and b;
1768       
1769       %sortem(numdenom,g1 s1 week);
1770       
1771        data master;                                  /* merge in number of universe stores per region-store type*/
1772        merge master(in=a) numdenom(in=b);            /* REGFACT used in calc of numerical distribution*/
1773        by g1 s1 week;
1774        if a and b;                                   /*note: NUMULT =# Universe stores */
1775                                                      /*note: REGFACT=#universe stores/# sample stores*/
1776       
1777       %sortem(master(keep=g1 s1 week store factor) out=tstores nodupkey,g1 s1 week store);
1778       
1779       
1780       *** create minimum weights for each region store and period;
1781       proc summary data=tstores nway;
1782       var factor;
1783       by g1 s1 week store;
1784       output out=minstore(drop=_type_ _freq_) min=minwgt;
1785       run;
1786       
1787       *** create variable for total stores for the week;
1788       proc summary data=tstores nway;
1789       var factor;
1790       by g1 s1 week ;
1791       output out=totstore(drop=_type_ _freq_) sum=tstores;  /*used to calculate distribution in old PromoScan*/
1792       run;
1793       
1794       
1795       /*** 20131121 : Performance monitoring ***/
1796       %monitor(_mod_=4);
1797       /*** 20131121 : Performance monitoring ***/
1798       
1799       
1800       %mend createacvs;
1801       run;
1802       %createacvs;
1803       
1804       
1805       %macro createcatvalue;
1806       run;
1807       
1808       %sortem(master, g1 s1 week store);
1809       
1810         proc summary data=master sum nway;          /*STCATVAL used for CWD*/
1811           var value units volume lenfac;            /* added LENFAC -- length of facings by region period*/
1812           by g1 s1 week store;
1813         output out=stcatval(drop=_type_ _freq_) sum=stcatval stcatuni stcatvol stcatlen;
1814         run;
1815       
1816        data master;
1817        merge master(in=a) stcatval(in=b);
1818        by g1 s1 week store;
1819        if a and b;
1820        run;
1821       
1822        proc summary data=master noprint;
1823        by g1 s1 week ;
1824        var value units volume plenfac pnumfac;                  /* added LENFAC and NUMFAC-- length of facings by region period*/
1825        output out=reg (drop=_type_ _freq_)
1826        sum=regvalue regunits regvolume regcatlen regcatfac;     /* used for measure: Share of Shelf Space and share of items*/
1827        run;                                                     /*REG: category region period value sales and shelf space*/
1828       
1829        data master;
1830        merge master(in=a) reg(in=b);
1831        by g1 s1 week ;
1832        if a and b;
1833       run;
1834       
1835       
1836       /*** 20131121 : Performance monitoring ***/
1837       %monitor(_mod_=4);
1838       /*** 20131121 : Performance monitoring ***/
1839       
1840          /*** 20120926 : R. Walter : Calculate the new measures for BAT ***/
1841          %if &service=Promoscan %then %do;
1842             %if &newmeasure_bat=Y %then %do;
1843                /* create complete base with all stores and all eans from masterfile */
1844                proc sort data=master(keep=store week g1 s1 ean value numult stcatval %do lev=1 %to &plevel; lev&lev %end;)
1845                          out =_base_5(where=(ean^='00000000000000')) nodupkey;
1846                          by store ean week g1 s1;
1847                run;
1848                proc sort data=stock nodupkey;                         by store ean;               run;
1849                data stock_measure; merge _base_5(in=a1) stock(in=a2); by store ean; if a1 and a2; run;
1850                /* calculate the measures only for audited ean */
1851                %let llineitem=%eval(&plevel * 4 + 14);
1852                data stock_measure;
1853                   length lineitem $&llineitem..;
1854                   set stock_measure;
1855                   lineitem     = compbl(lev1 || %do rwr=2 %to &plevel; lev&rwr || %end; ean);
1856                   /*-------------------------------------------------------------------------------------------------------------------------*/
1857                   num_oos      = (stock_curr = 0 and (sum(stock_prev, value) > 0)) * numult;   /* Number Out of Stock - used for DN_OOS      */
1858                   cwd_oos      = (stock_curr = 0 and (sum(stock_prev, value) > 0)) * stcatval; /* Value  Out of Stock - used for CWD_OOS     */
1859                   num_handling = (stock_curr = 1)                                  * numult;   /* Number Handling     - used for DN_HANDL    */
1860                   cwd_handling = (stock_curr = 1)                                  * stcatval; /* Value  Handling     - used for CWD_HANDL   */
1861                   num_nostock  = (sum(stock_prev, stock_curr, value) = 0)          * numult;   /* Number No Stock     - used for DN_NOSTOCK  */
1862                   cwd_nostock  = (sum(stock_prev, stock_curr, value) = 0)          * stcatval; /* Value  No Stock     - used for CWD_NOSTOCK */
1863                   /*-------------------------------------------------------------------------------------------------------------------------*/
1864                run;
1865                /* aggregate the data at geo/period/item level for further merge with final data */
1866                proc means data=stock_measure nway noprint;
1867                   class  g1 s1 week lineitem;
1868                   var    num_oos num_handling num_nostock cwd_oos cwd_handling cwd_nostock;
1869                   output out=stock_measure_sum(drop=_type_ _freq_) sum=;
1870                run;
1871             %end;
1872          %end;
1873          /*** 20120926 : R. Walter : Calculate the new measures for BAT ***/
1874       
1875       %mend createcatvalue;
1876       %createcatvalue;
1877       
1878       /*CREATEpromoflags Macro: creates projected sales, promo sales, incremental sales, and promo flags*/
1879       
1880       %MEND DATAPREPARATION;
1881       *%DATAPREPARATION;
1882       
1883       *----------------------------------------------------------------------------------------;
1884       
1885       %MACRO AGGREGATION_Combined;
1886       
1887       /* Read secondary totals that are generated by the Conversion_v10.sas */
1888          %macro readsectotals;
1889            %if &sectot > 0 %then
1890             %do;
1891                %do si= 1 %to &sectot;
1892                  %let setinc=%eval(&si * 1000);
1893                  %let settop=%eval(&setinc + 1000);
1894       
1895                   data sectot&si ;
1896                   set sectot;
1897                   if &settop > lev1 >= &setinc;
1898                   run;
1899                %end;
1900             %end;
1901       
1902            %if &sectot > 0 %then
1903            %do;
1904               %do ai= 1 %to &sectot;
1905                  %sortem(sectot&ai,ean);
1906               %end;
1907            %end;
1908       
1909       
1910       /*** 20131121 : Performance monitoring ***/
1911       %monitor(_mod_=4);
1912       /*** 20131121 : Performance monitoring ***/
1913       
1914       
1915        %mend readsectotals;
1916        %readsectotals;
1917       
1918       
1919        /********* Creates master files for each secondary total****************************/
1920        %macro mastersectot;
1921          %if &sectot > 0 %then
1922         %do;
1923          data mastsectot ; /*change -- dropping item and keeping EAN*/
1924          set master;
1925          numean=1;
1926          keep g1 s1 week store period ean factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac
1927               stocks sales value pvalue volume NUMEAN PNUMFAC PLENFAC;  /*stocks added by Souzas on 15/10/2003*/
1928          run;
1929          %sortem(mastsectot, ean);           /*changed from item to EAN*/
1930          %do bi= 1 %to &sectot;
1931          %matchmerge(secmas&bi,mastsectot,sectot&bi,ean); /*changed from item to EAN*/
1932          %end;
1933         %end;
1934       
1935       
1936       /*** 20131121 : Performance monitoring ***/
1937       %monitor(_mod_=4);
1938       /*** 20131121 : Performance monitoring ***/
1939       
1940       
1941        %mend mastersectot;
1942        %mastersectot;
1943       
1944       %macro aggsales_Combined(agglev);
1945       data master;
1946       set master;
1947       numean=1;
1948       
1949         %sortem(master(keep=g1 s1 period week store %do ag=1 %to &agglev; lev&ag %end; ean factor stcatval regvalue regfact
1950                 numult stacv regacv regcatlen regcatfac sku sales value pvalue volume stocks NUMEAN PNUMFAC PLENFAC)
1951                 out=mastersh, g1 s1 week store %do ag=1 %to &agglev; lev&ag %end;);  /*stocks added by Souzas on 15/10/2003*/
1952       
1953        /*** 20150217 : Performance-enhancement ***/
1954        %do ag=&agglev %to 1 %by -1;
1955           %if &ag = &agglev %then %do;
1956              proc summary data=mastersh noprint;
1957           %end;
1958           %else %do;
1959              proc summary data=lev&ag_prev noprint;
1960           %end;
1961              by g1 s1 week store %do ag2=1 %to &ag; lev&ag2 %end;;
1962              id period factor stcatval regvalue regfact
1963                 numult stacv regacv regcatlen regcatfac sku;
1964              var sales value pvalue volume stocks NUMEAN PNUMFAC PLENFAC;
1965              output out=lev&ag(drop=_freq_ _type_) sum=;
1966            run;
1967            %let ag_prev=&ag;
1968        %end;
1969        /*** 20150217 : Performance-enhancement ***/
1970       
1971        %if &sectot > 0 %then
1972         %do;
1973          %do bi= 1 %to &sectot;
1974           %sortem(secmas&bi,g1 s1 week store lev1);
1975           proc summary data=secmas&bi noprint;
1976           by g1 s1 week store lev1;
1977           id  period factor stcatval regvalue regfact
1978               numult stacv regacv regcatlen regcatfac;
1979           var sales value pvalue volume stocks NUMEAN PNUMFAC PLENFAC;
1980           output out=levst&bi(drop=_freq_ _type_) sum=  ;
1981           run;
1982          %end;
1983         %end;
1984       
1985       data lev&agglev; set lev&agglev;  /*this step saves sku code only for the (l-1) levels which is SKU level*/
1986       sku2=sku;                       /*necessary so that we have SKU in the aggregation output file*/
1987       
1988        data aggmast1;
1989        set master lev1 lev2 %do ag3=3 %to &agglev;
1990        lev&ag3
1991        %end;;
1992       
1993        run;
1994        %if &sectot > 0 %then
1995        %do;
1996          data aggmast2;
1997          set aggmast1 %do ag4=1 %to &sectot;
1998          levst&ag4 %end;;
1999          run;
2000         %end;
2001       
2002        /* Start insert by Souzas on 0207 */
2003         %else
2004         %do;
2005         data aggmast2;
2006         set aggmast1;
2007         run;
2008         %end;
2009       /* End insert by Souzas on 0207 */
2010       
2011       
2012       /*** 20131121 : Performance monitoring ***/
2013       %monitor(_mod_=4);
2014       /*** 20131121 : Performance monitoring ***/
2015       
2016       
2017       %mend aggsales_Combined;
2018       %aggsales_Combined(&plevel);
2019       
2020       %macro geoprep;
2021       /*Merge projection weights with store level data*/
2022       %let llineitem=%eval(&plevel*4 +14);
2023       
2024       %sortem(minstore,g1 s1 week store);
2025       %sortem(aggmast2,g1 s1 week store);
2026       %matchmerge(aggmast3,minstore,aggmast2,g1 s1 week store);
2027       
2028        data aggmast4(drop=k);
2029        set aggmast3;
2030        array misscheck {&plevel} lev1-lev&plevel ;
2031        sku3=sku2;
2032        if sku2='' then sku3='00000000'; /*assigned SKU to lev2 earlier*/
2033       
2034       /* Add zeros to front of SKU code to ensure length is 14 -- consistent with length 14 EANcode*/
2035        l=length(sku3);
2036       
2037        if l=7 then
2038         do;
2039            sku4='0000000'||sku3;
2040         end;
2041       
2042         else
2043          do;
2044            sku4='000000'||sku3;
2045          end;
2046        drop l;
2047       
2048        do k=1 to &plevel ;
2049         if misscheck{k}=. then misscheck{k}=0;
2050        end;
2051       
2052       
2053       if s1 in /*('00','01','03','61','62','63','64')*/ &Prod_ScannerStores then /*scanner stores*/ /*Added by Souzas, on 15/10/2003*/
2054        do;                                       /*Added by Souzas, on 15/10/2003*/
2055        numos= 0;                                 /*Added by Souzas, on 15/10/2003*/
2056        svalos =0;                                /*Added by Souzas, on 15/10/2003*/
2057        end;                                      /*Added by Souzas, on 15/10/2003*/
2058       else                   /*audit stores*/    /*Added by Souzas, on 15/10/2003*/
2059        do;                                       /*Added by Souzas, on 15/10/2003*/
2060        numos=(sales > 0 and stocks <= 0) * numult; /*out of stocks, Commented in by Souzas on 15/10/2003*/
2061        svalos=(sales > 0 and stocks <= 0) * stcatval; /*out of stocks, commented in by Souzas on 15/10/2003*/
2062       end;                                       /*Added by Souzas, on 15/10/2003*/
2063       
2064       
2065        numh=(sales > 0 or stocks > 0) * numult; /* Handling Numerical Distribution, Added by Souzas on 06/07/2005 */
2066        svalh=(sales > 0 or stocks > 0) * stcatval; /* Handling CWD, Added by Souzas on 06/07/2005 */
2067       
2068        nums=(sales > 0)  * numult;
2069        svals=(sales > 0) * stcatval;*sales;
2070        acvs=(sales > 0) *  stacv;*stacv;
2071       
2072        PNUMS=nums;                        /* project num stores by universe to sample ratio*/
2073        PNUMEAN=(sales > 0) * NUMEAN*numult;    /* Change -- added condition sales>0 since only want stores selling EAN*/
2074        numsfac=(pnumfac > 0);              /*number of stores where num facings is greater than zero*/
2075        pnumsfac=numsfac*numult;
2076       
2077        if ean gt 0 then delete;          /*for Combined service do not want to keep*/
2078        ean=sku4;                          /*EAN level -- only aggrgeated above it*/
2079        length lineitem $&llineitem;
2080        lineitem=compbl(lev1 ||
2081         %do rwr=2 %to &plevel;
2082          lev&rwr ||
2083         %end;
2084        ean);
2085       run;
2086       
2087       
2088        %sortem(aggmast4,g1 s1 week lineitem);
2089        proc summary data=aggmast4 noprint;
2090        id period factor stcatval regvalue regfact stacv regacv regcatlen regcatfac;
2091        by g1 s1 week lineitem ;
2092        var sales stocks volume value pvalue purch numos nums  /*numos commented in by Souzas on 15/10/2003*/
2093            svalos svals                                       /*svalos commented in by Souzas on 15/10/2003*/
2094            numh svalh                                        /* numh, svalh, Added by Souzas on 06/07/2005 */
2095            PNUMS PNUMEAN PNUMFAC PLENFAC PNUMSFAC;
2096        output out=alltot(drop=_type_ _freq_) sum= ;
2097        run;
2098       
2099       
2100       /*** 20131121 : Performance monitoring ***/
2101       %monitor(_mod_=4);
2102       /*** 20131121 : Performance monitoring ***/
2103       
2104       
2105       %mend geoprep;
2106       %geoprep;
2107       
2108       %MEND AGGREGATION_Combined;
2109       
2110       
2111       %MACRO AGGREGATION_ISCAN;
2112       
2113       
2114       
2115       
2116       
2117        %macro aggvalue_cwd;             /* START INSERT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
2118       
2119         %sortem(master, g1 s1 week store);
2120       
2121         proc summary data=master nway;    /*STCATVAL used for CWD*/
2122           var value units volume Plenfac; /* added LENFAC -- length of facings by region period*/
2123           by g1 s1 week store;
2124         output out=stcatval(drop=_type_ _freq_) sum=stcatval stcatuni stcatvol stcatlen;
2125         run;
2126       
2127       
2128         /*Aggregate sales and facing length by region period*/
2129        proc means data=stcatval noprint;                 /*TSTCTVAL used for CWD*/
2130          var stcatval stcatuni stcatvol stcatlen;
2131          by g1 s1 week ;
2132        output out=tstctval(drop=_type_ _freq_)
2133        sum=tstctval tstctuni tstctvol tstctlen;/* tstctlen -- used for measure: Share of Shelf Space*/
2134        run;
2135       
2136       
2137        data master; merge stcatval(in=a) master(in=b);       /*Merge store-category value totals with MAST*/
2138          by g1 s1 week store;
2139          if b;
2140          stcatvaf=0; stcatvad=0; stcatvp=0; stcatvmr=0; /*stcatvfd=0; stcatvfo=0; stcatvdo=0;*/        /* These 3 variables were commented out SOUZAS ON 26/09/2005 */
2141          if feat1 > 0 then stcatvaf=stcatval;                                        /*any feature*/   /* These 3 variables were not needed */
2142          if disp1 > 0 then stcatvad=stcatval;                                        /*any display*/
2143       /* if feat1 > 0 and disp1 = 0 then stcatvfo=stcatval; */                       /*feature only*/
2144       /* if disp1 > 0 and feat1 = 0 then stcatvdo=stcatval; */                       /*Display only*/
2145          if (prdn > 0 and feat1=0 and disp1=0) then stcatvp=stcatval;                /*pred only*/
2146          if feat1 > 0 or disp1 > 0 or instore >0 or prdn > 0 then stcatvmr=stcatval; /*any merch*/
2147       /* if feat1 > 0 and disp1 > 0 then stcatvfd=stcatval; */                       /*feat and display*/
2148       
2149        run;
2150       
2151       
2152       *----------------------------------------------------------------------------------;
2153       
2154       /*Save Master files per week for Iscan and Combined -- unable to save aggregate files
2155        because of distribution measures but can save subsetted files merged with dict,geog files etc*/
2156       
2157       
2158       /*** 20131121 : Performance monitoring ***/
2159       %monitor(_mod_=4);
2160       /*** 20131121 : Performance monitoring ***/
2161       
2162       
2163       %mend aggvalue_cwd;
2164       
2165       %aggvalue_cwd;          /* END INSERT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
2166       
2167       
2168       
2169       
2170       
2171       /* Read secondary totals that are generated by the Conversion_v10.sas */
2172          %macro readsectotals;
2173            %if &sectot > 0 %then
2174             %do;
2175                %do si= 1 %to &sectot;
2176                  %let setinc=%eval(&si * 1000);
2177                  %let settop=%eval(&setinc + 1000);
2178       
2179                  data sectot&si ;
2180                  set sectot;
2181                  if &settop > lev1 >= &setinc;
2182                  run;
2183                %end;
2184             %end;
2185       
2186            %if &sectot > 0 %then
2187              %do;
2188                 %do ai= 1 %to &sectot;
2189                 %sortem(sectot&ai,ean);    /*changed from item to EAN*/
2190                %end;
2191             %end;
2192       
2193       
2194       /*** 20131121 : Performance monitoring ***/
2195       %monitor(_mod_=4);
2196       /*** 20131121 : Performance monitoring ***/
2197       
2198       
2199        %mend readsectotals;
2200        %readsectotals;
2201       
2202       
2203       
2204       %macro calcincvolume;          /* Start insert by SOUZAS on 1904 */
2205       
2206       %sortem(master,g1 s1 week ean); *change from promo;
2207       
2208       proc summary data=master sum nway;
2209       by g1 s1 week EAN;
2210       var incvolm;
2211       output out=totinc(drop=_type_ _freq_) sum=totinc;
2212       run;
2213       
2214       %matchmerge(master,master,totinc,g1 s1 week ean);
2215       
2216       data master; set master;
2217       inczerou=incunim;
2218        inczerov=incvolm;
2219          if totinc<0 then                   /*zero out negative incremental volume*/
2220            do;
2221              inczerou=0;
2222              inczerov=0;
2223            end;
2224       
2225       %printdeb(master,Before Summing);
2226       
2227       proc summary data=master sum nway;    /*aggregate incremental by geog and period*/
2228       by g1 s1 week;
2229       var inczerou inczerov /*incvalm*/;     /* incvalm commented out by SOUZAS on 1904*/
2230       output out=catincr(drop=_type_ _freq_) sum=catincu catincv catincva;
2231       run;
2232       
2233       
2234       /*** 20131121 : Performance monitoring ***/
2235       %monitor(_mod_=4);
2236       /*** 20131121 : Performance monitoring ***/
2237       
2238       
2239       %mend calcincvolume;
2240       
2241       %calcincvolume;                /* End insert by SOUZAS on 1904 */
2242       
2243       
2244       
2245       
2246        /********* Creates master files for each secondary total****************************/
2247        %macro mastersectot;
2248          %if &sectot > 0 %then
2249         %do;
2250          data mastsectot; /*change -- dropping item and keeping EAN*/
2251          set master (drop=lev1-lev&plevel);
2252          item=.;
2253          drop item;
2254          numean=1;
2255          run;
2256          %sortem(mastsectot, ean);           /*changed from item to EAN*/
2257          %do bi= 1 %to &sectot;
2258          %matchmerge(secmas&bi,mastsectot,sectot&bi,ean); /*changed from item to EAN*/
2259       
2260          %end;
2261         %end;
2262       
2263       
2264       /*** 20131121 : Performance monitoring ***/
2265       %monitor(_mod_=4);
2266       /*** 20131121 : Performance monitoring ***/
2267       
2268       
2269        %mend mastersectot;
2270        %mastersectot;
2271       
2272       %macro aggsales_Iscan(agglev);
2273       
2274        data master;
2275          set master;
2276          numean=1;
2277        run;
2278       
2279        %sortem(master,g1 s1 week store %do ag=1 %to &agglev; lev&ag %end;);
2280       
2281        /*** 20150217 : Performance-enhancement ***/
2282        %do ag=&agglev %to 1 %by -1 ;
2283           %if &ag = &agglev %then %do;
2284              proc summary data=master noprint;
2285           %end;
2286           %else %do;
2287              proc summary data=lev&ag_prev noprint;
2288           %end;
2289              by g1 s1 week store %do ag2=1 %to &ag; lev&ag2 %end;;
2290              id period factor stcatval regvalue regfact
2291                 numult stacv regacv regcatlen regcatfac;
2292              var units value volume NUMEAN PNUMFAC PLENFAC
2293                  /*** 20130906 : Add new measure M260/M261 ***/ bvalp incvalp valp
2294                  incvolm bvolm inczerov
2295                  stcatvaf stcatvad stcatvp stcatvmr /* ADDED BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
2296             incvalm bvalm mkvalm                   /* Added by A.A. 2015/01/12 */
2297             volamspack valamspack                      /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
2298             ;
2299           output out=lev&ag(drop=_freq_ _type_) sum=;
2300           run;
2301           %let ag_prev=&ag;
2302        %end;
2303        /*** 20150217 : Performance-enhancement ***/
2304       
2305        %if &sectot > 0 %then
2306         %do;
2307          %do bi= 1 %to &sectot;
2308           %sortem(secmas&bi,g1 s1 week store lev1);
2309           proc summary data=secmas&bi noprint;
2310           by g1 s1 week store lev1;
2311           id period factor stcatval regvalue regfact
2312              numult stacv regacv regcatlen regcatfac;
2313           var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov /* Added by SOUZAS on 1904 ADDED BY A.A. on 18/02/2005 */
2314               stcatvaf stcatvad stcatvp stcatvmr     /* ADDED BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
2315               incvalm bvalm mkvalm                   /* Added by A.A. 2015/01/12 */
2316               volamspack valamspack                      /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
2317               ;
2318           output out=levst&bi(drop=_freq_ _type_) sum=  ;
2319           run;
2320          %end;
2321         %end;
2322       
2323        /*** 20150217 : Performance-enhancement ***/
2324         data aggmast;
2325         set master %do ag3=1 %to &agglev; lev&ag3 %end;
2326         %if &sectot > 0 %then %do;
2327            %do ag4=1 %to &sectot; levst&ag4 %end;
2328         %end;
2329         ;
2330         run;
2331       
2332       
2333       /*** 20131121 : Performance monitoring ***/
2334       %monitor(_mod_=4);
2335       /*** 20131121 : Performance monitoring ***/
2336       
2337       
2338       %mend aggsales_Iscan;
2339       %aggsales_Iscan(&plevel);
2340       
2341       
2342       /*=================================================================================*/
2343       /* START INSERT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
2344       
2345       /*Aggregate by levels across stores to get distribution measures*/
2346       
2347       %MACRO aggstore_Infoscan(agglev);
2348       
2349       /*Notes: Category Weighted Distribution caluclated by using category value totals*/
2350       /*Notes: Numerical distribution calculated by using the sample and universe numbers*/
2351       /*Notes: from the Universe file instead of the sum of the weights of the stores selling as in old PromoScan*/
2352       /*Notes: REGFACT and NUMULT used for calculating numerical distribution*/
2353       /*Notes: REGFACT= # universe stores*/
2354       /*Notes: NUMULT= # universe stores/#sample stores*/
2355       /*Facings aggregation is done here -- lenfac and numfac are aggregated*/
2356       
2357       
2358       /* data master; N*/
2359       /* set master;  N*/
2360       /* numean=1;    N*/  /*NUMEAN used to count EANs and used to aggregate by region, period, and level*/
2361       
2362       /*Aggregate distribution variables for EAN level*/
2363       
2364        data masteraa;
2365        set master;
2366        run;
2367       
2368        %sortem(masteraa,g1 s1 week store ean);
2369       
2370         proc summary data=masteraa noprint;
2371         by g1 s1 week store ean;
2372         id period regfact REGCATLEN regcatfac regvalue;
2373         var /*sqrmtr*/ stcatval stcatvaf stcatvad /*stcatvfd stcatvfo stcatvdo*/ stcatvp stcatvmr
2374             numult stacv regacv /*NUMEAN PNUMFAC PLENFAC*/;
2375         output out=storeean(drop=_freq_ _type_) max=  /* sum(NUMEAN PNUMFAC PLENFAC)=SNUMEAN SNUMFAC SLENFAC*/;
2376         run;
2377       
2378       run;
2379       
2380        /*Aggregate store distribution variables for standard levels*/
2381         %sortem(masteraa,g1 s1 week store %do ag=1 %to &agglev; lev&ag %end;);
2382         %do ag=1 %to &agglev ;
2383         proc summary data=masteraa noprint;
2384         by g1 s1 week store %do ag2=1 %to &ag; lev&ag2 %end;;
2385         id period regfact REGCATLEN regcatfac regvalue;   /*regcatlen is the region total for facings length*/
2386         var /*sqrmtr*/ stcatval stcatvaf stcatvad /*stcatvfd stcatvfo stcatvdo*/ stcatvp stcatvmr
2387             numult stacv regacv /*NUMEAN PNUMFAC PLENFAC*/;
2388         output out=lev&ag(drop=_freq_ _type_) max=   /*sum(NUMEAN PNUMFAC PLENFAC)=SNUMEAN SNUMFAC SLENFAC*/;
2389         run;
2390       
2391       
2392       /* %printdeb(lev&ag,levels aggregated to geog period store and lev&ag);run; */
2393       
2394        /*Merge projection weights with standard levels*/
2395         %sortem(minstore,g1 s1 week store);
2396         %sortem(lev&ag,g1 s1 week store);
2397       
2398       
2399       /* Project distribution variables for standard levels*/
2400          data lev&ag;
2401          merge lev&ag(in=a) minstore(in=b);
2402           by g1 s1 week store;
2403         /*  sqrmtr=sqrmtr*minwgt;   */
2404         /*  weight=minwgt;          */
2405         /*  NUMS=1;                 */             /* indicator to calculate number of stores selling*/
2406         /*  PNUMS=nums*numult;      */             /* project num stores by universe to sample ratio*/
2407         /*  PNUMEAN=SNUMEAN*numult;  */            /* WEIGHT or NUMULT -- need to check*/
2408         /*  PNUMFAC=SNUMFAC;         */
2409         /*  PLENFAC=SLENFAC;         */
2410         /*  numsfac=(pnumfac > 0);   */          /*number of stores where num facings is greater than zero*/
2411         /*  pnumsfac=numsfac*numult; */
2412           drop minwgt;
2413           run;
2414       
2415       run;
2416       
2417         %sortem(lev&ag,g1 s1 week %do ag2=1 %to &ag; lev&ag2 %end;);
2418             proc summary data=lev&ag nway;
2419             by g1 s1 week %do ag2=1 %to &ag; lev&ag2 %end;;
2420             id period REGFACT REGCATLEN regcatfac regvalue;
2421             var stcatval stcatvaf stcatvad /*stcatvfd stcatvfo stcatvdo*/ stcatvp stcatvmr
2422                 /*sqrmtr*/ numult /*NUMS PNUMS SNUMEAN PNUMEAN SNUMFAC PNUMFAC SLENFAC PLENFAC NUMSFAC PNUMSFAC*/;/*weight aggregated across stores by region and level*/
2423             output out=lev&ag(drop=_type_ _freq_)
2424             sum=stcatval stcatvaf stcatvad /*stcatvfd stcatvfo stcatvdo*/ stcatvp stcatvmr
2425                 /*tsqrmtr nstor NUMS PNUMS NUMEAN PNUMEAN NUMFAC PNUMFAC LENFAC PLENFAC NUMSFAC PNUMSFAC*/;
2426        %end;
2427       
2428       run;
2429       
2430       /*Merge projection weights with EAN level data*/
2431           %sortem(minstore,g1 s1 week store);
2432           %sortem(storeean,g1 s1 week store);
2433           %matchmerge(storeean,minstore,storeean,g1 s1 week store);
2434       
2435       /* Project store distribution variables for EAN level data*/
2436           data storeean;
2437           set storeean;
2438         /*  sqrmtr=sqrmtr*minwgt; */
2439           numult=minwgt;
2440         /*  nums=1;               */               /* indicator to calculate number of stores selling*/
2441         /*  PNUMS=nums*numult;     */              /* project num stores by universe to sample ratio*/
2442         /*  PNUMEAN=SNUMEAN*numult;  */            /* WEIGHT or NUMULT -- need to check*/
2443         /*  PNUMFAC=SNUMFAC;          */
2444         /*  PLENFAC=SLENFAC;           */
2445         /*  numsfac=(pnumfac > 0);     */          /*number of stores where num facings is greater than zero*/
2446         /*  pnumsfac=numsfac*numult;    */
2447       
2448           drop minwgt;
2449           run;
2450       
2451       run;
2452       
2453       
2454        /* Aggregate EAN level data by geography,period and EAN (across stores)*/
2455        %sortem(storeean,g1 s1 week EAN);
2456       
2457           proc means data=storeean noprint;
2458            by g1 s1 week EAN;
2459            id period regfact REGCATLEN regcatfac regvalue;
2460            var stcatval stcatvaf stcatvad /*stcatvfd stcatvfo stcatvdo*/ stcatvp stcatvmr
2461                  /*sqrmtr*/ numult /*NUMS PNUMS SNUMEAN PNUMEAN SNUMFAC PNUMFAC SLENFAC PLENFAC NUMSFAC PNUMSFAC*/;/*weight aggregated across stores by region and level*/
2462            output out=storeean(drop=_type_ _freq_)
2463            sum=stcatval stcatvaf stcatvad /*stcatvfd stcatvfo stcatvdo*/ stcatvp stcatvmr
2464                 /*tsqrmtr nstor NUMS PNUMS NUMEAN PNUMEAN NUMFAC PNUMFAC LENFAC PLENFAC NUMSFAC PNUMSFAC*/;
2465       
2466            %sortem(storeean,ean);
2467            %sortem(code,ean);
2468            %matchmerge(storeean,storeean,code,ean);
2469       
2470       
2471       
2472        /* Aggregate store distribution variables by g1 s1 period and store for each of the secondary totals*/
2473        %if &sectot > 0 %then
2474         %do;
2475          %do bi= 1 %to &sectot;
2476           %sortem(secmas&bi,g1 s1 week store lev1);
2477           proc summary data=secmas&bi noprint;
2478           by g1 s1 week store lev1;
2479           id period regfact REGCATLEN regcatfac regvalue;
2480           var /*sqrmtr*/ stcatval stcatvaf stcatvad /*stcatvfd stcatvfo stcatvdo*/ stcatvp stcatvmr
2481                numult stacv regacv /*NUMEAN PNUMFAC PLENFAC*/;
2482           output out=levst&bi(drop=_freq_  _type_) max= /* sum(NUMEAN PNUMFAC PLENFAC)=SNUMEAN SNUMFAC SLENFAC*/;
2483           run;
2484       
2485        /*Merge projection weights with secondary totals*/
2486           %sortem(minstore,g1 s1 week store);
2487           %sortem(levst&bi,g1 s1 week store);
2488           %matchmerge(levst&bi,minstore,levst&bi,g1 s1 week store);
2489       
2490       
2491           data levst&bi; set levst&bi;
2492          /* sqrmtr=sqrmtr*minwgt;*/
2493           numult=minwgt;
2494          /*  nums=1;     */                        /* indicator to calculate number of stores selling*/
2495          /*  PNUMS=nums*NUMULT; */                 /* project num stores by weight*/
2496          /*  PNUMEAN=SNUMEAN*NUMULT; */            /* minwgt or NUMULT -- need to check*/
2497          /*  PNUMFAC=SNUMFAC; */
2498          /*  PLENFAC=SLENFAC; */
2499          /*  numsfac=(pnumfac > 0); */             /*number of stores where num facings is greater than zero*/
2500          /*  pnumsfac=numsfac*NUMULT;  */
2501       
2502           drop minwgt;
2503           run;
2504       
2505          %sortem(levst&bi,g1 s1 week lev1);
2506       
2507             proc summary data=levst&bi nway;
2508             by g1 s1 week lev1;
2509             id period regfact REGCATLEN regcatfac NUMULT regvalue;
2510             var stcatval stcatvaf stcatvad /*stcatvfd stcatvfo stcatvdo*/ stcatvp stcatvmr
2511                 /*sqrmtr*/ numult /*NUMS PNUMS SNUMEAN PNUMEAN SNUMFAC PNUMFAC SLENFAC PLENFAC NUMSFAC PNUMSFAC*/;/*weight aggregated across stores by region and level*/
2512             output out=levst&bi (drop=_type_ _freq_)
2513             sum=stcatval stcatvaf stcatvad /*stcatvfd stcatvfo stcatvdo*/ stcatvp stcatvmr
2514                 /*tsqrmtr nstor NUMS PNUMS NUMEAN PNUMEAN NUMFAC PNUMFAC LENFAC PLENFAC NUMSFAC PNUMSFAC*/;
2515       
2516           %end;
2517         %end;
2518       
2519       
2520        data aggstore;
2521        set storeean %do ag3=1 %to &agglev; lev&ag3 %end;;
2522        run;
2523        %if &sectot > 0 %then
2524         %do;
2525          data aggstore;
2526          set aggstore %do ag4=1 %to &sectot; levst&ag4 %end;;
2527          run;
2528         %end;
2529       
2530       
2531       /*** 20131121 : Performance monitoring ***/
2532       %monitor(_mod_=4);
2533       /*** 20131121 : Performance monitoring ***/
2534       
2535       
2536       %mend aggstore_Infoscan;
2537       
2538       %aggstore_Infoscan(&plevel);
2539       
2540       /* END INSERT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
2541       /*=================================================================================*/
2542       
2543       
2544       %macro geoprep;
2545       /*Merge projection weights with store level data*/
2546       %let llineitem=%eval(&plevel*4 +14);
2547       
2548           %sortem(minstore,g1 s1 week store);
2549           %sortem(aggmast,g1 s1 week store);
2550           %matchmerge(aggmast,minstore,aggmast,g1 s1 week store);
2551       
2552        data aggmast(drop=k);
2553        set aggmast;
2554        array misscheck {&plevel} lev1-lev&plevel ;
2555        if ean='' then ean='00000000000000';
2556        do k=1 to &plevel ;
2557        if misscheck{k}=. then misscheck{k}=0;
2558        end;
2559       
2560        length lineitem $&llineitem;
2561        lineitem=compbl(lev1 ||
2562         %do rwr=2 %to &plevel;
2563          lev&rwr ||
2564         %end;
2565        ean);
2566       
2567        nums=(units > 0)  * numult;*sales;
2568        svals=(units > 0) * stcatval;*sales;
2569        acvs=(units > 0) *  stacv;*stacv;
2570        PNUMS=nums;                  /* project num stores by universe to sample ratio*/
2571        PNUMEAN=NUMEAN*numult;       /* WEIGHT or NUMULT -- need to check*/
2572        numsfac=(pnumfac > 0);       /*number of stores where num facings is greater than zero*/
2573        pnumsfac=numsfac*numult;
2574       
2575        run;
2576       
2577       
2578        %sortem(aggmast,g1 s1 week lineitem);
2579        proc summary data=aggmast noprint;
2580        id period factor stcatval regvalue regfact stacv regacv regcatlen regcatfac;
2581        by g1 s1 week lineitem ;
2582        var units volume value nums
2583            svals acvs pnums PNUMEAN PNUMFAC PLENFAC NUMSFAC PNUMSFAC
2584            /*** 20130906 : Add new measure M260/M261 ***/ bvalp incvalp valp
2585            incvolm bvolm inczerov /* Added by SOUZAS on 1904 ADDED BY A.A. on 18/02/2005 */
2586            stcatvaf stcatvad stcatvp stcatvmr     /* ADDED BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
2587            incvalm bvalm mkvalm                   /* Added by A.A. 2015/01/12 */
2588            volamspack valamspack                      /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
2589            ;
2590        output out=alltot(drop=_type_ _freq_) sum= ;
2591        run;
2592       
2593       
2594       
2595       /* START INSERT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
2596       
2597       data aggstore(drop=k);
2598        set aggstore;
2599        array misscheck {&plevel} lev1-lev&plevel ;
2600        if ean='' then ean='00000000000000';
2601        do k=1 to &plevel ;
2602         if misscheck{k}=. then misscheck{k}=0;
2603        end;
2604       
2605        length lineitem $&llineitem;
2606        lineitem=compbl(lev1 ||
2607         %do rwr=2 %to &plevel;
2608          lev&rwr ||
2609         %end;
2610        ean);
2611       
2612       
2613       proc sort data=alltot; by g1 s1 week lineitem;
2614       proc sort data=aggstore; by g1 s1 week lineitem;
2615       
2616       data alltot; merge alltot(in=a) aggstore(in=b);
2617         by g1 s1 week lineitem;
2618         if a;
2619         run;
2620       
2621       
2622       %sortem(alltot,g1 s1 week);
2623       %sortem(tstctval,g1 s1 week);
2624       
2625       data alltot;
2626        merge alltot tstctval;
2627        by g1 s1 week;
2628       run;
2629       
2630       /* END INSERT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
2631       
2632       
2633       /*** 20131121 : Performance monitoring ***/
2634       %monitor(_mod_=4);
2635       /*** 20131121 : Performance monitoring ***/
2636       
2637       
2638       %mend geoprep;
2639       %geoprep;
2640       
2641       %MEND AGGREGATION_ISCAN;
2642       
2643       *%AGGREGATION_ISCAN;
2644       
2645       
2646       %MACRO AGGREGATION_Promoscan;
2647       
2648       /*Note: some products do not contribute to the category sales totals
2649               the hierarchy spreadsheet takes account of this*/
2650       
2651       /**Aggregate sales by store category*/
2652       
2653        %macro aggvalue_cwd;
2654       
2655       %sortem(master, g1 s1 week store);
2656       
2657         proc summary data=master nway;    /*STCATVAL used for CWD*/
2658           var value units volume Plenfac; /* added LENFAC -- length of facings by region period*/
2659           by g1 s1 week store;
2660         output out=stcatval(drop=_type_ _freq_) sum=stcatval stcatuni stcatvol stcatlen;
2661         run;
2662       
2663         %printdeb(stcatval,Region period store category value totals);
2664         run;
2665       
2666         /*Aggregate sales and facing length by region period*/
2667        proc means data=stcatval noprint;                 /*TSTCTVAL used for CWD*/
2668          var stcatval stcatuni stcatvol stcatlen;
2669          by g1 s1 week ;
2670        output out=tstctval(drop=_type_ _freq_)
2671        sum=tstctval tstctuni tstctvol tstctlen;/* tstctlen -- used for measure: Share of Shelf Space*/
2672        run;
2673       
2674        %printdeb(tstctval,Region period category value totals);
2675         run;
2676       
2677        proc print data=tstctval; title 'tstctval';
2678        run;
2679       
2680        data master; merge stcatval(in=a) master(in=b);       /*Merge store-category value totals with MAST*/
2681          by g1 s1 week store;
2682          if b;
2683          stcatvaf=0; stcatvad=0; stcatvfd=0; stcatvfo=0; stcatvdo=0; stcatvp=0; stcatvmr=0; stcatvfp=0; stcatvdp=0; stcatvfdp=0;
2684          if feat1 > 0 then stcatvaf=stcatval;                                             /*any feature*/
2685          if disp1 > 0 then stcatvad=stcatval;                                             /*any display*/
2686          if feat1 > 0 and disp1 = 0 then stcatvfo=stcatval;                               /*feature only*/
2687          if disp1 > 0 and feat1 = 0 then stcatvdo=stcatval;                               /*Display only*/
2688          if (prdn > 0 and feat1=0 and disp1=0) then stcatvp=stcatval;                     /*pred only*/
2689          if feat1 > 0 or disp1 > 0 or instore >0 or prdn > 0 then stcatvmr=stcatval;      /*any merch*/
2690          if feat1 > 0 and disp1 > 0 then stcatvfd=stcatval;                               /*feat and display*/
2691       /************* 05022018 New Measures ***/
2692          if feat1 > 0 and prdn > 0 then stcatvfp=stcatval;                                /* feature and TPR */
2693          if disp1 > 0 and prdn > 0 then stcatvdp=stcatval;                                /* Display and TPR */
2694          if feat1 > 0 and disp1 > 0 and prdn > 0 then stcatvfdp=stcatval;                 /* CWD Feature and Display and TPR */
2695       /************* 05022018 New Measures ***/
2696        run;
2697       
2698       *----------------------------------------------------------------------------------;
2699       
2700       /*Save Master files per week for Iscan and Combined -- unable to save aggregate files
2701        because of distribution measures but can save subsetted files merged with dict,geog files etc*/
2702       
2703       
2704       /*** 20131121 : Performance monitoring ***/
2705       %monitor(_mod_=4);
2706       /*** 20131121 : Performance monitoring ***/
2707       
2708       
2709       %mend aggvalue_cwd;
2710       
2711       %aggvalue_cwd;
2712       
2713       /* Read secondary totals that are generated by the Conversion_v10.sas */
2714          %macro readsectotals;
2715            %if &sectot > 0 %then
2716             %do;
2717                %do si= 1 %to &sectot;
2718                  %let setinc=%eval(&si * 1000);
2719                  %let settop=%eval(&setinc + 1000);
2720       
2721                  data sectot&si ;
2722                  set sectot;
2723                  if &settop > lev1 >= &setinc;
2724                  run;
2725                %end;
2726             %end;
2727       
2728            %if &sectot > 0 %then
2729              %do;
2730                 %do ai= 1 %to &sectot;
2731                 %sortem(sectot&ai,ean);    /*changed from item to EAN*/
2732                %end;
2733             %end;
2734       
2735       
2736       /*** 20131121 : Performance monitoring ***/
2737       %monitor(_mod_=4);
2738       /*** 20131121 : Performance monitoring ***/
2739       
2740       
2741        %mend readsectotals;
2742        %readsectotals;
2743        *-----------------------------------------------------------------------------------;
2744       /*calculate incremental volume*/
2745       %macro calcincvolume;
2746       
2747       %sortem(master,g1 s1 week ean); *change from promo;
2748       
2749       proc summary data=master sum nway;
2750       by g1 s1 week EAN;
2751       var incvolm;
2752       output out=totinc(drop=_type_ _freq_) sum=totinc;
2753       run;
2754       
2755       %matchmerge(master,master,totinc,g1 s1 week ean);
2756       
2757       data master; set master;
2758       inczerou=incunim;
2759        inczerov=incvolm;
2760          if totinc<0 then                   /*zero out negative incremental volume*/
2761            do;
2762              inczerou=0;
2763              inczerov=0;
2764            end;
2765       
2766       %printdeb(master,Before Summing);
2767       
2768       proc summary data=master sum nway;    /*aggregate incremental by geog and period*/
2769       by g1 s1 week;
2770       var inczerou inczerov incvalm;
2771       output out=catincr(drop=_type_ _freq_) sum=catincu catincv catincva;
2772       run;
2773       
2774       
2775       /*** 20131121 : Performance monitoring ***/
2776       %monitor(_mod_=4);
2777       /*** 20131121 : Performance monitoring ***/
2778       
2779       
2780       %mend calcincvolume;
2781       
2782       %calcincvolume;
2783       
2784       
2785        /********* Creates master files for each secondary total****************************/
2786        %macro mastersectot;
2787          %if &sectot > 0 %then
2788          %do;
2789          data mastsectot;
2790          set master(drop=lev1-lev&plevel ); /*change -- dropping item and keeping EAN*/
2791          item=.;
2792          drop item;
2793          numean=1;
2794          run;
2795          %sortem(mastsectot, ean);           /*changed from item to EAN*/
2796          %do bi= 1 %to &sectot;
2797          %matchmerge(secmas&bi,mastsectot,sectot&bi,ean); /*changed from item to EAN*/
2798          %end;
2799         %end;
2800       
2801       
2802       /*** 20131121 : Performance monitoring ***/
2803       %monitor(_mod_=4);
2804       /*** 20131121 : Performance monitoring ***/
2805       
2806       
2807        %mend mastersectot;
2808        %mastersectot;
2809       
2810       
2811       
2812       /*********** Aggregate SALES for standard levels and sec totals**************/
2813       %MACRO aggsales_pscan (agglev);
2814       
2815       %let vlist1=volume value pvolume pvalue units; /*aggregation variables*/
2816       %let vlist2= tvolume tvalue tpvol tpval tunits;
2817       
2818       /* Aggregate sales by g1 s1 period for the EAN level*/
2819         proc summary data=master sum nway;
2820         by g1 s1 week ean;
2821         id regcatlen regcatfac period %do ag=1 %to &agglev; lev&ag %end;;
2822         var volume value pvolume pvalue units;
2823         output out=masterean(drop=_freq_ _type_) sum=&vlist2   ;
2824         run;
2825       
2826       /* Aggregate sales by g1 s1 period for the each of the standard levels*/
2827        %sortem(master,g1 s1 week  %do ag=1 %to &agglev; lev&ag %end;);
2828       
2829        /*** 20150217 : Performance-enhancement ***/
2830        %do ag=&agglev %to 1 %by -1;
2831           %if &ag = &agglev %then %do;
2832              proc summary data=master noprint;
2833              var volume value pvolume pvalue units;
2834           %end;
2835           %else %do;
2836              proc summary data=lev&ag_prev noprint;
2837              var &vlist2;
2838           %end;
2839              by g1 s1 week %do ag2=1 %to &ag; lev&ag2 %end;;
2840              id regcatlen regcatfac period;
2841              output out=lev&ag(drop=_freq_ _type_) sum=&vlist2; /* to get length of facings by region period and level */
2842           run;
2843           %let ag_prev=&ag;
2844        %end;
2845        /*** 20150217 : Performance-enhancement ***/
2846       
2847        /* Aggregate sales by g1 s1 period for the each of the secondary totals*/
2848        %if &sectot > 0 %then
2849        %do;
2850           %do bi= 1 %to &sectot;
2851              %sortem(secmas&bi,g1 s1 week lev1);
2852              proc summary data=secmas&bi noprint;
2853                 id regcatlen regcatfac period;
2854                 by g1 s1 week lev1;
2855                 var volume value pvolume pvalue units;
2856                 output out=levst&bi(drop=_freq_ _type_) sum=&vlist2  ;
2857              run;
2858           %end;
2859        %end;
2860       
2861        /*** 20150217 : Performance-enhancement ***/
2862        data aggmast;
2863        set masterean %do ag3=1 %to &agglev; lev&ag3 %end;
2864        %if &sectot > 0 %then %do;
2865           %do ag4=1 %to &sectot; levst&ag4 %end;
2866        %end;
2867        ;
2868        run;
2869        /*** 20150217 : Performance-enhancement ***/
2870       
2871       /*** 20131121 : Performance monitoring ***/
2872       %monitor(_mod_=4);
2873       /*** 20131121 : Performance monitoring ***/
2874       
2875       
2876       %mend aggsales_pscan;
2877       
2878       %aggsales_pscan(&plevel);
2879       
2880       
2881       /**************Aggregate promo sales for standard levels and sec totals*****************/
2882       %MACRO aggpromo_pscan (agglev);
2883       
2884       /*variables to aggregate for promotion measures*/
2885       %let vlist1= mkvalm incvolm incvalm incunim bvolm bvalm bunim flagm
2886                    mkvalfd incvolfd incvalfd incunifd bvolfd bvalfd bunifd flagfd
2887                    mkvalf incvolf incvalf incunif bvolf bvalf bunif flagf
2888                    mkvald incvold incvald incunid bvold bvald bunid flagd
2889                    mkvalp incvolp incvalp incunip bvolp bvalp bunip flagp
2890                    flagaf flagad inczerou inczerov
2891                    volamspack valamspack              /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
2892       /************* 05022018 New Measures ***/
2893                    bvolof bvalof buniof
2894                    bvolod bvalod buniod
2895                    bvolop bvalop buniop
2896                    bvolofdp bvalofdp buniofdp
2897                    bvolofd bvalofd buniofd
2898                    bvolofp bvalofp buniofp
2899                    bvolodp bvalodp buniodp
2900                    incvolof incvalof incuniof
2901                    incvolod incvalod incuniod
2902                    incvolop incvalop incuniop
2903                    incvolofdp incvalofdp incuniofdp
2904                    incvolofd incvalofd incuniofd
2905                    incvolofp incvalofp incuniofp
2906                    incvolodp incvalodp incuniodp
2907       /************* 05022018 New Measures ***/
2908                    ;
2909       
2910       /*Aggregate promotion variables for EAN level*/
2911         %sortem(master,g1 s1 week store ean);
2912         proc summary data=master noprint;
2913         by g1 s1 week store ean;
2914         id period;
2915         var &vlist1;                              /*list of promo variables to aggregate*/
2916         output out=promoean(drop=_freq_ _type_)   /*sum across promo vars, also identify of promos exists at each level*/
2917         sum=  max(flagm  flagfd  flagf  flagd  flagp  flagaf  flagad)=
2918                    mflagm mflagfd mflagf mflagd mflagp mflagaf mflagad;
2919       
2920       
2921        /*Aggregate promotion variables for standard levels*/
2922        %sortem(master,g1 s1 week store %do ag=1 %to &agglev; lev&ag %end;);
2923       
2924       
2925       
2926       /*** 20150217 : Performance-enhancement ***/
2927       sasfile master open;
2928       
2929        %do ag=1 %to &agglev ;
2930         proc summary data=master sum nway;
2931         by g1 s1 week store %do ag2=1 %to &ag; lev&ag2 %end;;
2932         id period;
2933         var &vlist1;                             /*list of promo variables to aggregate*/
2934         output out=lev&ag(drop=_freq_ _type_)   /*sum across promo vars, also identify of promos exists at each level*/
2935         sum= max(flagm flagfd flagf flagd flagp flagaf flagad)=
2936                   mflagm  mflagfd mflagf mflagd mflagp mflagaf mflagad;
2937         run;
2938       
2939       /*Merge projection weights with standard levels*/
2940           %sortem(minstore,g1 s1 week store);
2941           %matchmerge(lev&ag,minstore,lev&ag,g1 s1 week store);
2942       
2943       /* Project promotion flags for standard levels*/
2944           data lev&ag; set lev&ag;
2945           flagm=minwgt*mflagm;
2946           flagfd=minwgt*mflagfd;
2947           flagf=minwgt*mflagf;
2948           flagd=minwgt*mflagd;
2949           flagp=minwgt*mflagp;
2950           flagaf=minwgt*mflagaf;
2951           flagad=minwgt*mflagad;
2952           run;
2953       
2954           %sortem(lev&ag,g1 s1 week %do ag2=1 %to &ag; lev&ag2 %end;);
2955       
2956           proc means data=lev&ag noprint;
2957            by g1 s1 week %do ag2=1 %to &ag; lev&ag2 %end;;
2958            var &vlist1 minwgt;
2959            id period;
2960            output out=lev&ag(drop=_type_ _freq_) sum=&vlist1 sum(minwgt)=weight;
2961           run;
2962       
2963         run;
2964        %end;
2965       
2966       sasfile master close;
2967       /*** 20150217 : Performance-enhancement ***/
2968       
2969       
2970       
2971       
2972       
2973       /*Merge projection weights with EAN level data*/
2974           %sortem(minstore,g1 s1 week store);
2975           %sortem(promoean,g1 s1 week store);
2976           %matchmerge(promoean,minstore,promoean,g1 s1 week store);
2977       
2978       
2979       /* Project promotion flags for EAN level data*/
2980           data promoean; set promoean;
2981           flagm=minwgt*mflagm;
2982           flagfd=minwgt*mflagfd;
2983           flagf=minwgt*mflagf;
2984           flagd=minwgt*mflagd;
2985           flagp=minwgt*mflagp;
2986           flagaf=minwgt*mflagaf;
2987           flagad=minwgt*mflagad;
2988       
2989        /* Aggregate EAN level data by geography,period and EAN (across stores)*/
2990        %sortem(promoean,g1 s1 week EAN);
2991       
2992           proc means data=promoean noprint;
2993               by g1 s1 week EAN;
2994               id period;
2995               var &vlist1 minwgt;
2996               output out=promoean(drop=_type_ _freq_) sum=&vlist1 sum(minwgt)=weight;
2997               run;
2998       
2999               %sortem(promoean,ean);
3000               %sortem(code,ean);
3001               %matchmerge(promoean,promoean,code,ean);
3002       
3003       
3004        /* Aggregate promoted sales and flags by g1 s1 period and store for each of the secondary totals*/
3005        %if &sectot > 0 %then
3006         %do;
3007          %do bi= 1 %to &sectot;
3008           %sortem(secmas&bi,g1 s1 week store lev1);
3009           proc summary data=secmas&bi noprint;
3010           by g1 s1 week store lev1;
3011           id period;
3012           var &vlist1;
3013           output out=levst&bi(drop=_freq_ _type_)
3014            sum=
3015            max(flagm flagfd flagf flagd flagp flagaf flagad)=mflagm mflagfd mflagf mflagd mflagp mflagaf mflagad;
3016           run;
3017       
3018           /*** 20150217 : Performance-enhancement ***/
3019           %if &bi=1 %then %do; %sortem(minstore,g1 s1 week store); %end;
3020           /*** 20150217 : Performance-enhancement ***/
3021       
3022       /*** 20150217 : Performance-enhancement ***/
3023       /*** both steps together in one ***
3024           %matchmerge(levst&bi,minstore,levst&bi,g1 s1 week store);
3025           data levst&bi; set levst&bi;
3026           flagm=minwgt*mflagm;
3027           flagfd=minwgt*mflagfd;
3028           flagf=minwgt*mflagf;
3029           flagd=minwgt*mflagd;
3030           flagp=minwgt*mflagp;
3031           flagaf=minwgt*mflagaf;
3032           flagad=minwgt*mflagad;
3033       *************************************************************/
3034       data levst&bi;
3035          merge minstore(in=a1) levst&bi(in=a2);
3036          by g1 s1 week store;
3037          if a1 and a2 then do;
3038             flagm=minwgt*mflagm;
3039             flagfd=minwgt*mflagfd;
3040             flagf=minwgt*mflagf;
3041             flagd=minwgt*mflagd;
3042             flagp=minwgt*mflagp;
3043             flagaf=minwgt*mflagaf;
3044             flagad=minwgt*mflagad;
3045             output;
3046          end;
3047       /*** 20150217 : Performance-enhancement ***/
3048       
3049       
3050           %sortem(levst&bi,g1 s1 week lev1);
3051       
3052           proc summary data=levst&bi sum nway;
3053            by g1 s1 week lev1;
3054            id period;
3055            var &vlist1 minwgt;
3056            output out=levst&bi(drop=_type_ _freq_) sum=&vlist1 sum(minwgt)=weight;
3057            run;
3058          %end;
3059         %end;
3060       
3061        /*combine aggregated promoted sales for standard levels and secondary totals*/
3062        data aggpromo;
3063        set promoean %do ag3=1 %to &agglev; lev&ag3 %end;;
3064        run;
3065        %if &sectot > 0 %then
3066         %do;
3067          data aggpromo;
3068          set aggpromo %do ag4=1 %to &sectot; levst&ag4 %end;;
3069          run;
3070         %end;
3071       
3072       
3073       /*** 20131121 : Performance monitoring ***/
3074       %monitor(_mod_=4);
3075       /*** 20131121 : Performance monitoring ***/
3076       
3077       
3078        %mend aggpromo_pscan;
3079       
3080       %aggpromo_pscan(&plevel);
3081       
3082       /*Aggregate by levels across stores to get distribution measures*/
3083       
3084       %MACRO aggstore_pscan (agglev);
3085       
3086       /*Notes: Category Weighted Distribution caluclated by using category value totals*/
3087       /*Notes: Numerical distribution calculated by using the sample and universe numbers*/
3088       /*Notes: from the Universe file instead of the sum of the weights of the stores selling as in old PromoScan*/
3089       /*Notes: REGFACT and NUMULT used for calculating numerical distribution*/
3090       /*Notes: REGFACT= # universe stores*/
3091       /*Notes: NUMULT= # universe stores/#sample stores*/
3092       /*Facings aggregation is done here -- lenfac and numfac are aggregated*/
3093       
3094       
3095       data master;
3096        set master;
3097        numean=1;  /*NUMEAN used to count EANs and used to aggregate by region, period, and level*/
3098       
3099       /*Aggregate distribution variables for EAN level*/
3100        %sortem(master,g1 s1 week store ean);
3101         proc summary data=master noprint;
3102         by g1 s1 week store ean;
3103         id period regfact REGCATLEN regcatfac regvalue;
3104         var sqrmtr stcatval stcatvaf stcatvad stcatvfd stcatvfo stcatvdo stcatvp stcatvmr stcatvfp stcatvdp stcatvfdp
3105             numult stacv regacv NUMEAN PNUMFAC PLENFAC;
3106         output out=storeean(drop=_freq_ _type_) max=  sum(NUMEAN PNUMFAC PLENFAC)=SNUMEAN SNUMFAC SLENFAC;
3107         run;
3108       
3109       run;
3110       
3111        /*Aggregate store distribution variables for standard levels*/
3112         %sortem(master,g1 s1 week store %do ag=1 %to &agglev; lev&ag %end;);
3113       
3114       /*** 20150217 : Performance-enhancement ***/
3115        sasfile master open;
3116        %do ag=1 %to &agglev;
3117           proc summary data=master noprint;
3118           by g1 s1 week store %do ag2=1 %to &ag; lev&ag2 %end;;
3119           id period regfact REGCATLEN regcatfac regvalue;   /*regcatlen is the region total for facings length*/
3120           var sqrmtr stcatval stcatvaf stcatvad stcatvfd stcatvfo stcatvdo stcatvp stcatvmr stcatvfp stcatvdp stcatvfdp
3121               numult stacv regacv NUMEAN PNUMFAC PLENFAC;
3122           output out=lev&ag(drop=_freq_ _type_) max=   sum(NUMEAN PNUMFAC PLENFAC)=SNUMEAN SNUMFAC SLENFAC;
3123           run;
3124       
3125           %printdeb(lev&ag,levels aggregated to geog period store and lev&ag); run;
3126       
3127           /*Merge projection weights with standard levels*/
3128           /*** 20150217 : Performance-enhancement ***/
3129           /*  %sortem(minstore,g1 s1 week store);  - already done in earlier step */
3130           /*  %sortem(lev&ag,g1 s1 week store);    - already done by proc summary */
3131           /*** 20150217 : Performance-enhancement ***/
3132       
3133           /* Project distribution variables for standard levels*/
3134           data lev&ag;
3135           merge lev&ag(in=a) minstore(in=b);
3136           by g1 s1 week store;
3137           sqrmtr=sqrmtr*minwgt;
3138           weight=minwgt;
3139           NUMS=1;                             /* indicator to calculate number of stores selling*/
3140           PNUMS=nums*numult;                  /* project num stores by universe to sample ratio*/
3141           PNUMEAN=SNUMEAN*numult;             /* WEIGHT or NUMULT -- need to check*/
3142           PNUMFAC=SNUMFAC;
3143           PLENFAC=SLENFAC;
3144           numsfac=(pnumfac > 0);              /*number of stores where num facings is greater than zero*/
3145           pnumsfac=numsfac*numult;
3146           drop minwgt;
3147           run;
3148       
3149           %sortem(lev&ag,g1 s1 week %do ag2=1 %to &ag; lev&ag2 %end;);
3150           proc summary data=lev&ag nway;
3151           by g1 s1 week %do ag2=1 %to &ag; lev&ag2 %end;;
3152           id period REGFACT REGCATLEN regcatfac regvalue;
3153           var stcatval stcatvaf stcatvad stcatvfd stcatvfo stcatvdo stcatvp stcatvmr stcatvfp stcatvdp stcatvfdp
3154               sqrmtr weight NUMS PNUMS SNUMEAN PNUMEAN SNUMFAC PNUMFAC SLENFAC PLENFAC NUMSFAC PNUMSFAC;/*weight aggregated across stores by region and level*/
3155           output out=lev&ag(drop=_type_ _freq_)
3156           sum=stcatval stcatvaf stcatvad stcatvfd stcatvfo stcatvdo stcatvp stcatvmr stcatvfp stcatvdp stcatvfdp
3157               tsqrmtr nstor NUMS PNUMS NUMEAN PNUMEAN NUMFAC PNUMFAC LENFAC PLENFAC NUMSFAC PNUMSFAC;
3158           run;
3159        %end;
3160        sasfile master close;
3161       /*** 20150217 : Performance-enhancement ***/
3162       
3163       
3164       /*Merge projection weights with EAN level data*/
3165       /*** 20150217 : Performance-enhancement ***/
3166       /*  %sortem(minstore,g1 s1 week store);  - already done in earlier step */
3167           %sortem(storeean,g1 s1 week store);
3168       
3169       
3170       /* Project store distribution variables for EAN level data*/
3171       /*** 20150217 : Performance-enhancement ***/
3172       /*    %matchmerge(storeean,minstore,storeean,g1 s1 week store);*/
3173       /*    data storeean;*/
3174       /*    set storeean;*/
3175       data storeean(drop=minwgt);
3176          merge minstore(in=a1) storeean(in=a2);
3177          by g1 s1 week store;
3178          if a1 and a2 then do;
3179           sqrmtr=sqrmtr*minwgt;
3180           weight=minwgt;
3181           nums=1;                             /* indicator to calculate number of stores selling*/
3182           PNUMS=nums*numult;                  /* project num stores by universe to sample ratio*/
3183           PNUMEAN=SNUMEAN*numult;             /* WEIGHT or NUMULT -- need to check*/
3184           PNUMFAC=SNUMFAC;
3185           PLENFAC=SLENFAC;
3186           numsfac=(pnumfac > 0);              /*number of stores where num facings is greater than zero*/
3187           pnumsfac=numsfac*numult;
3188           output;
3189          end;
3190       run;
3191       /*** 20150217 : Performance-enhancement ***/
3192       
3193       
3194       run;
3195       
3196       
3197        /* Aggregate EAN level data by geography,period and EAN (across stores)*/
3198        %sortem(storeean,g1 s1 week EAN);
3199       
3200           proc means data=storeean noprint;
3201            by g1 s1 week EAN;
3202            id period regfact REGCATLEN regcatfac regvalue;
3203            var stcatval stcatvaf stcatvad stcatvfd stcatvfo stcatvdo stcatvp stcatvmr stcatvfp stcatvdp stcatvfdp
3204                  sqrmtr weight NUMS PNUMS SNUMEAN PNUMEAN SNUMFAC PNUMFAC SLENFAC PLENFAC NUMSFAC PNUMSFAC;/*weight aggregated across stores by region and level*/
3205            output out=storeean(drop=_type_ _freq_)
3206            sum=stcatval stcatvaf stcatvad stcatvfd stcatvfo stcatvdo stcatvp stcatvmr stcatvfp stcatvdp stcatvfdp
3207                 tsqrmtr nstor NUMS PNUMS NUMEAN PNUMEAN NUMFAC PNUMFAC LENFAC PLENFAC NUMSFAC PNUMSFAC;
3208       
3209            %sortem(storeean,ean);
3210            %sortem(code,ean);
3211            %matchmerge(storeean,storeean,code,ean);
3212       
3213       
3214       
3215       
3216        /* Aggregate store distribution variables by g1 s1 period and store for each of the secondary totals*/
3217        %if &sectot > 0 %then
3218         %do;
3219          %do bi= 1 %to &sectot;
3220           %sortem(secmas&bi,g1 s1 week store lev1);
3221           proc summary data=secmas&bi noprint;
3222           by g1 s1 week store lev1;
3223           id period regfact REGCATLEN regcatfac regvalue;
3224           var sqrmtr stcatval stcatvaf stcatvad stcatvfd stcatvfo stcatvdo stcatvp stcatvmr stcatvfp stcatvdp stcatvfdp
3225                numult stacv regacv NUMEAN PNUMFAC PLENFAC;
3226           output out=levst&bi(drop=_freq_  _type_) max=  sum(NUMEAN PNUMFAC PLENFAC)=SNUMEAN SNUMFAC SLENFAC;
3227           run;
3228       
3229        /*Merge projection weights with secondary totals*/
3230           %sortem(minstore,g1 s1 week store);
3231           %sortem(levst&bi,g1 s1 week store);
3232           %matchmerge(levst&bi,minstore,levst&bi,g1 s1 week store);
3233       
3234       
3235           data levst&bi; set levst&bi;
3236           sqrmtr=sqrmtr*minwgt;
3237           weight=minwgt;
3238           nums=1;                             /* indicator to calculate number of stores selling*/
3239           PNUMS=nums*NUMULT;                  /* project num stores by weight*/
3240           PNUMEAN=SNUMEAN*NUMULT;             /* minwgt or NUMULT -- need to check*/
3241           PNUMFAC=SNUMFAC;
3242           PLENFAC=SLENFAC;
3243           numsfac=(pnumfac > 0);              /*number of stores where num facings is greater than zero*/
3244           pnumsfac=numsfac*NUMULT;
3245       
3246           drop minwgt;
3247           run;
3248       
3249          %sortem(levst&bi,g1 s1 week lev1);
3250       
3251             proc summary data=levst&bi nway;
3252             by g1 s1 week lev1;
3253             id period regfact REGCATLEN regcatfac NUMULT regvalue;
3254             var stcatval stcatvaf stcatvad stcatvfd stcatvfo stcatvdo stcatvp stcatvmr stcatvfp stcatvdp stcatvfdp
3255                 sqrmtr weight NUMS PNUMS SNUMEAN PNUMEAN SNUMFAC PNUMFAC SLENFAC PLENFAC NUMSFAC PNUMSFAC;/*weight aggregated across stores by region and level*/
3256             output out=levst&bi (drop=_type_ _freq_)
3257             sum=stcatval stcatvaf stcatvad stcatvfd stcatvfo stcatvdo stcatvp stcatvmr stcatvfp stcatvdp  stcatvfdp
3258                 tsqrmtr nstor NUMS PNUMS NUMEAN PNUMEAN NUMFAC PNUMFAC LENFAC PLENFAC NUMSFAC PNUMSFAC;
3259       
3260           %end;
3261         %end;
3262       
3263       /*** 20150217 : Performance-enhancement ***/
3264        data aggstore;
3265        set storeean %do ag3=1 %to &agglev; lev&ag3 %end;
3266        %if &sectot > 0 %then %do;
3267           %do ag4=1 %to &sectot; levst&ag4 %end;
3268        %end;
3269        ;
3270        run;
3271       /*** 20150217 : Performance-enhancement ***/
3272       
3273       /*** 20131121 : Performance monitoring ***/
3274       %monitor(_mod_=4);
3275       /*** 20131121 : Performance monitoring ***/
3276       
3277       
3278       %mend aggstore_pscan;
3279       
3280       %aggstore_pscan(&plevel);
3281       
3282       %macro combine_aggfiles_Promoscan;
3283       /*combine sales, promo, and distribution aggregate files*/
3284       %let llineitem=%eval(&plevel*4 +14);
3285       data aggmast(drop=k);
3286        set aggmast;
3287        array misscheck {&plevel} lev1-lev&plevel ;
3288        if ean='' then ean='00000000000000';             /*change item to ean*/
3289        do k=1 to &plevel ;
3290         if misscheck{k}=. then misscheck{k}=0;
3291        end;
3292        length lineitem $&llineitem;
3293        lineitem=compbl(lev1 ||
3294         %do rwr=2 %to &plevel;
3295          lev&rwr ||
3296         %end;
3297        ean);
3298       
3299       run;
3300       
3301       data aggstore(drop=k);
3302        set aggstore;
3303        array misscheck {&plevel} lev1-lev&plevel ;
3304        if ean='' then ean='00000000000000';
3305        do k=1 to &plevel ;
3306         if misscheck{k}=. then misscheck{k}=0;
3307        end;
3308       
3309        length lineitem $&llineitem;
3310        lineitem=compbl(lev1 ||
3311         %do rwr=2 %to &plevel;
3312          lev&rwr ||
3313         %end;
3314        ean);
3315       
3316       
3317       data aggpromo(drop=k);
3318        set aggpromo;
3319        array misscheck {&plevel} lev1-lev&plevel ;
3320        if ean='' then ean='00000000000000';
3321        do k=1 to &plevel ;
3322        if misscheck{k}=. then misscheck{k}=0;
3323        end;
3324        length lineitem $&llineitem;
3325        lineitem=compbl(lev1 ||
3326         %do rwr=2 %to &plevel;
3327          lev&rwr ||
3328         %end;
3329        ean);
3330       
3331       
3332       proc sort data=aggmast;  by g1 s1 week lineitem;
3333       proc sort data=aggpromo; by g1 s1 week lineitem;
3334       proc sort data=aggstore; by g1 s1 week lineitem;
3335       
3336       data alltot; merge aggmast(in=a) aggstore(in=b) aggpromo(in=c);
3337         by g1 s1 week lineitem;
3338         if a;
3339         if not c then do;     /*zero out incremental if no promotion exists*/
3340           mkvalm=0; incvolm=0;incvalm=0;incunim=0;bvolm=0;bvalm=0;bunim=0;flagm=0;
3341           incvolfd=0;incvalfd=0;incunifd=0;bvolfd=0;bvalfd=0;bunifd=0;flagfd=0;
3342           incvolf=0;incvalf=0;incunif=0;bvolf=0;bvalf=0;bunif=0;flagf=0;
3343           incvold=0;incvald=0;incunid=0;bvold=0;bvald=0;bunid=0;flagd=0;
3344           incvolp=0;incvalp=0;incunip=0;bvolp=0;bvalp=0;bunip=0;flagp=0; flagaf=0; flagad=0;
3345           inczerou=0; inczerov=0;
3346       /************* 05022018 New Measures ***/
3347           bvolof=0; bvalof=0; buniof=0;
3348           bvolod=0; bvalod=0; buniod=0;
3349           bvolop=0; bvalop=0; buniop=0;
3350           bvolofdp=0; bvalofdp=0; buniofdp=0;
3351           bvolofd=0; bvalofd=0; buniofd=0;
3352           bvolofp=0; bvalofp=0; buniofp=0;
3353           bvolodp=0; bvalodp=0; buniodp=0;
3354       
3355           incvolof=0; incvalof=0; incuniof=0;
3356           incvolod=0; incvalod=0; incuniod=0;
3357           incvolop=0; incvalop=0; incuniop=0;
3358           incvolofdp=0; incvalofdp=0; incuniofdp=0;
3359           incvolofd=0; incvalofd=0; incuniofd=0;
3360           incvolofp=0; incvalofp=0; incuniofp=0;
3361           incvolodp=0; incvalodp=0; incuniodp=0;
3362       
3363       /************* 05022018 New Measures ***/
3364       
3365       
3366         end;
3367         if volamspack<0 then volamspack=0;           /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
3368         if valamspack<0 then valamspack=0;           /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
3369       
3370       run;
3371       
3372       
3373       /*** 20131121 : Performance monitoring ***/
3374       %monitor(_mod_=4);
3375       /*** 20131121 : Performance monitoring ***/
3376       
3377       
3378       %mend combine_aggfiles_Promoscan;
3379       %combine_aggfiles_Promoscan;
3380       
3381       
3382       
3383       %MEND AGGREGATION_Promoscan;
3384       *%AGGREGATION_Promoscan;
3385       
3386       /* Write out 8 week-aggregate PromoScan file to be used as input to Iscan and Combined Services*/
3387       /* Note need number of stores to recalculate distribution*/
3388       
3389       %macro setupmeasures_Promoscan;
3390       
3391       /*notes: tstores is number of stores by adding weights by g1 s1 period*/
3392       /*notes: can use regfact as this is used in numerical distribution*/
3393       /*notes: REGFACT is the number of Universe stores from the Universe file*/
3394       
3395       %sortem(alltot,g1 s1 week);
3396       %sortem(totstore,g1 s1 week);  /*need to investigate whether we need this dataset*/
3397       %sortem(tstctval,g1 s1 week);
3398       %sortem(catincr,g1 s1 week);
3399       
3400        data alltot;
3401        merge alltot totstore tstctval catincr;
3402        by g1 s1 week;
3403       
3404        catbaseu=tstctuni-catincu;
3405        catbasev=tstctvol-catincv;
3406        catbased=tstctval-catincva;
3407       
3408        tbvol2 =tvolume-inczerov;        /*** Base volume taking into account zeroing out **/
3409        tbuni2 =tunits-inczerou;        /*** Base units taking into account zeroing out **/
3410        tbval2 =tvalue-incvalm;
3411       
3412        tvolfd=bvolfd+incvolfd;                         /*** volume on fd *****/
3413        tunifd=bunifd+incunifd;                         /*** volume on fd *****/
3414        tvalfd=bvalfd+incvalfd;                         /*** volume on fd *****/
3415        pctvofd=tvolfd*100/tvolume;                     /*** % of volume of fd *****/
3416        pctufd=tunifd*100/tunits;                       /*** % of volume of fd *****/
3417        pctvafd=tvalfd*100/tvalue;                      /*** % of volume of fd *****/
3418        if inczerov=0 then pctbfdv=tvolfd/tvolume*100;
3419         else pctbfdv=bvolfd/tbvol2*100;
3420        if inczerou=0 then pctbfdu=tunifd/tunits*100;
3421         else pctbfdu=bunifd/tbuni2*100;
3422        pctbfdva=bvalfd/tbval2*100;
3423        if incvolfd>0 then pinvolfd=incvolfd/bvolfd*100;
3424         else if tvolfd>0 then pinvolfd=0;
3425         else pinvolfd=.;
3426        if incunifd>0 then pinunifd=incunifd/bunifd*100;
3427         else if tunifd>0 then pinunifd=0;
3428         else pinunifd=.;
3429       if tvalfd>0 then pinvalfd=incvalfd/bvalfd*100;
3430         else pinvalfd=.;
3431        pctstfd=flagfd/tstores*100;
3432       
3433        bvolaf=bvolf+bvolfd;
3434        incvolaf=incvolf+incvolfd;
3435        buniaf=bunif+bunifd;
3436        incuniaf=incunif+incunifd;
3437        bvalaf=bvalf+bvalfd;
3438        incvalaf=incvalf+incvalfd;
3439        tvolaf=bvolaf+incvolaf;                              /*** volume on af *****/
3440        tuniaf=buniaf+incuniaf;                              /*** volume on af *****/
3441        tvalaf=bvalaf+incvalaf;                              /*** volume on af *****/
3442        pctvoaf=tvolaf*100/tvolume;                          /*** % of volume of af *****/
3443        pctuaf=tuniaf*100/tunits;                            /*** % of volume of af *****/
3444        pctvaaf=tvalaf*100/tvalue;                           /*** % of volume of af *****/
3445        if inczerov=0 then pctbafv=tvolaf/tvolume*100;
3446         else pctbafv=bvolaf/tbvol2*100;
3447        if inczerou=0 then pctbafu=tuniaf/tunits*100;
3448         else pctbafu=buniaf/tbuni2*100;
3449        pctbafva=bvalaf/tbval2*100;
3450        if incvolaf>0 then pinvolaf=incvolaf/bvolaf*100;
3451         else if tvolaf>0 then pinvolaf=0;
3452         else pinvolaf=.;
3453        if incuniaf>0 then pinuniaf=incuniaf/buniaf*100;
3454         else if tuniaf>0 then pinuniaf=0;
3455         else pinuniaf=.;
3456        if tvalaf>0 then pinvalaf=incvalaf/bvalaf*100;
3457         else pinvalaf=.;
3458        pctstaf=flagaf/tstores*100;
3459       
3460        tvold=bvold+incvold;                                /*** volume on d *****/
3461        tunid=bunid+incunid;                                /*** volume on d *****/
3462        tvald=bvald+incvald;                                /*** volume on d *****/
3463        pctvod=tvold*100/tvolume;                           /*** % of volume of d *****/
3464        pctud=tunid*100/tunits;                             /*** % of volume of d *****/
3465        pctvad=tvald*100/tvalue;                            /*** % of volume of d *****/
3466        if inczerov=0 then pctbdv=tvold/tvolume*100;
3467         else pctbdv=bvold/tbvol2*100;
3468        if inczerou=0 then pctbdu=tunid/tunits*100;
3469         else pctbdu=bunid/tbuni2*100;
3470        pctbdva=bvald/tbval2*100;
3471        if incvold>0 then pinvold=incvold/bvold*100;
3472         else if tvold>0 then pinvold=0;
3473         else pinvold=.;
3474        if incunid>0 then pinunid=incunid/bunid*100;
3475         else if tunid>0 then pinunid=0;
3476         else pinunid=.;
3477        if tvald>0 then pinvald=incvald/bvald*100;
3478         else pinvald=.;
3479        pctstd=flagd/tstores*100;
3480       
3481        bvolad=bvold+bvolfd;
3482        incvolad=incvold+incvolfd;
3483        buniad=bunid+bunifd;
3484        incuniad=incunid+incunifd;
3485        bvalad=bvald+bvalfd;
3486        incvalad=incvald+incvalfd;
3487        tvolad=bvolad+incvolad;                              /*** volume on ad *****/
3488        tuniad=buniad+incuniad;                              /*** volume on ad *****/
3489        tvalad=bvalad+incvalad;                              /*** volume on ad *****/
3490        pctvoad=tvolad*100/tvolume;                          /*** % of volume of ad *****/
3491        pctuad=tuniad*100/tunits;                            /*** % of volume of ad *****/
3492        pctvaad=tvalad*100/tvalue;                           /*** % of volume of ad *****/
3493        if inczerov=0 then pctbadv=tvolad/tvolume*100;
3494         else pctbadv=bvolad/tbvol2*100;
3495        if inczerou=0 then pctbadu=tuniad/tunits*100;
3496         else pctbadu=buniad/tbuni2*100;
3497        pctbadva=bvalad/tbval2*100;
3498        if incvolad>0 then pinvolad=incvolad/bvolad*100;
3499         else if tvolad>0 then pinvolad=0;
3500         else pinvolad=.;
3501        if incuniad>0 then pinuniad=incuniad/buniad*100;
3502         else if tuniad>0 then pinuniad=0;
3503         else pinuniad=.;
3504        if tvalad>0 then pinvalad=incvalad/bvalad*100;
3505         else pinvalad=.;
3506        pctstad=flagad/tstores*100;
3507       
3508        tvolf=bvolf+incvolf;                                 /*** volume on f *****/
3509        tunif=bunif+incunif;                                 /*** volume on f *****/
3510        tvalf=bvalf+incvalf;                                 /*** volume on f *****/
3511        pctvof=tvolf*100/tvolume;                            /*** % of volume of f *****/
3512        pctuf=tunif*100/tunits;                              /*** % of volume of f *****/
3513        pctvaf=tvalf*100/tvalue;                             /*** % of volume of f *****/
3514        if inczerov=0 then pctbfv=tvolf/tvolume*100;
3515         else pctbfv=bvolf/tbvol2*100;
3516        if inczerou=0 then pctbfu=tunif/tunits*100;
3517         else pctbfu=bunif/tbuni2*100;
3518        pctbfva=bvalf/tbval2*100;
3519        if incvolf>0 then pinvolf=incvolf/bvolf*100;
3520         else if tvolf>0 then pinvolf=0;
3521         else pinvolf=.;
3522        if incunif>0 then pinunif=incunif/bunif*100;
3523         else if tunif>0 then pinunif=0;
3524         else pinunif=.;
3525        if tvalf>0 then pinvalf=incvalf/bvalf*100;
3526         else pinvalf=.;
3527        pctstf=flagf/tstores*100;
3528       
3529        tvolp=bvolp+incvolp;                            /*** volume on p *****/
3530        tunip=bunip+incunip;                            /*** volume on p *****/
3531        tvalp=bvalp+incvalp;                            /*** volume on p *****/
3532        pctvop=tvolp*100/tvolume;                       /*** % of volume of p *****/
3533        pctup=tunip*100/tunits;                         /*** % of volume of p *****/
3534        pctvap=tvalp*100/tvalue;                        /*** % of volume of p *****/
3535        if inczerov=0 then pctbpv=tvolp/tvolume*100;
3536         else pctbpv=bvolp/tbvol2*100;
3537        if inczerou=0 then pctbpu=tunip/tunits*100;
3538         else pctbpu=bunip/tbuni2*100;
3539        pctbpva=bvalp/tbval2*100;
3540        if incvolp>0 then pinvolp=incvolp/bvolp*100;
3541         else if tvolp>0 then pinvolp=0;
3542         else pinvolp=.;
3543        if incunip>0 then pinunip=incunip/bunip*100;
3544         else if tunip>0 then pinunip=0;
3545         else pinunip=.;
3546        if tvalp>0 then pinvalp=incvalp/bvalp*100;
3547         else pinvalp=.;
3548        pctstp=flagp/tstores*100;
3549       
3550       
3551        tvalmer=bvalm+incvalm;      /*** total value on merch ****/
3552        tvolmer=bvolm+incvolm;      /*** total volume on merch ****/
3553        tunimer=bunim+incunim;      /*** total units on merch ****/
3554        pctvmer=tvolmer*100/tvolume;   /*** % of volume on deal *****/
3555       
3556       /***** 20160610 Extra Measures Begin  **************************************/
3557        pctvamer=tvalmer*100/tvalue;   /*** % of value on deal *****/
3558        pctumer=tunimer*100/tunits ;   /*** % of Units on deal *****/
3559       /***** 20160610 Extra Measures End    **************************************/
3560       
3561        if catincv=0 then incvosh=.;
3562        else incvosh=inczerov/catincv*100;   /*** incremental volume share of category any merch ***/
3563        if catincu=0 then incunsh=.;
3564        else incunsh=inczerou/catincu*100;   /*** incremental unit share of category ***/
3565        if catincva=0 then incvash=.;
3566        else incvash=incvalm/catincva*100;   /*** incremental value share of category ***/
3567        pctvinc=inczerov*100/tvolume;   /*** % of total volume that is incremental ***/
3568        pctvainc=incvalm*100/tvalue;   /*** % of total volume that is incremental ***/
3569        basevosh=tbvol2/catbasev*100;  /*** base volume share of category ***/
3570        baseunsh=tbuni2/catbaseu*100;  /*** base unit share of category ***/
3571        basevash=tbval2/catbased*100;  /*** base value share of category ***/
3572        pctvbas=tbvol2*100/tvolume;     /*** % of total volume that is base ****/
3573        pctvabas=tbval2*100/tvalue;     /*** % of total value that is base ****/
3574        pctbmerv=(tvolmer-inczerov)*100/tbvol2;    /*** % of total base volume on deal ***/
3575        pctbmer=(tunimer-inczerou)*100/tbuni2;    /*** % of total base units on deal ***/
3576        pctbmerd=bvalm*100/tbval2;   /*** % of total base value on deal ***/
3577        pctstm=flagm*100/tstores;      /*** % of stores with any merch *****/
3578        wgtavbp=(tpval*&valcon+mkvalm*&valcon)/tunits;  /*** weighted ave base price per unit****/
3579        wgtavbpv=(tpval*&valcon+mkvalm*&valcon)/(tvolume*&volcon/&pricecon);  /*** weighted ave base price per volume****/
3580        if tunimer ne 0 then
3581           prompric=(tvalmer*&valcon)/tunimer;        /*** promoted price -- value on merch/units on merch ***/
3582        if tvolmer ne 0 then
3583           prompriv=(tvalmer*&valcon)/(tvolmer*&volcon/&pricecon); /*** promoted price -- value on merch/units on merch ***/
3584        if tvolmer ne 0 then
3585           NoPrompriU=(tvalue-(tvalmer*&valcon))/(tunits-tunimer); /*** NON promoted price per Unit -- Added by DA ***/
3586       
3587        catunsh=tunits/tstctuni*100;          /*** category volume share ***/
3588        catvosh=tvolume/tstctvol*100;         /*** category volume share ***/
3589        catvash=tvalue/tstctval*100;          /*** category value share ***/
3590        volrate=tvolume/tsqrmtr;              /*** volume sales rate ***/
3591        valrate=tvalue/tsqrmtr;               /*** value sales rate ***/
3592        unirate=tunits/tsqrmtr;               /*** value sales rate ***/
3593        avgpric=tvalue/tunits;                /*** average price ***/
3594        avgpricv=(tvalue/&valcon)/(tvolume/&volcon/&pricecon);  /*** average price per volume ***/
3595        if (tvalmer+mkvalm)=0 then wgtavpr=0; else
3596        wgtavpr=mkvalm/(tvalmer+mkvalm)*100;  /*** weighted average price reduction ***/
3597        pctincv=inczerov*100/tvolume;          /*** % incremental volume ***/
3598        pvalmer=tvalmer*100/tvalue;           /*** % value with any merchandising ***/
3599        punimer=tunimer*100/tunits;           /*** % units with any merchandising ***/
3600        pvolmer=tvolmer*100/tvolume;          /*** % volume with any merchandising ***/
3601        pbvomer=(tvolmer-inczerov)*100/tvolume; /*** % base volume with any merchandising ***/
3602        if bunim=. or bunim=0 then pinunim=.;
3603          else if incunim<0 then pinunim=0;
3604          else pinunim=(incunim)*100/bunim;          /*** % increase in units due to merchandising ***/
3605        if bvolm=. or bvolm=0 then pinvolm=.;
3606          else if incvolm<0 then pinvolm=0;
3607          else pinvolm=(incvolm)*100/bvolm;          /*** % increase in volume due to merchandising ***/
3608        if bvalm=. or bvalm=0 then pinvalm=.; else
3609        pinvalm=(incvalm)*100/bvalm;          /*** % increase in value due to merchandising ***/
3610       /***** NEW MEASURE CALCULATION ****/
3611        numdist=pnums/regfact*100;            /*** numeric distribution -- calculated differently than in old PromoScan***/
3612       
3613        catwgtd=stcatval/tstctval*100;        /*** category weighted distribution ***/
3614       
3615        cwdfd=stcatvfd/tstctval*100;          /*** CWD feature and display ***/
3616        cwdf=stcatvfo/tstctval*100;           /*** CWD feature only ***/
3617        cwdd=stcatvdo/tstctval*100;           /***CWD display only ***/
3618        cwdp=stcatvp/tstctval*100;            /***CWD any price reduction ***/
3619        cwdaf=stcatvaf/tstctval*100;          /***CWD any feature ***/
3620        cwdad=stcatvad/tstctval*100;          /***CWD any display ***/
3621        cwdmr=stcatvmr/tstctval*100;          /***CWD any Merch***/
3622       
3623        /************* 05022018 New Measures ***/
3624         cwdfp=stcatvfp/tstctval*100;          /*** CWD feature and TPR ***/
3625         cwddp=stcatvdp/tstctval*100;          /*** CWD Display and TPR ***/
3626         cwdfdp=stcatvfdp/tstctval*100;        /*** CWD Feature and Display and TPR ***/
3627       
3628         tvolof   =  bvolof   + incvolof  ;    /**** Total Vol   Only  Feature  ***/
3629         tvalof   =  bvalof   + incvalof  ;    /**** Total Val   Only  Feature  ***/
3630         tuniof   =  buniof   + incuniof  ;    /**** Total Units Only  Feature  ***/
3631         tvolod   =  bvolod   + incvolod  ;    /**** Total Vol   Only  Display  ***/
3632         tvalod   =  bvalod   + incvalod  ;    /**** Total Val   Only  Display  ***/
3633         tuniod   =  buniod   + incuniod  ;    /**** Total Units Only  Display  ***/
3634         tvolop   =  bvolop   + incvolop  ;    /**** Total Vol   Only  TPR  ***/
3635         tvalop   =  bvalop   + incvalop  ;    /**** Total Val   Only  TPR  ***/
3636         tuniop   =  buniop   + incuniop  ;    /**** Total Units Only  TPR  ***/
3637         tvolofdp =  bvolofdp + incvolofdp;    /**** Total Vol   Only  Feature and Display and TPR  ***/
3638         tvalofdp =  bvalofdp + incvalofdp;    /**** Total Val   Only  Feature and Display and TPR  ***/
3639         tuniofdp =  buniofdp + incuniofdp;    /**** Total Units Only  Feature and Display and TPR  ***/
3640         tvolofd  =  bvolofd  + incvolofd ;    /**** Total Vol   Only  Feature and Display  ***/
3641         tvalofd  =  bvalofd  + incvalofd ;    /**** Total Val   Only  Feature and Display  ***/
3642         tuniofd  =  buniofd  + incuniofd ;    /**** Total Units Only  Feature and Display  ***/
3643         tvolofp  =  bvolofp  + incvolofp ;    /**** Total Vol   Only  Feature and TPR  ***/
3644         tvalofp  =  bvalofp  + incvalofp ;    /**** Total Val   Only  Feature and TPR  ***/
3645         tuniofp  =  buniofp  + incuniofp ;    /**** Total Units Only  Feature and TPR  ***/
3646         tvolodp  =  bvolodp  + incvolodp ;    /**** Total Vol   Only  Display and TPR  ***/
3647         tvalodp  =  bvalodp  + incvalodp ;    /**** Total Val   Only  Display and TPR  ***/
3648         tuniodp  =  buniodp  + incuniodp ;    /**** Total Units Only  Display and TPR  ***/
3649       /************* 05022018 New Measures ***/
3650       
3651        /*** New Measures ***/
3652       shelfspace=plenfac;                    /*Length of facings*/
3653       avnumsts=pnumean/pnums;                /*Average number of items per store selling*/
3654       shelfshare=(plenfac/regcatlen)*100;    /*Share of shelf-space*/
3655       Avshelf=plenfac/pnumsfac;              /*Average shelf space*/
3656       Avnumitems=pnumfac/pnumsfac;           /*Average number of items on shelf*/
3657       itemshare=(pnumfac/regcatfac)*100;     /*Share of 'brand' items on shelf out of category*/
3658       Shelfindex=(catvash/shelfshare)*100;   /*Shelf space index*/
3659       avshitem=avshelf/avnumsts;             /*Average shelf space per item*/
3660       
3661       run;
3662       
3663       
3664       /*** 20131121 : Performance monitoring ***/
3665       %monitor(_mod_=4);
3666       /*** 20131121 : Performance monitoring ***/
3667       
3668       
3669       %mend setupmeasures_Promoscan;
3670       *%setupmeasures_Promoscan;
3671       *----------------------------------------------------;
3672       
3673       run;
3674       
3675       /*read measure list created by user screen selection*/
3676       
3677       %macro readmeasurelist(measurelist);
3678        %if &service=Combined %then
3679          %do;
3680       
3681            %do hh=1 %to &meascnt;
3682              %let measnum=%scan(&measurelist,&hh);
3683         %if &measnum=001 %then   /*Value Sales*/
3684          %do;
3685           M001=value/&valcon; *change--divide by value conversion factor;
3686          %end;
3687         %if &measnum=002 %then  /*Volume sales*/
3688          %do;
3689           M002=volume/&volcon; *change--divide by volume conversion factor;
3690          %end;
3691         %if &measnum=003 %then /*Unit Sales*/
3692          %do;
3693           M003=sales;
3694          %end;
3695         %if &measnum=004 %then  /*Price per unit*/
3696          %do;
3697           if sales > 0 then M004= (value/sales);else M004=0;  *change--took out times by 1000--4/30/02 DO NOT SCALE;
3698          %end;
3699         %if &measnum=005 %then  /*Price per Volume*/
3700          %do;
3701           if volume > 0 then M005=((value/(volume/&volcon))  /  &pricecon); else M005=0;  *change--divide by pricecon and volcon factor;
3702          %end;
3703         %if &measnum=006 %then
3704          %do;
3705           if regfact > 0 then
3706            do;
3707              M006=100*(volume/pnums);           /*Average Volume per Store*/
3708            end;
3709           else M006=0;
3710          %end;
3711         %if &measnum=007 %then                      /*Numerical distribution*/
3712          %do;
3713           if regfact > 0 then
3714            do;
3715             M007=(pnums/regfact)*100;
3716            M007=round(M007,1);
3717            end;
3718           else M007=0;
3719          %end;
3720         %if &measnum=008 %then                     /*Category weighted distribution*/
3721          %do;
3722           if regvalue > 0 then
3723            do;
3724             M008=(svals/regvalue)*100;
3725             M008=round(M008,1);
3726            end;
3727           else M008=0;
3728          %end;
3729         %if &measnum=009 %then                      /*average Value per store*/
3730          %do;
3731           M009=(value/pnums);
3732          %end;
3733         %if &measnum=010 %then
3734          %do;
3735           M010=pnumean/pnums;                      *average number of items per store selling;
3736          %end;
3737       
3738         %if &measnum=011 %then
3739          %do;
3740           M011=plenfac;                             *shelfspace in meters;
3741          %end;
3742       
3743         %if &measnum=012 %then
3744          %do;
3745           M012=(plenfac/regcatlen)*100;             *shelfshare;
3746          %end;
3747       
3748         %if &measnum=013 %then
3749          %do;
3750           M013=plenfac/pnumsfac;                    *average shelf space in meters;
3751          %end;
3752       
3753         %if &measnum=014 %then
3754          %do;
3755           M014=pnumfac/pnumsfac;                    *average number of items on shelf;
3756          %end;
3757       
3758         %if &measnum=015 %then
3759          %do;
3760           M015=(pnumfac/regcatfac)*100;      *share of items on shelf;
3761          %end;
3762       
3763         %if &measnum=016 %then
3764          %do;
3765           catvash=(value/regvalue)*100;             *category value share;
3766           M016=(catvash/M012)*100;                    *Shelf space index;
3767          %end;
3768       
3769         %if &measnum=017 %then
3770          %do;
3771           M017=M013/M010;                              *Average shelf space per item;
3772          %end;
3773       
3774         %if &measnum=018 %then
3775          %do;
3776           M018=M006/M017;                              *Average Volume per meters;
3777          %end;
3778         %if &measnum=019 %then
3779          %do;
3780             avalstore=100*(value/pnums);
3781           M019=avalstore/M017;                         *Average Value per meters;
3782          %end;
3783       
3784       
3785         %if &measnum=020 %then  /*Numeric Distribution, Out of Stock In%*/
3786          %do;                   /*Added by Souzas on 15/10/2003*/
3787           if regfact > 0 then
3788            do;
3789             M020=(numos/regfact)*100;
3790             M020=round(M020,1);
3791            end;
3792           else M020=0;
3793          %end;
3794       
3795       
3796         %if &measnum=021 %then   /*Category Weighted Distribution, Out of Stock In%*/
3797          %do;                    /*Added by Souzas on 15/10/2003*/
3798           if regvalue > 0 then
3799            do;
3800             M021=(svalos/regvalue)*100;
3801             M021=round(M021,1);
3802            end;
3803           else M021=0;
3804          %end;
3805       
3806       
3807         %if &measnum=022 %then               /* Handling Numerical Distribution ,Added by Souzas on 06/07/2005*/
3808          %do;
3809           if regfact > 0 then
3810            do;
3811             M022=(numh/regfact)*100;
3812             M022=round(M022,1);
3813            end;
3814           else M022=0;
3815          %end;
3816       
3817       
3818         %if &measnum=023 %then               /* Handling CWD ,Added by Souzas on 06/07/2005*/
3819          %do;
3820           if regvalue > 0 then
3821            do;
3822             M023=(svalh/regvalue)*100;
3823             M023=round(M023,1);
3824            end;
3825           else M023=0;
3826          %end;
3827       
3828       
3829       
3830         %if &measnum=024 %then             /* Number of faces ,Added by Souzas on 21/09/2005*/
3831          %do;
3832           M024= pnumfac;
3833          %end;
3834       
3835       
3836        %end;
3837       
3838       %end;
3839       
3840       
3841       
3842       %else %if &service=Infoscan %then
3843          %do;
3844       
3845       /*** 20160610 : Extra Measures Begin ************************************************************************/
3846       /***            calculated before because measures are necessary for calculation but may not be requested ***/
3847               M001_tmp = value*&valcon/valcon;
3848               M002_tmp = (volume*&volcon)/volcon;
3849               M003_tmp = units;
3850               if volume > 0 then M005_tmp=(value/(volume*&volcon/volcon) / pricecon); else M005_tmp=0;
3851               M001 = M001_tmp; /*** 20160610 : measure always calculated (necessary for geog-file), if not requested it is excluded when writing measure-file ***/
3852               M002 = M002_tmp; /*** 20160610 : measure always calculated (necessary for geog-file), if not requested it is excluded when writing measure-file ***/
3853       /*** 20160610 : Extra Measures Begin ************************************************************************/
3854       
3855            %do hh=1 %to &meascnt;
3856              %let measnum=%scan(&measurelist,&hh);
3857         %if &measnum=001 %then   /*Value Sales*/
3858          %do;
3859         /*M001=value/&valcon; *change--divide by value conversion factor;*/
3860         /*** 20130906 : New conversion-file at subcategory-level - variables are stored in dataset       ***/
3861         /*** VALUE is already corrected by &VALCON, this correction must be eliminated by multiplication ***/
3862         /*** if no factor at subcategory-level defined then VALCON = &VALCON and M001=VALUE              ***/
3863         /*M001=value;*/
3864           M001=value*&valcon/valcon;
3865          %end;
3866         %if &measnum=002 %then  /*Volume sales*/
3867          %do;
3868         /*M002=volume/&volcon; */  /* Commented by SOUZAS on 1904 */
3869         /*** 20130906 : New conversion-file at subcategory-level - variables are stored in dataset        ***/
3870         /*** VOLUME is already corrected by &VOLCON, this correction must be eliminated by multiplication ***/
3871         /*** if no factor at subcategory-level defined then VOLCON = &VOLCON and M002=VOLUME              ***/
3872         /*M002=volume;*/
3873           M002=(volume*&volcon)/volcon;
3874          %end;
3875         %if &measnum=003 %then /*Unit Sales*/
3876          %do;
3877           M003=units;
3878          %end;
3879         %if &measnum=004 %then  /*Price per unit*/
3880          %do;
3881           if units > 0 then M004= (value/units);else M004=0;  *change--took out times by 1000--4/30/02 DO NOT SCALE;
3882          %end;
3883         %if &measnum=005 %then  /*Price per Volume*/
3884          %do;
3885         /*  if volume > 0 then M005=((value/(volume/&volcon)) / &pricecon); else M005=0; */  /* Commented by SOUZAS on 1904 */
3886         /*** 20130906 : New conversion-file at subcategory-level - variables are stored in dataset        ***/
3887         /*** VOLUME is already corrected by &VOLCON, this correction must be eliminated by multiplication ***/
3888         /*** if no factor at subcategory-level defined then VOLCON = &VOLCON and M002=VOLUME              ***/
3889         /*if volume > 0 then M005=((value/(volume)) / &pricecon); else M005=0; *change--divide by pricecon and volcon factor;*/
3890           if volume > 0 then M005=(value/(volume*&volcon/volcon) / pricecon); else M005=0;
3891          %end;
3892         %if &measnum=006 %then
3893          %do;
3894           if regfact > 0 then
3895            do;
3896             /*M006=100*(volume/pnums);*/              /*Average Volume per Store*/
3897             &Prod_FormularInfoscanM006;
3898            end;
3899           else M006=0;
3900          %end;
3901       
3902         %if &measnum=007 %then
3903          %do;
3904           if regfact > 0 then
3905            do;
3906             M007=(nums/regfact)*100;          /*Numerical distribution*/
3907            M007=round(M007,1);
3908            end;
3909           else M007=0;
3910          %end;
3911         %if &measnum=008 %then                /*Category weighted distribution*/
3912          %do;
3913           if regvalue > 0 then
3914            do;
3915             M008=(svals/regvalue)*100;
3916             M008=round(M008,1);
3917            end;
3918           else M008=0;
3919          %end;
3920         %if &measnum=009 %then                      /*average Value per store*/
3921          %do;
3922           M009=(value/pnums);
3923          %end;
3924         %if &measnum=010 %then
3925          %do;
3926           M010=pnumean/pnums; *average number of items per store selling;
3927          %end;
3928       
3929         %if &measnum=011 %then
3930          %do;
3931           M011=plenfac; *shelfspace in meters;
3932          %end;
3933       
3934         %if &measnum=012 %then
3935          %do;
3936           M012=(plenfac/regcatlen)*100; *shelfshare;
3937          %end;
3938       
3939         %if &measnum=013 %then
3940          %do;
3941           M013=plenfac/pnumsfac; *average shelf space in meters;
3942          %end;
3943       
3944         %if &measnum=014 %then
3945          %do;
3946           M014=pnumfac/pnumsfac; *average number of items on shelf;
3947          %end;
3948       
3949         %if &measnum=015 %then
3950          %do;
3951           M015=(pnumfac/regcatfac)*100;  *share of items on shelf;
3952          %end;
3953       
3954        %if &measnum=016 %then
3955          %do;
3956           catvash=(value/regvalue)*100;  *category value share;
3957           M016=(catvash/M012)*100; *Shelf space index;
3958          %end;
3959       
3960         %if &measnum=017 %then
3961          %do;
3962           M017=M013/M010; *Average shelf space per item;
3963          %end;
3964         %if &measnum=018 %then
3965          %do;
3966           M018=M006/M017;                              *Average Volume per meters;
3967          %end;
3968         %if &measnum=019 %then
3969          %do;
3970             avalstore=100*(value/pnums);
3971           M019=avalstore/M017;                         *Average Value per meters;
3972          %end;
3973       
3974         %if &measnum=208 %then
3975          %do;
3976           M208=((volume-inczerov)*100)/volume; /* Volume Base */          /*ADDED BY SOUZAS on 1904 */
3977          %end;
3978       
3979         %if &measnum=209 %then
3980          %do;
3981           M209=((value-incvalm)*100)/value;    /* Value Base */           /*  ADDED BY A.A. on 2015/01/12 */
3982          %end;
3983       
3984         %if &measnum=210 %then
3985          %do;
3986           M210=inczerov*100/volume;  /* incremental volume */            /*ADDED BY SOUZAS on 1904 */
3987          %end;
3988       
3989         %if &measnum=211 %then
3990          %do;
3991           M211=incvalm*100/value;  /* incremental value */             /*  ADDED BY A.A. on 2015/01/12 */
3992          %end;
3993       
3994         %if &measnum=212 %then
3995          %do;
3996           M212=((bvolm+incvolm)*100)/volume;  /* of volume any merch */  /* Added by SOUZAS on 1904 ADDED BY A.A. on 18/02/2005 */
3997          %end;
3998       
3999       
4000          /* START INSERT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
4001       
4002          %if &measnum=204 %then
4003          %do;
4004           M204=(stcatvp / tstctval)*100; /*CWD any price reduction */
4005          %end;
4006       
4007         %if &measnum=205 %then
4008          %do;
4009           M205=(stcatvaf / tstctval)*100; /*CWD any feature */
4010          %end;
4011       
4012         %if &measnum=206 %then
4013          %do;
4014           M206=(stcatvad / tstctval)*100; /*CWD any display */
4015          %end;
4016       
4017         %if &measnum=207 %then
4018          %do;
4019           M207=(stcatvmr / tstctval)*100; /*CWD any Merch*/
4020          %end;
4021       
4022         %if &measnum=241 %then
4023          %do;
4024           M241=(value*&valcon+mkvalm*&valcon)/units;  /* weighted avg base price per unit */ /*  ADDED BY A.A. on 2015/01/12 */
4025          %end;
4026       
4027         %if &measnum=243 %then
4028          %do;
4029           M243=((bvalm+incvalm)*100)/value;  /* of value any merch w/o Special Pack */  /*  ADDED BY A.A. on 2015/01/12 */
4030          %end;
4031       
4032          /* END INSERT BY SOUZAS ON 26/09/2005, FOR NEW PROMO MEAS IN INFO FOR COCA COLA */
4033       
4034       /***** 20160610 Extra Measures Begin  **************************************/
4035       
4036          %if &measnum=254 %then                       /* %Share in Value         */
4037          %do;
4038           M254=(M001_tmp/total_M001)*100;
4039          %end;
4040       
4041          %if &measnum=255 %then                       /* %Share in Volume        */
4042          %do;
4043           M255=(M002_tmp/total_M002)*100;
4044          %end;
4045       
4046          %if &measnum=256 %then                       /* %Share in Units         */
4047          %do;
4048           M256=(M003_tmp/total_M003)*100;
4049          %end;
4050       
4051          %if &measnum=257 %then                       /* Price index             */
4052          %do;
4053           M257=(M005_tmp/total_M005)*100;
4054          %end;
4055       /***** 20160610 Extra Measures End    **************************************/
4056       
4057       
4058             /*** 20130906 : Add new measure M260/M261 ***/
4059             %if &measnum=260 %then %do; /* Value sold under ANY Price Reduction */
4060                /*** all values used for calculating VALP are already corrected by the global factor &VALCON ***/
4061                /*** the factor at subcategory-level needs to be applied only after having corrected it      ***/
4062                M260=valp*&valcon/valcon;
4063             %end;
4064             %if &measnum=261 %then %do; /* Increase in Value due to ANY price reduction only */
4065                /*** the values BVALP and INCVALP are already corrected by the global factor &VALCON ***/
4066                /*** this correction is eliminated by the multiplication                             ***/
4067                tvalp=(bvalp+incvalp)*&valcon;
4068                if tvalp>0 then pinvalp=incvalp/valcon; else pinvalp=.;
4069                M261=pinvalp;
4070             %end;
4071             /*** 20130906 : Add new measure M260/M261 ***/
4072       
4073       
4074          %if &measnum=262 %then
4075          %do;
4076           M262=((valamspack)*100)/value;  /* % value any merch + Special Pack */  /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
4077          %end;
4078       
4079            %if &measnum=263 %then
4080          %do;
4081           M263=((volamspack)*100)/volume;  /* %volume any merch + Special Pack */  /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
4082          %end;
4083       
4084        %end;
4085       
4086        %end;
4087       
4088       
4089       
4090       %else %if &service=Promoscan %then
4091          %do;
4092       
4093       /*** 20160610 : Extra Measures Begin ************************************************************************/
4094       /***            calculated before because measures are necessary for calculation but may not be requested ***/
4095       
4096               M001_tmp = tvalue;
4097               M002_tmp = tvolume;
4098               M003_tmp = tunits;
4099               if tvolume > 0 then M005_tmp=(((tvalue/&valcon)/(tvolume))/&pricecon); else M005_tmp=0;
4100               M001=M001_tmp; /*** 20160610 : measure always calculated (necessary for geog-file), if not requested it is excluded when writing measure-file ***/
4101               M002=M002_tmp; /*** 20160610 : measure always calculated (necessary for geog-file), if not requested it is excluded when writing measure-file ***/
4102       /*** 20160610 : Extra Measures Begin ************************************************************************/
4103       
4104            %do hh=1 %to &meascnt;
4105              %let measnum=%scan(&measurelist,&hh);
4106         %if &measnum=001 %then   /*Value Sales*/
4107          %do;
4108           M001=tvalue;            /*change -- took out VALCON*/
4109          %end;
4110         %if &measnum=002 %then  /*Volume sales*/
4111          %do;
4112           M002=tvolume;          /*change -- took out VOLCON*/
4113          %end;
4114         %if &measnum=003 %then
4115          %do;
4116           M003=tunits; /*Unit sales*/
4117          %end;
4118         %if &measnum=004 %then  /*Price per unit*/
4119          %do;
4120           if tunits > 0 then M004= (tvalue/tunits);else M004=0;
4121          %end;
4122         %if &measnum=005 %then  /*Price per Volume*/
4123          %do;
4124           if tvolume > 0 then M005=(((tvalue/&valcon)/(tvolume))/&pricecon); else M005=0;   /*change -- took out VOLCON*/
4125          %end;
4126         %if &measnum=006 %then
4127          %do;
4128           if regfact > 0 then
4129            do;
4130             M006=100*(tvolume/pnums);
4131            end;
4132           else M006=0;
4133          %end;
4134       
4135         %if &measnum=007 %then
4136          %do;
4137           if regfact > 0 then
4138            do;
4139             M007=(pnums/regfact)*100;          /*Numerical distribution*/
4140            M007=round(M007,1);
4141            end;
4142           else M007=0;
4143          %end;
4144         %if &measnum=008 %then                /*Category weighted distribution*/
4145          %do;
4146           if regvalue > 0 then
4147            do;
4148             M008=(stcatval/tstctval)*100;
4149             M008=round(M008,1);
4150            end;
4151           else M008=0;
4152          %end;
4153         %if &measnum=009 %then                      /*average Value per store*/
4154          %do;
4155           M009=(tvalue/pnums);
4156          %end;
4157       
4158         %if &measnum=010 %then
4159          %do;
4160           M010=pnumean/pnums; *average number of items per store selling;
4161          %end;
4162       
4163         %if &measnum=011 %then
4164          %do;
4165           M011=plenfac; *shelfspace in meters;
4166          %end;
4167       
4168         %if &measnum=012 %then
4169          %do;
4170           M012=(plenfac/regcatlen)*100; *shelfshare;
4171          %end;
4172         %if &measnum=013 %then
4173          %do;
4174           M013=plenfac/pnumsfac; *average shelf space in meters;
4175          %end;
4176       
4177         %if &measnum=014 %then
4178          %do;
4179           M014=pnumfac/pnumsfac;      *average number of items on shelf;
4180          %end;
4181       
4182         %if &measnum=015 %then
4183          %do;
4184           M015=(pnumfac/regcatfac)*100;   *share of items on shelf;
4185          %end;
4186       
4187        %if &measnum=016 %then
4188          %do;
4189           M016=(catvash/shelfshare)*100;               *Shelf space index;
4190          %end;
4191       
4192         %if &measnum=017 %then
4193          %do;
4194           M017=M013/M010;                              *Average shelf space per item;
4195          %end;
4196         %if &measnum=018 %then
4197          %do;
4198           M018=M006/M017;                              *Average Volume per meters;
4199          %end;
4200         %if &measnum=019 %then
4201          %do;
4202             avalstore=100*(tvalue/pnums);
4203           M019=avalstore/M017;                         *Average Value per meters;
4204          %end;
4205       
4206       /*The following measures are unique to the PromoScan Deliverable*/
4207         %if &measnum=201 %then
4208          %do;
4209           M201=cwdfd; /* CWD feature and display */
4210          %end;
4211         %if &measnum=202 %then
4212          %do;
4213           M202=cwdf; /* CWD feature only */
4214          %end;
4215         %if &measnum=203 %then
4216          %do;
4217           M203=cwdd; /*CWD display only */
4218          %end;
4219         %if &measnum=204 %then
4220          %do;
4221           M204=cwdp; /*CWD any price reduction */
4222          %end;
4223         %if &measnum=205 %then
4224          %do;
4225           M205=cwdaf; /*CWD any feature */
4226          %end;
4227         %if &measnum=206 %then
4228          %do;
4229           M206=cwdad; /*CWD any display */
4230          %end;
4231         %if &measnum=207 %then
4232          %do;
4233           M207=cwdmr; /*CWD any Merch*/
4234          %end;
4235         %if &measnum=208 %then
4236          %do;
4237           M208=pctvbas; /* Volume Base */
4238          %end;
4239         %if &measnum=209 %then
4240          %do;
4241           M209=pctvabas; /* Value Base */
4242          %end;
4243         %if &measnum=210 %then
4244          %do;
4245           M210=pctvinc; /* incremental volume */
4246          %end;
4247         %if &measnum=211 %then
4248          %do;
4249           M211=pctvainc; /* incremental value */
4250          %end;
4251         %if &measnum=212 %then
4252          %do;
4253           M212=pctvmer; /* of volume any merch */
4254          %end;
4255         %if &measnum=213 %then
4256          %do;
4257           M213=pctbmerv; /* of total base volume any merch */
4258          %end;
4259         %if &measnum=214 %then
4260          %do;
4261           M214=pctbmer; /* of total base Units any merch */
4262          %end;
4263         %if &measnum=215 %then
4264          %do;
4265           M215=pctbmerd; /* changed by souzas to 215, the same applies for the other measures, of total base Value any merch */
4266          %end;
4267         %if &measnum=216 %then
4268          %do;
4269           M216=incvosh; /* incremental volume share of category any merch */
4270          %end;
4271         %if &measnum=217 %then
4272          %do;
4273           M217=incunsh; /* incremental unit share of category any merch */
4274          %end;
4275         %if &measnum=218 %then
4276          %do;
4277           M218=incvash; /* incremental value share of category any merch */
4278          %end;
4279         %if &measnum=219 %then
4280          %do;
4281           M219=pinunim; /* increase in units due to merchandising */
4282          %end;
4283         %if &measnum=220 %then
4284          %do;
4285           M220=pinvolm; /* increase in Volume due to merchandising */
4286          %end;
4287         %if &measnum=221 %then
4288          %do;
4289           M221=pinvalm; /* increase in Value due to merchandising */
4290          %end;
4291         %if &measnum=222 %then
4292          %do;
4293           M222=pinvolaf; /* increase in Volume due to any feat */
4294          %end;
4295         %if &measnum=223 %then
4296          %do;
4297           M223=pinvalaf; /* increase in Value due to any feat */
4298          %end;
4299         %if &measnum=224 %then
4300          %do;
4301           M224=pinvolad; /* increase in Volume due to any Display */
4302          %end;
4303         %if &measnum=225 %then
4304          %do;
4305           M225=pinvalad; /* increase in Value due to any Display */
4306          %end;
4307         %if &measnum=226 %then
4308          %do;
4309           M226=pinvolp; /* increase in Volume due to Price reduction only */
4310          %end;
4311         %if &measnum=227 %then
4312          %do;
4313           M227=pinvalp; /* increase in Value due to any Price reduction only */
4314          %end;
4315         %if &measnum=228 %then
4316          %do;
4317           M228=pinvolf; /* increase in Volume due to feature only */
4318          %end;
4319         %if &measnum=229 %then
4320          %do;
4321           M229=pinvalf; /* increase in Value due to feature only */
4322          %end;
4323         %if &measnum=230 %then
4324          %do;
4325           M230=pinvold; /* increase in Volume due to display only */
4326          %end;
4327         %if &measnum=231 %then
4328          %do;
4329           M231=pinvald; /* increase in Value due to display only */
4330          %end;
4331         %if &measnum=232 %then
4332          %do;
4333           M232=pinvolfd; /* increase in Volume due to feature and display */
4334          %end;
4335         %if &measnum=233 %then
4336          %do;
4337           M233=pinvalfd; /* increase in Value due to feature and display */
4338          %end;
4339         %if &measnum=234 %then
4340          %do;
4341           M234=pctstm; /* stores any merch */
4342          %end;
4343         %if &measnum=235 %then
4344          %do;
4345           M235=pctstaf; /* stores any feat */
4346          %end;
4347         %if &measnum=236 %then
4348          %do;
4349           M236=pctstad; /* stores any display */
4350          %end;
4351         %if &measnum=237 %then
4352          %do;
4353           M237=pctstf; /* stores feat only */
4354          %end;
4355         %if &measnum=238 %then
4356          %do;
4357           M238=pctstd; /* stores display only */
4358          %end;
4359         %if &measnum=239 %then
4360          %do;
4361           M239=pctstp; /* stores price reduction only */
4362          %end;
4363         %if &measnum=240 %then
4364          %do;
4365           M240=pctstfd; /* stores feature and display */
4366          %end;
4367       
4368         %if &measnum=241 %then
4369          %do;
4370           M241=wgtavbp; /* weighted average base price */
4371          %end;
4372         %if &measnum=242 %then
4373          %do;
4374           M242=prompric; /* promoted average price per unit */
4375          %end;
4376         %if &measnum=243 %then
4377          %do;
4378           M243=pvalmer;  /* of value any merch */  /* ADDED BY A.A. on 2015/01/12 for consistency with Infoscan Service*/
4379          %end;
4380         %if &measnum=244 %then
4381          %do;
4382           M244=NoPrompriU; /* Non promoted average price per unit */
4383          %end;
4384       
4385       
4386          /*** 20120709 : R. Walter : New Measure for Red Bull : SALES / (CWD * STORES-SELLING-THE CATEGORY * NR-STORES-IN-GEO) ***/
4387             /*** 20150218 : A. AGOSTINELLI : consolidation of engines ***/
4388             %if &newmeasure_rb=Y %then %do;
4389                 denominator = (stcatval/tstctval) * (dn_category) * (storecount);
4390                 %if &measnum=245 %then %do; /*** category weight rate of value  sales per store selling ***/
4391                    if denominator > 0 then do; M245 = round(M001 / denominator,.01); end;
4392                    else                    do; M245 = 0;                             end;
4393                 %end;
4394                 %if &measnum=246 %then %do; /*** category weight rate of volume sales per store selling ***/
4395                   if denominator > 0 then do; M246 = round(M002 / denominator,.01); end;
4396                   else                    do; M246 = 0;                             end;
4397                 %end;
4398                 %if &measnum=247 %then %do; /*** category weight rate of unit   sales per store selling ***/
4399                    if denominator > 0 then do; M247 = round(M003 / denominator,.01); end;
4400                    else                    do; M247 = 0;                             end;
4401                 %end;
4402             %end;
4403             /*** 20150218 : A. AGOSTINELLI : consolidation of engines ***/
4404          /*** 20120709 : R. Walter : New Measure for Red Bull : SALES / (CWD * STORES-SELLING-THE CATEGORY * NR-STORES-IN-GEO) ***/
4405       
4406          /*** 20120926 : R. Walter : New Measure for BAT ***/
4407          %if &newmeasure_bat=Y %then %do;
4408             %if &measnum=248 %then %do; /* Numeric           Distribution, Out of Stock   */
4409                if regfact > 0  then M248 = round((num_oos      / regfact) * 100,1);
4410                else                 M248 = 0;
4411             %end;
4412             %if &measnum=249 %then %do; /* Category Weighted Distribution, Out of Stock   */
4413                if tstctval > 0 then M249 = round((cwd_oos      / tstctval) * 100,1);
4414                else                 M249 = 0;
4415             %end;
4416             %if &measnum=250 %then %do; /* Numeric           Distribution, Handling Shops */
4417                if regfact > 0  then M250 = round((num_handling / regfact) * 100,1);
4418                else                 M250 = 0;
4419             %end;
4420             %if &measnum=251 %then %do; /* Category Weighted Distribution, Handling Shops */
4421                if tstctval > 0 then M251 = round((cwd_handling / tstctval) * 100,1);
4422                else                 M251 = 0;
4423             %end;
4424             %if &measnum=252 %then %do; /* Numeric           Distribution, No Stock       */
4425                if regfact > 0  then M252 = round(100-(M248+M250),1);
4426                else                 M252 = 0;
4427             %end;
4428             %if &measnum=253 %then %do; /* Category Weighted Distribution, No Stock       */
4429                if tstctval > 0 then M253 = round(100-(M249+M251),1);
4430                else                 M253 = 0;
4431             %end;
4432          %end;
4433          /*** 20120926 : R. Walter : New Measure for BAT ***/
4434       
4435       /***** 20160610 Extra Measures Begin  **************************************/
4436       
4437          %if &measnum=254 %then                       /* %Share in Value         */
4438          %do;
4439           M254=(M001_tmp/total_M001)*100;
4440          %end;
4441       
4442          %if &measnum=255 %then                       /* %Share in Volume        */
4443          %do;
4444           M255=(M002_tmp/total_M002)*100;
4445          %end;
4446       
4447          %if &measnum=256 %then                       /* %Share in Units         */
4448          %do;
4449           M256=(M003_tmp/total_M003)*100;
4450          %end;
4451       
4452          %if &measnum=257 %then                       /* Price index             */
4453          %do;
4454           M257=(M005_tmp/total_M005)*100;
4455          %end;
4456       /***** 20160610 Extra Measures End    **************************************/
4457       
4458       
4459       
4460          %if &measnum=262 %then
4461          %do;
4462           M262=((valamspack)*100)/tvalue;  /* % value any merch + Special Pack */  /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
4463          %end;
4464       
4465          %if &measnum=263 %then
4466          %do;
4467           M263=((volamspack)*100)/tvolume;  /* %volume any merch + Special Pack */  /*** 20150219 : A. AGOSTINELLI : Special Pack cases ***/
4468          %end;
4469       
4470       
4471       /***** 20160610 Extra Measures Begin  **************************************/
4472       
4473          %if &measnum=266 %then
4474          %do;
4475           M266=tbvol2; /* Volume Base */
4476          %end;
4477       
4478          %if &measnum=267 %then
4479          %do;
4480           M267=tbval2;  /* Value Base */
4481          %end;
4482       
4483          %if &measnum=268 %then
4484          %do;
4485           M268=inczerov;  /* Incremental Volume */
4486          %end;
4487       
4488          %if &measnum=269 %then
4489          %do;
4490           M269=incvalm;  /* Incremental Value */
4491          %end;
4492       
4493          %if &measnum=270 %then
4494          %do;
4495           M270=tvolmer;  /* Volume Any Merchandising */
4496          %end;
4497       
4498          %if &measnum=271 %then
4499          %do;
4500           M271=pctvamer;  /* %Of Value any Merchandising */
4501          %end;
4502       
4503          %if &measnum=272 %then
4504          %do;
4505           M272=pctumer;  /* %Of Units any Merchandising */
4506          %end;
4507       
4508          %if &measnum=273 %then
4509          %do;
4510           M273=tvalmer;  /* Value any Merchandising */
4511          %end;
4512       
4513          %if &measnum=274 %then
4514          %do;
4515           M274=tunimer;  /* Units any Merchandising */
4516          %end;
4517       
4518       
4519       /************* 05022018 New Measures ***/
4520          %if &measnum=275 %then
4521          %do;
4522           M275=cwdfp;       /*** CWD feature and TPR ***/
4523          %end;
4524       
4525          %if &measnum=276 %then
4526          %do;
4527           M276=cwddp;       /*** CWD Display and TPR ***/
4528          %end;
4529       
4530          %if &measnum=277 %then
4531          %do;
4532           M277=cwdfdp;      /*** CWD Feature and Display and TPR ***/
4533          %end;
4534       
4535          %if &measnum=278 %then
4536          %do;
4537           M278=tvolof  ;    /**** Total Vol   Only  Feature  ***/
4538          %end;
4539       
4540          %if &measnum=279 %then
4541          %do;
4542           M279=tvalof  ;    /**** Total Val   Only  Feature  ***/
4543          %end;
4544       
4545          %if &measnum=280 %then
4546          %do;
4547           M280=tuniof  ;    /**** Total Units Only  Feature  ***/
4548          %end;
4549       
4550          %if &measnum=281 %then
4551          %do;
4552           M281=tvolod  ;    /**** Total Vol   Only  Display  ***/
4553          %end;
4554       
4555          %if &measnum=282 %then
4556          %do;
4557           M282=tvalod  ;    /**** Total Val   Only  Display  ***/
4558          %end;
4559       
4560          %if &measnum=283 %then
4561          %do;
4562           M283=tuniod  ;    /**** Total Units Only  Display  ***/
4563          %end;
4564       
4565          %if &measnum=284 %then
4566          %do;
4567           M284=tvolop  ;    /**** Total Vol   Only  TPR  ***/
4568          %end;
4569       
4570          %if &measnum=285 %then
4571          %do;
4572           M285=tvalop  ;    /**** Total Val   Only  TPR  ***/
4573          %end;
4574       
4575          %if &measnum=286 %then
4576          %do;
4577           M286=tuniop  ;    /**** Total Units Only  TPR  ***/
4578          %end;
4579       
4580          %if &measnum=287 %then
4581          %do;
4582           M287=tvolofdp;    /**** Total Vol   Only  Feature and Display and TPR  ***/
4583          %end;
4584       
4585          %if &measnum=288 %then
4586          %do;
4587           M288=tvalofdp;    /**** Total Val   Only  Feature and Display and TPR  ***/
4588          %end;
4589       
4590          %if &measnum=289 %then
4591          %do;
4592           M289=tuniofdp;    /**** Total Units Only  Feature and Display and TPR  ***/
4593          %end;
4594       
4595          %if &measnum=290 %then
4596          %do;
4597           M290=tvolofd ;    /**** Total Vol   Only  Feature and Display  ***/
4598          %end;
4599       
4600          %if &measnum=291 %then
4601          %do;
4602           M291=tvalofd ;    /**** Total Val   Only  Feature and Display  ***/
4603          %end;
4604       
4605          %if &measnum=292 %then
4606          %do;
4607           M292=tuniofd ;    /**** Total Units Only  Feature and Display  ***/
4608          %end;
4609       
4610          %if &measnum=293 %then
4611          %do;
4612           M293=tvolofp ;    /**** Total Vol   Only  Feature and TPR  ***/
4613          %end;
4614       
4615          %if &measnum=294 %then
4616          %do;
4617           M294=tvalofp ;    /**** Total Val   Only  Feature and TPR  ***/
4618          %end;
4619       
4620          %if &measnum=295 %then
4621          %do;
4622           M295=tuniofp ;    /**** Total Units Only  Feature and TPR  ***/
4623          %end;
4624       
4625          %if &measnum=296 %then
4626          %do;
4627           M296=tvolodp ;    /**** Total Vol   Only  Display and TPR  ***/
4628          %end;
4629       
4630          %if &measnum=297 %then
4631          %do;
4632           M297=tvalodp ;    /**** Total Val   Only  Display and TPR  ***/
4633          %end;
4634       
4635          %if &measnum=298 %then
4636          %do;
4637           M298=tuniodp ;    /**** Total Units Only  Display and TPR  ***/
4638          %end;
4639       
4640       /***** 20160610 Extra Measures End    **************************************/
4641       
4642       %end;
4643       
4644       %end;
4645       
4646       %mend readmeasurelist;
4647       
4648       
4649       
4650       /*Based on measlist selected through screens calculate measures selected*/
4651       %macro createmeasures;
4652       
4653        /*** 20150218 : A. AGOSTINELLI : consolidation of engines ***/
4654        %if &newmeasure_rb=Y %then %do;
4655           /*** 20120709 : R. Walter : New Measure for Red Bull ***/
4656           proc sort    data=alltot;                    by g1 s1 week;                                                    run;
4657           proc sort    data=numerical;                 by g1 s1 week;                                                    run;
4658           data alltot; merge alltot(in=a1) numerical;  by g1 s1 week; if a1;                                             run;
4659           proc sort    data=alltot;                    by g1 s1 week lev1-lev8 ean;                                      run;
4660           data alltot; retain dn_category; set alltot; by g1 s1 week lev1; if first.lev1 then dn_category=pnums/regfact; run;
4661           /*** 20120709 : R. Walter : New Measure for Red Bull ***/
4662        %end;
4663        /*** 20150218 : A. AGOSTINELLI : consolidation of engines ***/
4664       
4665          /*** 20120926 : R. Walter : Add stock-information (only for BAT) ***/
4666          %if &service=Promoscan %then %do;
4667             %if &newmeasure_bat=Y %then %do;
4668                proc sort data=stock_measure_sum nodupkey;                 by g1 s1 week lineitem;        run;
4669                proc sort data=alltot;                                     by g1 s1 week lineitem;        run;
4670                data alltot; merge alltot(in=a1) stock_measure_sum(in=a2); by g1 s1 week lineitem; if a1; run;
4671             %end;
4672          %end;
4673          /*** 20120926 : R. Walter : Add stock-information (only for BAT) ***/
4674       
4675       
4676       /*** 20130906 : New conversion-file at subcategory-level ***/
4677       data alltot; set alltot; lev1=scan(lineitem,1)*1; lev2=scan(lineitem,2)*1; run;
4678       proc sort data=alltot; by lev1 lev2; run;
4679       data alltot(drop=lev1 lev2);
4680          merge alltot(in=a1) subkeycats(in=a2 drop=levname);
4681          by lev1 lev2;
4682          if a1 then do;
4683             if not a2 then do;
4684                volcon=&volcon; valcon=&valcon; pricecon=&pricecon; adcon=&adcon;
4685             end;
4686             output;
4687          end;
4688       run;
4689       
4690       /***** 20160610 Extra Measures Begin  ***************************************/
4691       %if &service=Combined %then %do;
4692       	proc sort data=alltot; by g1 s1 week lineitem; run;
4693       
4694       	data alltot;
4695       	set alltot;
4696       	%readmeasurelist(&measurelist);
4697       	run;
4698       %end;
4699       %else
4700       %do;
4701       	data alltot;
4702       	set alltot;
4703       	length plev1 $17;
4704       	plev1 = scan(lineitem,1);
4705       	lev1 = plev1 * 1;
4706       	drop plev1;
4707       	run;
4708       
4709       	proc sort data=alltot;
4710       	by g1 s1 week lev1 lineitem ean;
4711       	run;
4712       
4713       	data alltot(drop=%do rwrii=2 %to &plevel; lev&rwrii %end;);
4714       	retain nr_level_cat 0;
4715       	set alltot;
4716       	   %do rwrii=2 %to &plevel;
4717       		  length plev&rwrii $17;
4718       		  plev&rwrii = scan(lineitem,&rwrii);
4719       		  lev&rwrii  = plev&rwrii * 1;
4720       		  drop plev&rwrii;
4721       	   %end;
4722       	   if lev1 < 100 and ean="00000000000000" %do rwrii=2 %to &plevel; and lev&rwrii = 0 %end; then nr_level_cat = lev1;
4723       	run;
4724       
4725       	proc sort data=alltot; by g1 s1 week lev1 lineitem ean; run;
4726       
4727       	data alltot;
4728       		retain total_M001 1 total_M002 1 total_M003 1 total_M005 1 ;
4729       		set alltot;
4730       		by g1 s1 week lev1 lineitem ean;
4731       		
4732       		%readmeasurelist(&measurelist);
4733       		
4734       		if first.lev1 and lev1 < 100 then do;
4735       		   total_M001 = M001_tmp;
4736       		   total_M002 = M002_tmp;
4737       		   total_M003 = M003_tmp;
4738       		   total_M005 = M005_tmp;
4739       		   M254       = 100;
4740       		   M255       = 100;
4741       		   M256       = 100;
4742       		   M257       = 100;
4743       		end;
4744       		if nr_level_cat > 1 and lev1 >= 100 then do;
4745       		  /*** secondary total in case of multiple categories ***/
4746       		   M254       = .;
4747       		   M255       = .;
4748       		   M256       = .;
4749       		   M257       = .;
4750       		   total_M001 = .;
4751       		   total_M002 = .;
4752       		   total_M003 = .;
4753       		   total_M005 = .;
4754       		end;
4755       	run;
4756       %end;
4757       
4758       
4759       /***** 20160610 Extra Measures Begin  **************************************/
4760       
4761       
4762       /*** 20131121 : Performance monitoring ***/
4763       %monitor(_mod_=4);
4764       /*** 20131121 : Performance monitoring ***/
4765       
4766       
4767       %mend createmeasures;
4768       
4769       
4770       
4771       
4772       %macro adddescriptions;
4773       
4774        /*derive levels then merge with description file to get level descriptions*/
4775        /*ALLTOT is the aggregate file used as input to the reporting platform*/
4776        /*GEOGAGGS is the Summary Report file*/
4777       
4778        data alltot;
4779        set alltot;
4780        %do rwrii=1 %to &plevel;
4781         length plev&rwrii $17;
4782         plev&rwrii = scan(lineitem,&rwrii);       /*Identify levels from lineitem identifier*/
4783         lev&rwrii = plev&rwrii * 1;
4784         drop plev&rwrii;
4785        %end;
4786        length ean $14;
4787        lp=length(plev&plevel);
4788        if lp=15 then
4789         do;
4790          lev&plevel=substr(plev&plevel,1,1);
4791          ean=substr(plev&plevel,2,14);
4792         end;
4793        if lp=16 then
4794         do;
4795          lev&plevel=substr(plev&plevel,1,2);
4796          ean=substr(plev&plevel,3,14);
4797         end;
4798        if lp=17 then
4799         do;
4800          lev&plevel=substr(plev&plevel,1,3);
4801          ean=substr(plev&plevel,4,14);
4802         end;
4803         drop lineitem lp;
4804        run;
4805       
4806         data geogagg;
4807           set alltot(keep=g1 s1 lev1-lev&plevel ean week period M001 M002);
4808         run;
4809        %sortem(geogagg,lev1-lev&plevel ean);   /*changed item to ean*/
4810       
4811       /* The readdesc_v9 file reads in the description file .dsc file*/
4812       /*%readdesc_v10(&category);*/
4813       /*** 20130906 : New conversion-file at subcategory-level - this step is moved to beginning ***/
4814       
4815       
4816        %sortem(desc,lev1-lev&plevel ean);
4817       
4818       
4819        %macro levread;
4820         %let j=1;
4821         %do i=1 %to &plevel;
4822          substr(pcode,&j,5)=put(lev&i,z5.);
4823          %let j=%eval(&j+5);
4824         %end;
4825        %mend levread;
4826       
4827       
4828       /*merge aggregated data with level descriptions from description file*/
4829       /*Create Summary report with just Value and Volume*/
4830       
4831        %let v=6;
4832       
4833       data geogagg2;
4834        merge geogagg(in=a) desc(in=b);
4835        by lev1-lev&plevel ean;
4836        length levnames $ 200 pcode $ 200; /*change item to EAN*/
4837        %levread;
4838        levnames=trim(left(pcode));
4839        if (a and b) and (substr(levnames,1,5)='00001' and
4840        %do u=2 %to &plevel;
4841         %if &u < &plevel %then
4842          %do;
4843           substr(levnames,&v,5)='00000' and
4844           %let v=%eval(&v+5);
4845          %end;
4846         %else
4847          %do;
4848           substr(levnames,&v,5)='00000');
4849          %end;
4850        %end;
4851        keep g1 s1 week period M001 M002;
4852        run;
4853       
4854        %sortem(geogagg2,g1 s1 week);
4855       
4856        proc means data=geogagg2 noprint;
4857        var M001 M002;
4858        by g1 s1 week;
4859        id period;
4860        output out=geogaggs(drop=_type_ _freq_) sum=;
4861       run;
4862       
4863       
4864       /*  Get Category Number from the Description file  */
4865        data _null_;
4866        set desc(obs=1 keep=levcode rename=levcode=lev);
4867        lev2 = put(lev, 3.);
4868        call symput('lev2',trim(lev2));
4869        run;
4870        data geogaggs;set geogaggs;
4871        levs = "&lev2";
4872       run;
4873       
4874       /*  Read geog and shop type descriptions*/
4875       data geog(keep=num desc) shop(keep=num desc);
4876       infile "&Prod_DirectoryData/store.shop" recfm=v delimiter=',' missover;
4877       length desc $45. num $2.;
4878       input numtype $ desc $;
4879       type = substr(numtype,1,1);
4880       num  = substr(numtype,2);
4881       if length(trim(left(num)))=1 then num="0"!!trim(left(num));
4882       if type = "G" then output geog;
4883       if type = "S" then output shop;
4884       run;
4885       
4886          %if &syserr = 0 %then %do;
4887             %put USER-NOTE: File (&Prod_DirectoryData/store.shop) imported;
4888          %end;
4889          %else %do;
4890             %put ERROR: Importing file (&Prod_DirectoryData/store.shop) failed;
4891             data _null_; endsas; run;
4892          %end;
4893       
4894       /* Merge geog and shop descriptions with aggregated file */
4895       
4896       %macro store(store,numtype);
4897         %sortem(&store(rename=num=&numtype rename=desc=&store),&numtype);
4898         %sortem(geogaggs,&numtype);
4899       
4900       data geogaggs;
4901        merge &store geogaggs(in=a);
4902        if a;
4903        by &numtype;
4904       run;
4905       
4906       %mend store;
4907       %store(geog,g1);
4908       %store(shop,s1);
4909       %sortem(geogaggs, g1 s1);run;
4910       %sortem(alltot, g1 s1 week lev1-lev&plevel ean );
4911       
4912       data alltot;
4913        merge alltot(in=a) catmax(in=b);
4914        by g1 s1;
4915        if a and b;
4916        run;
4917       
4918       
4919       /*** 20131121 : Performance monitoring ***/
4920       %monitor(_mod_=4);
4921       /*** 20131121 : Performance monitoring ***/
4922       
4923       
4924       %mend adddescriptions;
4925       *%adddescriptions;
4926       
4927       
4928       %macro outputs;
4929       /*note: writegrossup writes out SKU code in v9, but need to write out EAN --
4930       however Combined should be reported at SKU level -- need to check*/
4931       
4932         /*---------------------------------------------------------*/
4933         /*  writes output files                                  --*/
4934         /*---------------------------------------------------------*/
4935          data _null_;
4936          set alltot;
4937          /* select destination and extention for output according to the service produced */
4938          %if &service=Combined %then %do;
4939             period=&period;
4940             file "&Prod_DirectoryOutput/aggregate/data/&service/period&period/&category..p&period" lrecl=370 recfm=v;
4941             %writegrossup_v10(&plevel,&meascnt,&measurelist);
4942          %end;
4943          %else %if &service=Infoscan %then %do;
4944             %if &Prod_OutputType ^= MONTH %then %do;
4945                %do j=&minwk %to &maxwk;
4946                   if week= &j then do;
4947                   period=&j;
4948                   file "&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))" lrecl=370 recfm=v;
4949                   %writegrossup_v10(&plevel,&meascnt,&measurelist);
4950                   end;
4951                %end;
4952             %end;
4953             %if %sysfunc(upcase(&Monthlyagg))=Y %then %do;
4954                if week =0 then do;
4955                period=&period;
4956                file "&Prod_DirectoryOutput/aggregate/data/&service/period&period/&category..p&period" lrecl=370 recfm=v;
4957                %writegrossup_v10(&plevel,&meascnt,&measurelist);
4958                end;
4959             %end;
4960          %end;
4961          %else %if &service=Promoscan %then %do;
4962             %do j=&minwk %to &maxwk;
4963                if week= &j then do;
4964                period=week;
4965                file "&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))" lrecl=1500 recfm=v; /*** 20160323 : changed from 1000 to 1500 ***/
4966                %writegrossup_v10(&plevel,&meascnt,&measurelist);
4967                end;
4968             %end;
4969          %end;
4970          run;
4971       
4972          %if &syserr = 0 %then %do;
4973             %if &service=Combined %then %do;
4974                %put USER-NOTE: File (&Prod_DirectoryOutput/aggregate/data/&service/period&period/&category..p&period) created;
4975             %end;
4976             %else %if &service=Infoscan %then %do;
4977                %if &Prod_OutputType ^= MONTH %then %do;
4978                   %do j=&minwk %to &maxwk;
4979                      %put USER-NOTE: File (&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))) created;
4980                   %end;
4981                %end;
4982                %if %sysfunc(upcase(&Monthlyagg))=Y %then %do;
4983                   %put USER-NOTE: File (&Prod_DirectoryOutput/aggregate/data/&service/period&period/&category..p&period) created;
4984                %end;
4985             %end;
4986             %else %if &service=Promoscan %then %do;
4987                %do j=&minwk %to &maxwk;
4988                   %put USER-NOTE: File (&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))) created;
4989                %end;
4990             %end;
4991          %end;
4992          %else %do;
4993             %put ERROR: Writing output-files failed;
4994             data _null_; endsas; run;
4995          %end;
4996       
4997          /*** 20131121 : Performance monitoring ************************************************************************/
4998          %if &service=Combined %then %do;
4999             %monitor(_var_=filesize_kb,    _val_=&Prod_DirectoryOutput/aggregate/data/&service/period&period/&category..p&period, _mod_=3);
5000          %end;
5001          %if &service=Infoscan %then %do;
5002             %if &Prod_OutputType ^= MONTH %then %do;
5003                %do j=&minwk %to &maxwk;
5004                   %monitor(_var_=filesize_kb, _val_=&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..))),             _mod_=3);
5005                %end;
5006             %end;
5007             %if %sysfunc(upcase(&Monthlyagg))=Y %then %do;
5008                %monitor(_var_=filesize_kb, _val_=&Prod_DirectoryOutput/aggregate/data/&service/period&period/&category..p&period, _mod_=3);
5009             %end;
5010          %end;
5011          %if &service=Promoscan %then %do;
5012             %do j=&minwk %to &maxwk;
5013                %monitor(_var_=filesize_kb, _val_=&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..))),             _mod_=3);
5014             %end;
5015          %end;
5016          /*** 20131121 : Performance monitoring ************************************************************************/
5017       
5018          data _null_;
5019          set geogaggs;
5020          if g1 not in(99);
5021          /* select destination and extention for output according to the service produced */
5022          %if &service=Combined %then %do;
5023             file "&Prod_DirectoryOutput/aggregate/data/&service/period&period/geog.&category..p&period" lrecl=90 recfm=v;
5024             put @1 levs $3. @5 geog $20. @25 shop $40. @65 M001 12.2 @77 M002 12.2 ;
5025          %end;
5026          %else %if &service=Infoscan %then %do;
5027             %if &Prod_OutputType ^= MONTH %then %do;
5028                %do j=&minwk %to &maxwk; *writes weekly data for Infoscan;
5029                   if week= &j then do;
5030                   period=&j;
5031                   file "&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/geog.&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))" lrecl=90 recfm=v;
5032                   put @1 levs $3. @5 geog $20. @25 shop $40. @65 M001 12.2 @77 M002 12.2 ;
5033                   end;
5034                %end;
5035             %end;
5036             %if %sysfunc(upcase(&Monthlyagg))=Y %then %do;
5037                if week= 0 then do;                *writes monthly data for Infoscan;
5038                period=&period;
5039                file "&Prod_DirectoryOutput/aggregate/data/&service/period&period/geog.&category..p&period" lrecl=90 recfm=v;
5040                put @1 levs $3. @5 geog $20. @25 shop $40. @65 M001 12.2 @77 M002 12.2 ;
5041                end;
5042             %end;
5043          %end;
5044          %else %if &service=Promoscan %then %do;
5045             %do j=&minwk %to &maxwk;
5046                if week= &j then do;
5047                period=week;
5048                file "&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/geog.&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))" lrecl=90 recfm=v;
5049                put @1 levs $3. @5 geog $20. @25 shop $40. @65 M001 12.2 @77 M002 12.2 ;
5050                end;
5051             %end;
5052          %end;
5053          run;
5054       
5055          %if &syserr = 0 %then %do;
5056             %if &service=Combined %then %do;
5057                %put USER-NOTE: File (&Prod_DirectoryOutput/aggregate/data/&service/period&period/geog.&category..p&period) created;
5058             %end;
5059             %else %if &service=Infoscan %then %do;
5060                %if &Prod_OutputType ^= MONTH %then %do;
5061                   %do j=&minwk %to &maxwk; *writes weekly data for Infoscan;
5062                      %put USER-NOTE: File (&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/geog.&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))) created;
5063                   %end;
5064                %end;
5065                %if %sysfunc(upcase(&Monthlyagg))=Y %then %do;
5066                   %put USER-NOTE: File (&Prod_DirectoryOutput/aggregate/data/&service/period&period/geog.&category..p&period) created;
5067                %end;
5068             %end;
5069             %else %if &service=Promoscan %then %do;
5070                %do j=&minwk %to &maxwk;
5071                   %put USER-NOTE: File (&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/geog.&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))) created;
5072                %end;
5073             %end;
5074          %end;
5075          %else %do;
5076             %put ERROR: Writing output-files failed;
5077             data _null_; endsas; run;
5078          %end;
5079       
5080          /*** 20131121 : Performance monitoring *******************************************************************/
5081          %if &service=Combined %then %do;
5082             %monitor(_var_=filesize_kb,    _val_=&Prod_DirectoryOutput/aggregate/data/&service/period&period/geog.&category..p&period,    _mod_=3);
5083          %end;
5084          %if &service=Infoscan %then %do;
5085             %if &Prod_OutputType ^= MONTH %then %do;
5086                %do j=&minwk %to &maxwk;
5087                   %monitor(_var_=filesize_kb, _val_=&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/geog.&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..))),                _mod_=3);
5088                %end;
5089             %end;
5090             %if %sysfunc(upcase(&Monthlyagg))=Y %then %do;
5091                %monitor(_var_=filesize_kb,    _val_=&Prod_DirectoryOutput/aggregate/data/&service/period&period/geog.&category..p&period, _mod_=3);
5092             %end;
5093          %end;
5094          %if &service=Promoscan %then %do;
5095             %do j=&minwk %to &maxwk;
5096                %monitor(_var_=filesize_kb, _val_=&Prod_DirectoryOutput/aggregate/data/&service/week%eval(%sysfunc(putn(&j,z&WEEK999LEN..)))/geog.&category..p%eval(%sysfunc(putn(&j,z&WEEK999LEN..))),                _mod_=3);
5097             %end;
5098          %end;
5099          /*** 20131121 : Performance monitoring ********************************************************************/
5100       
5101       %mend outputs;
5102       
5103       %main;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(MAIN):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(MAIN):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(MAIN):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(MAIN):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(MAIN):  ;
MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867      2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/week0867/geog.bschfrvNI.p0867 2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868      2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.00 seconds
      

MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/week0868/geog.bschfrvNI.p0868 2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869      2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/week0869/geog.bschfrvNI.p0869 2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870      2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/week0870/geog.bschfrvNI.p0870 2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128      2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

MPRINT(MAIN):   data _null_;
MPRINT(MAIN):   x "rm /data/prod/transition/audit/aggregate/data/Infoscan/period0128/geog.bschfrvNI.p0128 2>/dev/null";
MPRINT(MAIN):   run;
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READKEY):   data keycats;
MPRINT(READKEY):   infile "/data/prod/transition/audit/data/keycats.for.reports" truncover ;
MPRINT(READKEY):   input @1 category $10. @12 volcon 11. @23 valcon 11. @34 pricecon 11. @45 adcon 10. ;
MPRINT(READKEY):   run;

NOTE: The infile "/data/prod/transition/audit/data/keycats.for.reports" is:
      Filename=/data/prod/transition/audit/data/keycats.for.reports,
      Owner Name=prod,Group Name=users,
      Access Permission=rwxrw-r--,
      Last Modified=Sun Aug 26 13:11:36 2018,
      File Size (bytes)=216370

NOTE: 3934 records were read from the infile "/data/prod/transition/audit/data/keycats.for.reports".
      The minimum record length was 54.
      The maximum record length was 54.
NOTE: The data set WORK.KEYCATS has 3934 observations and 5 variables.
NOTE: Compressing data set WORK.KEYCATS increased size by 12.50 percent. 
      Compressed is 27 pages; un-compressed would require 24 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(READKEY):   data keycats;
MPRINT(READKEY):   set keycats;
MPRINT(READKEY):   if trim(left(category))="bschfrvNI" then do;
MPRINT(READKEY):   call symput('volcon', trim(left(volcon)));
MPRINT(READKEY):   call symput('valcon', trim(left(valcon)));
MPRINT(READKEY):   call symput('pricecon',trim(left(pricecon)));
MPRINT(READKEY):   call symput('adcon', trim(left(adcon)));
MPRINT(READKEY):   end;
MPRINT(READKEY):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5103:83    5103:133   5103:183   5103:235   
NOTE: There were 3934 observations read from the data set WORK.KEYCATS.
NOTE: The data set WORK.KEYCATS has 3934 observations and 5 variables.
NOTE: Compressing data set WORK.KEYCATS increased size by 12.50 percent. 
      Compressed is 27 pages; un-compressed would require 24 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

USER-NOTE: File (/data/prod/transition/audit/data/keycats.for.reports) imported
MPRINT(READKEY):   data subkeycats;
MPRINT(READKEY):   length levname $200. category $10.;
MPRINT(READKEY):   delete;
MPRINT(READKEY):   run;

NOTE: Variable levname is uninitialized.
NOTE: Variable category is uninitialized.
NOTE: The data set WORK.SUBKEYCATS has 0 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READKEY):   proc sort data=keycats nodupkey;
MPRINT(READKEY):   by category;
MPRINT(READKEY):   run;

NOTE: There were 3934 observations read from the data set WORK.KEYCATS.
NOTE: 160 observations with duplicate key values were deleted.
NOTE: The data set WORK.KEYCATS has 3774 observations and 5 variables.
NOTE: Compressing data set WORK.KEYCATS increased size by 13.04 percent. 
      Compressed is 26 pages; un-compressed would require 23 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READKEY):   proc sort data=subkeycats;
MPRINT(READKEY):   by category;
MPRINT(READKEY):   run;

NOTE: Input data set is empty.
NOTE: The data set WORK.SUBKEYCATS has 0 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READKEY):   data subkeycats;
MPRINT(READKEY):   merge subkeycats(in=a1) keycats(in=a2);
MPRINT(READKEY):   by category;
MPRINT(READKEY):   if a1 and a2;
MPRINT(READKEY):   run;

NOTE: There were 0 observations read from the data set WORK.SUBKEYCATS.
NOTE: There were 3774 observations read from the data set WORK.KEYCATS.
NOTE: The data set WORK.SUBKEYCATS has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

CATEGORY=bschfrvNI
VOLCON=1000
VALCON=1
PRICECON=1
ADCON=1
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   ***********************************************************************************;
MPRINT(READINPUTS):   *macros *;
MPRINT(READINPUTS):   *readdesc: reads in the hierarchy description file. *;
MPRINT(READINPUTS):   * Two parameters passed number of levels in *;
MPRINT(READINPUTS):   * hierarchy and client category name *;
MPRINT(READINPUTS):   * Update Author Description *;
MPRINT(READINPUTS):   * 18OCT02 Tom Dominski Increase the length from 3 to 4 for each *;
MPRINT(READINPUTS):   * Level to correct secondary issue *;
MPRINT(READINPUTS):   * 25MARCH Simon Poole Increased length from 4 to 5 *;
MPRINT(READINPUTS):   ***********************************************************************************;
MPRINT(READDESC_V10):   data _null_;
MPRINT(READDESC_V10):   infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc" lrecl=500;
MPRINT(READDESC_V10):   if _n_ =1 then do;
MPRINT(READDESC_V10):   input levels sectot;
MPRINT(READDESC_V10):   call symput("levels",levels);
MPRINT(READDESC_V10):   call symput("sectot",sectot);
MPRINT(READDESC_V10):   end;
MPRINT(READDESC_V10):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5103:153   5103:185   
NOTE: The infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc" is:
      Filename=/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Thu Aug 23 16:19:23 2018,
      File Size (bytes)=452513

NOTE: DATA STEP stopped due to looping.
NOTE: 1 record was read from the infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc".
      The minimum record length was 4.
      The maximum record length was 4.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

USER-NOTE: File (/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc) imported
MPRINT(READDESC_V10):   data desc(drop=levels sectot);
MPRINT(READDESC_V10):   infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc" lrecl=500;
MPRINT(READDESC_V10):   if _n_ =1 then do;
MPRINT(READDESC_V10):   input levels sectot;
MPRINT(READDESC_V10):   delete;
MPRINT(READDESC_V10):   end;
MPRINT(READDESC_V10):   else do;
MPRINT(READDESC_V10):   length levname $ 200 levcode $ 15;
MPRINT(READDESC_V10):   input @1 lev1 5. @6 lev2 5. @11 lev3 5. @16 lev4 5. @21 lev5 5. @26 ean $14. @41 levname $200. @242 levcode $ ;
MPRINT(READDESC_V10):   end;
MPRINT(READDESC_V10):   run;

NOTE: The infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc" is:
      Filename=/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Thu Aug 23 16:19:23 2018,
      File Size (bytes)=452513

NOTE: 1783 records were read from the infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc".
      The minimum record length was 4.
      The maximum record length was 256.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      

MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   proc sort data=desc(where=(lev1^=0 and lev2^=0 and lev3=0)) out=desc_conv(keep=levname lev1 lev2) nodupkey;
MPRINT(READINPUTS):   by levname;
MPRINT(READINPUTS):   run;

NOTE: There were 6 observations read from the data set WORK.DESC.
      WHERE (lev1 not = 0) and (lev2 not = 0) and (lev3=0);
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.DESC_CONV has 6 observations and 3 variables.
NOTE: Compressing data set WORK.DESC_CONV increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):   proc sort data=subkeycats nodupkey;
MPRINT(READINPUTS):   by levname;
MPRINT(READINPUTS):   run;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.SUBKEYCATS has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):   data subkeycats;
MPRINT(READINPUTS):   merge subkeycats(in=a1) desc_conv(in=a2);
MPRINT(READINPUTS):   by levname;
MPRINT(READINPUTS):   if a1 and a2;
MPRINT(READINPUTS):   run;

NOTE: There were 0 observations read from the data set WORK.SUBKEYCATS.
NOTE: There were 6 observations read from the data set WORK.DESC_CONV.
NOTE: The data set WORK.SUBKEYCATS has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(READINPUTS):   proc sort data=subkeycats nodupkey;
MPRINT(READINPUTS):   by lev1 lev2;
MPRINT(READINPUTS):   run;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.SUBKEYCATS has 0 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   run;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * MACRO CATSPEC: This macro generates the macro variables *;
MPRINT(CATSPEC):   * used by the aggregation engine *;
MPRINT(CATSPEC):   * geog => contains geography information *;
MPRINT(CATSPEC):   * stype => contains store type information *;
MPRINT(CATSPEC):   * meas => contains measure information *;
MPRINT(CATSPEC):   * prj => contains projection and universe name (assumes same name *;
MPRINT(CATSPEC):   *----------------------------------------------------------------- *;
MPRINT(CATSPEC):   * UPDATE DATE AUTHOR Description *;
MPRINT(CATSPEC):   * 2003.jun.30 A.Agostinelli Selection by SERVICE *;
MPRINT(CATSPEC):   * 2003.jul.27 A.Agostinelli manage Sample_name and Univ_name *;
MPRINT(CATSPEC):   * for Combined service *;
MPRINT(CATSPEC):   * 2003.sep.29 A.Agostinelli Use of Unbundling settings- type='U' *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   libname cload "/data/prod/transition/audit";
NOTE: Libref CLOAD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit
MPRINT(CATSPEC):   data allnames;
MPRINT(CATSPEC):   set cload.catall;
MPRINT(CATSPEC):   if upcase(namecat)=upcase("bschfrvNI");
MPRINT(CATSPEC):   *service="&_service_";
MPRINT(CATSPEC):   if service='' or upcase(service)=upcase("Infoscan") then do;
MPRINT(CATSPEC):   call symput('ok','Y');
MPRINT(CATSPEC):   output;
MPRINT(CATSPEC):   end;
MPRINT(CATSPEC):   run;

NOTE: There were 193704 observations read from the data set CLOAD.CATALL.
NOTE: The data set WORK.ALLNAMES has 15 observations and 5 variables.
NOTE: Compressing data set WORK.ALLNAMES increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.14 seconds
      cpu time            0.14 seconds
      

USER-NOTE: File (/data/prod/transition/audit/catall) imported
MPRINT(CATSPEC):   data geog type meas prj vol geol styl unb;
MPRINT(CATSPEC):   set allnames;
MPRINT(CATSPEC):   *if namecat="&_category_";
MPRINT(CATSPEC):   if type='G' then output geog;
MPRINT(CATSPEC):   if type='S' then output type;
MPRINT(CATSPEC):   if type='M' then output meas;
MPRINT(CATSPEC):   if type='P' then output prj;
MPRINT(CATSPEC):   if type='V' then output vol;
MPRINT(CATSPEC):   if type='L' then output geol;
MPRINT(CATSPEC):   if type='T' then output styl;
MPRINT(CATSPEC):   if type='U' then output unb;
MPRINT(CATSPEC):   run;

NOTE: There were 15 observations read from the data set WORK.ALLNAMES.
NOTE: The data set WORK.GEOG has 2 observations and 5 variables.
NOTE: Compressing data set WORK.GEOG increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.TYPE has 1 observations and 5 variables.
NOTE: Compressing data set WORK.TYPE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.MEAS has 7 observations and 5 variables.
NOTE: Compressing data set WORK.MEAS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.PRJ has 1 observations and 5 variables.
NOTE: Compressing data set WORK.PRJ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.VOL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.VOL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.GEOL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.GEOL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.STYL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.STYL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.UNB has 1 observations and 5 variables.
NOTE: Compressing data set WORK.UNB increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * these next couple of meas datasteps create two macro variables: *;
MPRINT(CATSPEC):   * meascnt = number of measures in the _category_ *;
MPRINT(CATSPEC):   * measlist = character string indicating all measure numbers *;
MPRINT(CATSPEC):   * in this _category_ *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data meas;
MPRINT(CATSPEC):   set meas end=last;
MPRINT(CATSPEC):   if last then call symput("meascnt",_n_);
MPRINT(CATSPEC):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5103:138   
NOTE: There were 7 observations read from the data set WORK.MEAS.
NOTE: The data set WORK.MEAS has 7 observations and 5 variables.
NOTE: Compressing data set WORK.MEAS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   data meas;
MPRINT(CATSPEC):   set meas end=last;
MPRINT(CATSPEC):   length measlist $ 28 ;
MPRINT(CATSPEC):   retain measlist;
MPRINT(CATSPEC):   if _n_=1 then measlist=trim(left(typenum));
MPRINT(CATSPEC):   else measlist=trim(left(measlist)) || " " || trim(left(typenum));
MPRINT(CATSPEC):   put measlist;
MPRINT(CATSPEC):   if last then do;
MPRINT(CATSPEC):   call symput("measlist",measlist);
MPRINT(CATSPEC):   call symput("measurelist",measlist);
MPRINT(CATSPEC):   end;
MPRINT(CATSPEC):   run;

001
001 002
001 002 003
001 002 003 004
001 002 003 004 005
001 002 003 004 005 007
001 002 003 004 005 007 008
NOTE: There were 7 observations read from the data set WORK.MEAS.
NOTE: The data set WORK.MEAS has 7 observations and 6 variables.
NOTE: Compressing data set WORK.MEAS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * these next couple of geog datasteps create two macro variables: *;
MPRINT(CATSPEC):   * geocnt = number of geographies in the _category_ *;
MPRINT(CATSPEC):   * geolist = character string indicating all geography numbers *;
MPRINT(CATSPEC):   * in this _category_ *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data geog;
MPRINT(CATSPEC):   set geog end=last;
MPRINT(CATSPEC):   if last then call symput("geocnt",_n_);
MPRINT(CATSPEC):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5103:47   
NOTE: There were 2 observations read from the data set WORK.GEOG.
NOTE: The data set WORK.GEOG has 2 observations and 5 variables.
NOTE: Compressing data set WORK.GEOG increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CATSPEC):   data geog;
MPRINT(CATSPEC):   set geog end=last;
MPRINT(CATSPEC):   length geolist $ 8 ;
MPRINT(CATSPEC):   retain geolist;
MPRINT(CATSPEC):   if _n_=1 then geolist=trim(left(typenum));
MPRINT(CATSPEC):   else geolist=trim(left(geolist)) || " " || trim(left(typenum));
MPRINT(CATSPEC):   put geolist;
MPRINT(CATSPEC):   if last then do;
MPRINT(CATSPEC):   call symput("geolist",geolist);
MPRINT(CATSPEC):   end;
MPRINT(CATSPEC):   run;

000
000 008
NOTE: There were 2 observations read from the data set WORK.GEOG.
NOTE: The data set WORK.GEOG has 2 observations and 6 variables.
NOTE: Compressing data set WORK.GEOG increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * these next couple of type datasteps create two macro variables: *;
MPRINT(CATSPEC):   * typecnt = number of store types in the _category_ *;
MPRINT(CATSPEC):   * typelist = character string indicating all stype values *;
MPRINT(CATSPEC):   * in this _category_ *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data type;
MPRINT(CATSPEC):   set type end=last;
MPRINT(CATSPEC):   if last then call symput("typecnt",_n_);
MPRINT(CATSPEC):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5103:237   
NOTE: There were 1 observations read from the data set WORK.TYPE.
NOTE: The data set WORK.TYPE has 1 observations and 5 variables.
NOTE: Compressing data set WORK.TYPE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   data type;
MPRINT(CATSPEC):   set type end=last;
MPRINT(CATSPEC):   length typelist $ 4 ;
MPRINT(CATSPEC):   retain typelist;
MPRINT(CATSPEC):   if _n_=1 then typelist=trim(left(typenum));
MPRINT(CATSPEC):   else typelist=trim(left(typelist)) || " " || trim(left(typenum));
MPRINT(CATSPEC):   put typelist;
MPRINT(CATSPEC):   if last then do;
MPRINT(CATSPEC):   call symput("typelist",typelist);
MPRINT(CATSPEC):   end;
MPRINT(CATSPEC):   run;

0X0
NOTE: There were 1 observations read from the data set WORK.TYPE.
NOTE: The data set WORK.TYPE has 1 observations and 6 variables.
NOTE: Compressing data set WORK.TYPE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create two macro variables: *;
MPRINT(CATSPEC):   * sample= name of projection factor file *;
MPRINT(CATSPEC):   * univ= name of universe file *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data prj;
MPRINT(CATSPEC):   set prj end=last;
MPRINT(CATSPEC):   length typeuniv $50. typeproj $50. typenumerical $50.;
MPRINT(CATSPEC):   typeproj=trim(left(typedesc))||"0128"||'.csv';
MPRINT(CATSPEC):   typeuniv=trim(left(typedesc))||"0128"||'.uni';
MPRINT(CATSPEC):   typenumerical = trim(left(typedesc)) || "0128" || '.num';
MPRINT(CATSPEC):   if last then call symput("sample",typeproj);
MPRINT(CATSPEC):   if last then call symput("sample_name",trim(left(typedesc)));
MPRINT(CATSPEC):   if last then call symput("univ",typeuniv);
MPRINT(CATSPEC):   if last then call symput("univ_name",trim(left(typedesc)));
MPRINT(CATSPEC):   if last then call symput("numerical", trim(left(typenumerical)));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.PRJ.
NOTE: The data set WORK.PRJ has 1 observations and 8 variables.
NOTE: Compressing data set WORK.PRJ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

chipall0128.csv
chipall0128.uni
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create one macro variable: *;
MPRINT(CATSPEC):   * volfact= name of volume conversion facto for _category_ *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data vol;
MPRINT(CATSPEC):   set vol end=last;
MPRINT(CATSPEC):   if last then call symput("volfact",trim(left(typedesc)));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.VOL.
NOTE: The data set WORK.VOL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.VOL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create one macro variable: *;
MPRINT(CATSPEC):   * glev= number of levels in the geography dimension *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data geol;
MPRINT(CATSPEC):   set geol end=last;
MPRINT(CATSPEC):   if last then call symput("glev",trim(left(typedesc)));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.GEOL.
NOTE: The data set WORK.GEOL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.GEOL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create one macro variable: *;
MPRINT(CATSPEC):   * slev= number of levels in the store type dimension *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data styl;
MPRINT(CATSPEC):   set styl end=last;
MPRINT(CATSPEC):   if last then call symput("slev",trim(left(typedesc)));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.STYL.
NOTE: The data set WORK.STYL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.STYL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create one macro variable: *;
MPRINT(CATSPEC):   * unb_flag= flag for unbundling ('YES' / 'NO'[default value]) *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data _null_;
MPRINT(CATSPEC):   call symput("unb_flag",'NO');
MPRINT(CATSPEC):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   data unb;
MPRINT(CATSPEC):   set unb end=last;
MPRINT(CATSPEC):   if last then call symput("unb_flag",trim(left(upcase(typedesc))));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.UNB.
NOTE: The data set WORK.UNB has 1 observations and 5 variables.
NOTE: Compressing data set WORK.UNB increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

meascnt     =            7
measlist    = 001 002 003 004 005 007 008
measurelist = 001 002 003 004 005 007 008
geocnt      =            2
geolist     = 000 008
typecnt     =            1
typelist    = 0X0
sample      = chipall0128.csv
sample_name = chipall
univ        = chipall0128.uni
univ_name   = chipall
numerical   = chipall0128.num
volfact     = 1
glev        = 3
slev        = 4
unb_flag    = NO
MPRINT(READINPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):  *******************************************************************;
MPRINT(READINPUTS):  * READPROJ.SAS: This macro will read the projection files *;
MPRINT(READINPUTS):   * *;
MPRINT(READINPUTS):   * Simon Poole 03/26/03 *;
MPRINT(READINPUTS):   * Alberto Agostinelli 07/30/2003 version 1 *;
MPRINT(READINPUTS):   *******************************************************************;
MPRINT(READPROJ):   data proj0867(drop=store2);
MPRINT(READPROJ):   length g1 s1 $2. factor store 8.;
MPRINT(READPROJ):   infile "/data/prod/transition/audit/proj/chipallweek0867.csv" delimiter=',' missover;
MPRINT(READPROJ):   input store2 $ g1 $ s1 $ factor;
MPRINT(READPROJ):   store=input(store2,5.);
MPRINT(READPROJ):   if length(trim(left(g1)))=1 then g1="0"!!trim(left(g1));
MPRINT(READPROJ):   if length(trim(left(s1)))=1 then s1="0"!!trim(left(s1));
MPRINT(READPROJ):   run;

NOTE: Compression was disabled for data set WORK.PROJ0867 because compression overhead would increase the size of the data set.
NOTE: The infile "/data/prod/transition/audit/proj/chipallweek0867.csv" is:
      Filename=/data/prod/transition/audit/proj/chipallweek0867.csv,
      Owner Name=prod,Group Name=users,
      Access Permission=rwxrwxrwx,
      Last Modified=Tue Mar  8 15:32:32 2016,
      File Size (bytes)=19034

NOTE: 1351 records were read from the infile "/data/prod/transition/audit/proj/chipallweek0867.csv".
      The minimum record length was 12.
      The maximum record length was 16.
NOTE: The data set WORK.PROJ0867 has 1351 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

USER-NOTE: File (/data/prod/transition/audit/proj/chipallweek0867.csv) imported
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   data proj0867;
MPRINT(READINPUTS):   set proj0867;
MPRINT(READINPUTS):   week=0867;
MPRINT(READINPUTS):   run;

NOTE: There were 1351 observations read from the data set WORK.PROJ0867.
NOTE: The data set WORK.PROJ0867 has 1351 observations and 5 variables.
NOTE: Compressing data set WORK.PROJ0867 increased size by 50.00 percent. 
      Compressed is 9 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READINPUTS):   proc append data= proj0867 base=proj;
NOTE: Appending WORK.PROJ0867 to WORK.PROJ.
NOTE: BASE data set does not exist. DATA file is being copied to BASE file.
NOTE: There were 1351 observations read from the data set WORK.PROJ0867.
NOTE: The data set WORK.PROJ has 1351 observations and 5 variables.
NOTE: Compressing data set WORK.PROJ increased size by 50.00 percent. 
      Compressed is 9 pages; un-compressed would require 6 pages.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.05 seconds
      cpu time            0.05 seconds
      

MPRINT(READINPUTS):   proc delete data= proj0867;
MPRINT(READINPUTS):   run;

NOTE: Deleting WORK.PROJ0867 (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READPROJ):   data proj0868(drop=store2);
MPRINT(READPROJ):   length g1 s1 $2. factor store 8.;
MPRINT(READPROJ):   infile "/data/prod/transition/audit/proj/chipallweek0868.csv" delimiter=',' missover;
MPRINT(READPROJ):   input store2 $ g1 $ s1 $ factor;
MPRINT(READPROJ):   store=input(store2,5.);
MPRINT(READPROJ):   if length(trim(left(g1)))=1 then g1="0"!!trim(left(g1));
MPRINT(READPROJ):   if length(trim(left(s1)))=1 then s1="0"!!trim(left(s1));
MPRINT(READPROJ):   run;

NOTE: Compression was disabled for data set WORK.PROJ0868 because compression overhead would increase the size of the data set.
NOTE: The infile "/data/prod/transition/audit/proj/chipallweek0868.csv" is:
      Filename=/data/prod/transition/audit/proj/chipallweek0868.csv,
      Owner Name=prod,Group Name=users,
      Access Permission=rwxrwxrwx,
      Last Modified=Tue Mar  8 15:32:32 2016,
      File Size (bytes)=19048

NOTE: 1352 records were read from the infile "/data/prod/transition/audit/proj/chipallweek0868.csv".
      The minimum record length was 12.
      The maximum record length was 16.
NOTE: The data set WORK.PROJ0868 has 1352 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

USER-NOTE: File (/data/prod/transition/audit/proj/chipallweek0868.csv) imported
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   data proj0868;
MPRINT(READINPUTS):   set proj0868;
MPRINT(READINPUTS):   week=0868;
MPRINT(READINPUTS):   run;

NOTE: There were 1352 observations read from the data set WORK.PROJ0868.
NOTE: The data set WORK.PROJ0868 has 1352 observations and 5 variables.
NOTE: Compressing data set WORK.PROJ0868 increased size by 50.00 percent. 
      Compressed is 9 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):   proc append data= proj0868 base=proj;
NOTE: Appending WORK.PROJ0868 to WORK.PROJ.
NOTE: There were 1352 observations read from the data set WORK.PROJ0868.
NOTE: 1352 observations added.
NOTE: The data set WORK.PROJ has 2703 observations and 5 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READINPUTS):   proc delete data= proj0868;
MPRINT(READINPUTS):   run;

NOTE: Deleting WORK.PROJ0868 (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READPROJ):   data proj0869(drop=store2);
MPRINT(READPROJ):   length g1 s1 $2. factor store 8.;
MPRINT(READPROJ):   infile "/data/prod/transition/audit/proj/chipallweek0869.csv" delimiter=',' missover;
MPRINT(READPROJ):   input store2 $ g1 $ s1 $ factor;
MPRINT(READPROJ):   store=input(store2,5.);
MPRINT(READPROJ):   if length(trim(left(g1)))=1 then g1="0"!!trim(left(g1));
MPRINT(READPROJ):   if length(trim(left(s1)))=1 then s1="0"!!trim(left(s1));
MPRINT(READPROJ):   run;

NOTE: Compression was disabled for data set WORK.PROJ0869 because compression overhead would increase the size of the data set.
NOTE: The infile "/data/prod/transition/audit/proj/chipallweek0869.csv" is:
      Filename=/data/prod/transition/audit/proj/chipallweek0869.csv,
      Owner Name=prod,Group Name=users,
      Access Permission=rwxrwxrwx,
      Last Modified=Tue Mar  8 15:32:32 2016,
      File Size (bytes)=19022

NOTE: 1350 records were read from the infile "/data/prod/transition/audit/proj/chipallweek0869.csv".
      The minimum record length was 12.
      The maximum record length was 16.
NOTE: The data set WORK.PROJ0869 has 1350 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

USER-NOTE: File (/data/prod/transition/audit/proj/chipallweek0869.csv) imported
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   data proj0869;
MPRINT(READINPUTS):   set proj0869;
MPRINT(READINPUTS):   week=0869;
MPRINT(READINPUTS):   run;

NOTE: There were 1350 observations read from the data set WORK.PROJ0869.
NOTE: The data set WORK.PROJ0869 has 1350 observations and 5 variables.
NOTE: Compressing data set WORK.PROJ0869 increased size by 50.00 percent. 
      Compressed is 9 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(READINPUTS):   proc append data= proj0869 base=proj;
NOTE: Appending WORK.PROJ0869 to WORK.PROJ.
NOTE: There were 1350 observations read from the data set WORK.PROJ0869.
NOTE: 1350 observations added.
NOTE: The data set WORK.PROJ has 4053 observations and 5 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):   proc delete data= proj0869;
MPRINT(READINPUTS):   run;

NOTE: Deleting WORK.PROJ0869 (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READPROJ):   data proj0870(drop=store2);
MPRINT(READPROJ):   length g1 s1 $2. factor store 8.;
MPRINT(READPROJ):   infile "/data/prod/transition/audit/proj/chipallweek0870.csv" delimiter=',' missover;
MPRINT(READPROJ):   input store2 $ g1 $ s1 $ factor;
MPRINT(READPROJ):   store=input(store2,5.);
MPRINT(READPROJ):   if length(trim(left(g1)))=1 then g1="0"!!trim(left(g1));
MPRINT(READPROJ):   if length(trim(left(s1)))=1 then s1="0"!!trim(left(s1));
MPRINT(READPROJ):   run;

NOTE: Compression was disabled for data set WORK.PROJ0870 because compression overhead would increase the size of the data set.
NOTE: The infile "/data/prod/transition/audit/proj/chipallweek0870.csv" is:
      Filename=/data/prod/transition/audit/proj/chipallweek0870.csv,
      Owner Name=prod,Group Name=users,
      Access Permission=rwxrwxrwx,
      Last Modified=Tue Mar  8 15:32:32 2016,
      File Size (bytes)=19047

NOTE: 1352 records were read from the infile "/data/prod/transition/audit/proj/chipallweek0870.csv".
      The minimum record length was 12.
      The maximum record length was 16.
NOTE: The data set WORK.PROJ0870 has 1352 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

USER-NOTE: File (/data/prod/transition/audit/proj/chipallweek0870.csv) imported
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   data proj0870;
MPRINT(READINPUTS):   set proj0870;
MPRINT(READINPUTS):   week=0870;
MPRINT(READINPUTS):   run;

NOTE: There were 1352 observations read from the data set WORK.PROJ0870.
NOTE: The data set WORK.PROJ0870 has 1352 observations and 5 variables.
NOTE: Compressing data set WORK.PROJ0870 increased size by 50.00 percent. 
      Compressed is 9 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READINPUTS):   proc append data= proj0870 base=proj;
NOTE: Appending WORK.PROJ0870 to WORK.PROJ.
NOTE: There were 1352 observations read from the data set WORK.PROJ0870.
NOTE: 1352 observations added.
NOTE: The data set WORK.PROJ has 5405 observations and 5 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):   proc delete data= proj0870;
MPRINT(READINPUTS):   run;

NOTE: Deleting WORK.PROJ0870 (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):   data _null_;
MPRINT(READINPUTS):   length string $3. newmeasure_rb newmeasure_bat $1.;
MPRINT(READINPUTS):   string="001";
MPRINT(READINPUTS):   if index(string,'245')>0 or index(string,'246')>0 or index(string,'247')>0 then do;
MPRINT(READINPUTS):   newmeasure_rb='Y';
MPRINT(READINPUTS):   call symput('newmeasure_rb', trim(left(newmeasure_rb)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   if index(string,'248') or index(string,'249') or index(string,'250') or index(string,'251') or index(string,'252') or index(string,'253') then do;
MPRINT(READINPUTS):   newmeasure_bat='Y';
MPRINT(READINPUTS):   call symput('newmeasure_bat', trim(left(newmeasure_bat)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   string="002";
MPRINT(READINPUTS):   if index(string,'245')>0 or index(string,'246')>0 or index(string,'247')>0 then do;
MPRINT(READINPUTS):   newmeasure_rb='Y';
MPRINT(READINPUTS):   call symput('newmeasure_rb', trim(left(newmeasure_rb)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   if index(string,'248') or index(string,'249') or index(string,'250') or index(string,'251') or index(string,'252') or index(string,'253') then do;
MPRINT(READINPUTS):   newmeasure_bat='Y';
MPRINT(READINPUTS):   call symput('newmeasure_bat', trim(left(newmeasure_bat)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   string="003";
MPRINT(READINPUTS):   if index(string,'245')>0 or index(string,'246')>0 or index(string,'247')>0 then do;
MPRINT(READINPUTS):   newmeasure_rb='Y';
MPRINT(READINPUTS):   call symput('newmeasure_rb', trim(left(newmeasure_rb)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   if index(string,'248') or index(string,'249') or index(string,'250') or index(string,'251') or index(string,'252') or index(string,'253') then do;
MPRINT(READINPUTS):   newmeasure_bat='Y';
MPRINT(READINPUTS):   call symput('newmeasure_bat', trim(left(newmeasure_bat)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   string="004";
MPRINT(READINPUTS):   if index(string,'245')>0 or index(string,'246')>0 or index(string,'247')>0 then do;
MPRINT(READINPUTS):   newmeasure_rb='Y';
MPRINT(READINPUTS):   call symput('newmeasure_rb', trim(left(newmeasure_rb)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   if index(string,'248') or index(string,'249') or index(string,'250') or index(string,'251') or index(string,'252') or index(string,'253') then do;
MPRINT(READINPUTS):   newmeasure_bat='Y';
MPRINT(READINPUTS):   call symput('newmeasure_bat', trim(left(newmeasure_bat)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   string="005";
MPRINT(READINPUTS):   if index(string,'245')>0 or index(string,'246')>0 or index(string,'247')>0 then do;
MPRINT(READINPUTS):   newmeasure_rb='Y';
MPRINT(READINPUTS):   call symput('newmeasure_rb', trim(left(newmeasure_rb)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   if index(string,'248') or index(string,'249') or index(string,'250') or index(string,'251') or index(string,'252') or index(string,'253') then do;
MPRINT(READINPUTS):   newmeasure_bat='Y';
MPRINT(READINPUTS):   call symput('newmeasure_bat', trim(left(newmeasure_bat)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   string="007";
MPRINT(READINPUTS):   if index(string,'245')>0 or index(string,'246')>0 or index(string,'247')>0 then do;
MPRINT(READINPUTS):   newmeasure_rb='Y';
MPRINT(READINPUTS):   call symput('newmeasure_rb', trim(left(newmeasure_rb)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   if index(string,'248') or index(string,'249') or index(string,'250') or index(string,'251') or index(string,'252') or index(string,'253') then do;
MPRINT(READINPUTS):   newmeasure_bat='Y';
MPRINT(READINPUTS):   call symput('newmeasure_bat', trim(left(newmeasure_bat)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   string="008";
MPRINT(READINPUTS):   if index(string,'245')>0 or index(string,'246')>0 or index(string,'247')>0 then do;
MPRINT(READINPUTS):   newmeasure_rb='Y';
MPRINT(READINPUTS):   call symput('newmeasure_rb', trim(left(newmeasure_rb)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   if index(string,'248') or index(string,'249') or index(string,'250') or index(string,'251') or index(string,'252') or index(string,'253') then do;
MPRINT(READINPUTS):   newmeasure_bat='Y';
MPRINT(READINPUTS):   call symput('newmeasure_bat', trim(left(newmeasure_bat)));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READINPUTS):  ***********************************************************************************;
MPRINT(READINPUTS):  *macros *;
MPRINT(READINPUTS):   *readcode: reads in the hierarchy code file. two param- *;
MPRINT(READINPUTS):   * eters passed: number of levels in hierarchy *;
MPRINT(READINPUTS):   * and client category name *;
MPRINT(READINPUTS):   * Update Author Description *;
MPRINT(READINPUTS):   * 18OCT02 Tom Dominski Change length of level from 3 to 4 *;
MPRINT(READINPUTS):   * because of secondary issues *;
MPRINT(READINPUTS):   * 25Mar 2003 Simon Poole Changed code length from 4 to 5 *;
MPRINT(READINPUTS):   * May 2003 Simon Poole Chaged for Transition -- item from 8 to 13 length *;
MPRINT(READINPUTS):   ***********************************************************************************;
MPRINT(READCODE_V10):   data _null_;
MPRINT(READCODE_V10):   infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde";
MPRINT(READCODE_V10):   if _n_ =1 then do;
MPRINT(READCODE_V10):   input levels sectot;
MPRINT(READCODE_V10):   call symput("levels",levels);
MPRINT(READCODE_V10):   call symput("sectot",sectot);
MPRINT(READCODE_V10):   end;
MPRINT(READCODE_V10):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5103:179   5103:215   
NOTE: The infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde" is:
      Filename=/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Thu Aug 23 16:19:23 2018,
      File Size (bytes)=440005

NOTE: DATA STEP stopped due to looping.
NOTE: 1 record was read from the infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde".
      The minimum record length was 4.
      The maximum record length was 4.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

10
MPRINT(READCODE_V10):   data code(drop=levels sectot) sectot(drop=levels sectot);
MPRINT(READCODE_V10):   infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde";
MPRINT(READCODE_V10):   if _n_ =1 then do;
MPRINT(READCODE_V10):   input levels sectot;
MPRINT(READCODE_V10):   delete;
MPRINT(READCODE_V10):   end;
MPRINT(READCODE_V10):   else do;
MPRINT(READCODE_V10):   length item $ 14;
MPRINT(READCODE_V10):   input @1 lev1 5. @6 lev2 5. @11 lev3 5. @16 lev4 5. @21 lev5 5. @26 item $ ;
MPRINT(READCODE_V10):   ean=item;
MPRINT(READCODE_V10):   *if lev1 <100 then * do;
MPRINT(READCODE_V10):   * sku2=lev2;
MPRINT(READCODE_V10):   * sku=substr(sku2,2,8);
MPRINT(READCODE_V10):   * end;
MPRINT(READCODE_V10):   if lev1 >=100 then output sectot;
MPRINT(READCODE_V10):   else output code;
MPRINT(READCODE_V10):   end;
MPRINT(READCODE_V10):   run;

NOTE: The infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde" is:
      Filename=/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Thu Aug 23 16:19:23 2018,
      File Size (bytes)=440005

NOTE: 11001 records were read from the infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde".
      The minimum record length was 4.
      The maximum record length was 39.
NOTE: The data set WORK.CODE has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.CODE increased size by 10.00 percent. 
      Compressed is 11 pages; un-compressed would require 10 pages.
NOTE: The data set WORK.SECTOT has 10000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT decreased size by 15.73 percent. 
      Compressed is 75 pages; un-compressed would require 89 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

USER-NOTE: File (/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde) imported
MPRINT(READINPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):  *****************************************************************;
MPRINT(READINPUTS):  * READITEM.SAS: This macro will read the Integrated Dictionary *;
MPRINT(READINPUTS):   * *;
MPRINT(READINPUTS):   * Simon Poole 03/26/03 *;
MPRINT(READINPUTS):   *****************************************************************;
MPRINT(READITEM):   data item;
MPRINT(READITEM):   infile "/data/prod/transition/audit/data/item" recfm=f lrecl=226;
MPRINT(READITEM):   input @1 sys 2. @3 gen 2. @5 vendor 5. @10 item 5. @15 desc $36. @51 volume 5. @56 vol_type $2. @58 wkadd 4. @62 wk_lmove 4. @66 price 6. @72 new_item 1. @73 complete 1. @74 volcount 3. @77 packtype $2. @79 keycat 4. @83 brand $20. 
@103 company $30. @133 prntcomp $30. @163 prodtype $10. @173 wraptype $10. @183 movecnt 3. @186 sku2 $8. @194 vol1 8.2 @202 vol2 8.2 @210 vol3 8.2 @218 vol4 8.2 ;
MPRINT(READITEM):   drop price;
MPRINT(READITEM):   EAN=put(sys,z2.)||put(gen,z2.)||put(vendor,z5.)||put(item,z5.);
MPRINT(READITEM):   drop item;
MPRINT(READITEM):   l=length(sku2);
MPRINT(READITEM):   sku=sku2;
MPRINT(READITEM):   if l=5 then do;
MPRINT(READITEM):   sku='000'||sku2;
MPRINT(READITEM):   end;
MPRINT(READITEM):   if l=6 then do;
MPRINT(READITEM):   sku='00' ||sku2;
MPRINT(READITEM):   end;
MPRINT(READITEM):   if l=7 then do;
MPRINT(READITEM):   sku='0' ||sku2;
MPRINT(READITEM):   end;
MPRINT(READITEM):   drop sku2;
MPRINT(READITEM):   drop l;
MPRINT(READITEM):   run;

NOTE: The infile "/data/prod/transition/audit/data/item" is:
      Filename=/data/prod/transition/audit/data/item,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Thu Aug 23 10:57:43 2018,
      File Size (bytes)=675702484

NOTE: 2989834 records were read from the infile "/data/prod/transition/audit/data/item".
NOTE: The data set WORK.ITEM has 2989834 observations and 25 variables.
NOTE: Compressing data set WORK.ITEM decreased size by 55.43 percent. 
      Compressed is 23799 pages; un-compressed would require 53391 pages.
NOTE: DATA statement used (Total process time):
      real time           20.49 seconds
      cpu time            20.24 seconds
      

MPRINT(READITEM):   proc sort data=item nodupkey;
MPRINT(READITEM):   by ean;
MPRINT(READITEM):   run;

NOTE: There were 2989834 observations read from the data set WORK.ITEM.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.ITEM has 2989834 observations and 25 variables.
NOTE: Compressing data set WORK.ITEM decreased size by 55.43 percent. 
      Compressed is 23799 pages; un-compressed would require 53391 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           13.42 seconds
      cpu time            18.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/data/item) imported
MPRINT(READINPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MPRINT(SORTEM):   proc sort data=item(keep=ean vol1 vol2 vol3 vol4 sku keycat packtype wkadd) nodupkey;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 2989834 observations read from the data set WORK.ITEM.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.ITEM has 2989834 observations and 9 variables.
NOTE: Compressing data set WORK.ITEM decreased size by 24.50 percent. 
      Compressed is 9989 pages; un-compressed would require 13230 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           8.60 seconds
      cpu time            11.16 seconds
      

MPRINT(READINPUTS):  ;
MPRINT(SORTEM):   proc sort data=code(drop=item);
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.CODE.
NOTE: The data set WORK.CODE has 1000 observations and 6 variables.
NOTE: Compressing data set WORK.CODE increased size by 12.50 percent. 
      Compressed is 9 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READINPUTS):  ;
MPRINT(SORTEM):   proc sort data=code(keep=ean) out=eanlist;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: Compression was disabled for data set WORK.EANLIST because compression overhead would increase the size of the data set.
NOTE: Input data set is already sorted; it has been copied to the output data set.
NOTE: There were 1000 observations read from the data set WORK.CODE.
NOTE: The data set WORK.EANLIST has 1000 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   data eanlist;
MPRINT(READINPUTS):   set eanlist sectot(keep=ean);
MPRINT(READINPUTS):   run;

NOTE: Compression was disabled for data set WORK.EANLIST because compression overhead would increase the size of the data set.
NOTE: There were 1000 observations read from the data set WORK.EANLIST.
NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.EANLIST has 11000 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=eanlist nodupkey;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 11000 observations read from the data set WORK.EANLIST.
NOTE: 10000 observations with duplicate key values were deleted.
NOTE: The data set WORK.EANLIST has 1000 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(READINPUTS):  ;
MPRINT(MATCHMERGE):   data item ;
MPRINT(MATCHMERGE):   merge item (in=a) eanlist (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 2989834 observations read from the data set WORK.ITEM.
NOTE: There were 1000 observations read from the data set WORK.EANLIST.
NOTE: The data set WORK.ITEM has 955 observations and 9 variables.
NOTE: Compressing data set WORK.ITEM decreased size by 0.00 percent. 
      Compressed is 9 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           4.41 seconds
      cpu time            4.41 seconds
      

MPRINT(READINPUTS):  ;
MPRINT(SORTEM):   proc sort data=item(keep=keycat) nodupkey out=kclist;
MPRINT(SORTEM):   by keycat;
MPRINT(SORTEM):   run;

NOTE: Compression was disabled for data set WORK.KCLIST because compression overhead would increase the size of the data set.
NOTE: There were 955 observations read from the data set WORK.ITEM.
NOTE: 943 observations with duplicate key values were deleted.
NOTE: The data set WORK.KCLIST has 12 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   data kclist;
MPRINT(READINPUTS):   set kclist end=fine;
MPRINT(READINPUTS):   length kclist $2000.;
MPRINT(READINPUTS):   retain kclist;
MPRINT(READINPUTS):   kclist=compbl(kclist || keycat);
MPRINT(READINPUTS):   if fine then do;
MPRINT(READINPUTS):   call symput("kclist", compbl(kclist));
MPRINT(READINPUTS):   end;
MPRINT(READINPUTS):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5103:2   
NOTE: There were 12 observations read from the data set WORK.KCLIST.
NOTE: The data set WORK.KCLIST has 12 observations and 2 variables.
NOTE: Compressing data set WORK.KCLIST increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):  *****************************************************************;
MPRINT(READINPUTS):  * READMASTSCAN.SAS: This macro will read the Master files *;
MPRINT(READINPUTS):   * for Scanner *;
MPRINT(READINPUTS):   * A.Agostinelli 28.10.2003 *;
MPRINT(READINPUTS):   * UPDATE: *;
MPRINT(READINPUTS):   * 28.07.2015 R.Walter Consolidation of all versions *;
MPRINT(READINPUTS):   * Zipping datasets *;
MPRINT(READINPUTS):   * 16.02.2016 R.Walter Removing PACKTYPE-information *;
MPRINT(READINPUTS):   *****************************************************************;
MPRINT(READMASTSCAN):   libname mastlib "/start/allprod";
NOTE: Libref MASTLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /start/allprod
MPRINT(READMASTSCAN):   filename inp "/start/allprod/week0867";
MPRINT(READMASTSCAN):   data mastscan0867;
MPRINT(READMASTSCAN):   infile inp recfm=f lrecl=55;
MPRINT(READMASTSCAN):   input @1 sys ib2. @3 gen ib2. @5 vendor ib4. @9 item ib4. @13 store ib4. @17 week ib2. @21 price rb4. @25 units rb4. @29 feat1 pib1. @29 feat bits1.7 @29 bund bits1.6 @29 infeat bits1.5 @30 instore pib1. @31 disp1 pib1. @31 disp 
bits1.7 @31 dispend bits1.6 @33 b_units rb4. @37 b_price rb4. @43 keycat ib2. @45 packyype $2. @47 numfac rb4. @51 lenfac rb4. ;
MPRINT(READMASTSCAN):   units=units/100;
MPRINT(READMASTSCAN):   price=price/100;
MPRINT(READMASTSCAN):  price=round(price,.01);
MPRINT(READMASTSCAN):   b_price=b_price/100;
MPRINT(READMASTSCAN):  b_price=round(b_price,.01);
MPRINT(READMASTSCAN):   EAN=put(sys,z2.)||put(gen,z2.)||put(vendor,z5.)||put(item,z5.);
MPRINT(READMASTSCAN):   value=price*units;
MPRINT(READMASTSCAN):   period=week;
MPRINT(READMASTSCAN):   output;
MPRINT(READMASTSCAN):   drop sys gen vendor item;
MPRINT(READMASTSCAN):   packtype="";
MPRINT(READMASTSCAN):   packyype="";
MPRINT(READMASTSCAN):   drop packtype packyype;
MPRINT(READMASTSCAN):   run;

NOTE: The infile INP is:
      Filename=/start/allprod/week0867,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Wed Feb 28 12:03:01 2018,
      File Size (bytes)=448099300

NOTE: 8147260 records were read from the infile INP.
NOTE: The data set WORK.MASTSCAN0867 has 8147260 observations and 20 variables.
NOTE: Compressing data set WORK.MASTSCAN0867 decreased size by 44.82 percent. 
      Compressed is 46347 pages; un-compressed would require 83993 pages.
NOTE: DATA statement used (Total process time):
      real time           56.73 seconds
      cpu time            54.79 seconds
      

MPRINT(READMASTSCAN):   libname mastlib clear;
NOTE: Libref MASTLIB has been deassigned.
USER-NOTE: File (week0867) imported
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   proc sql;
MPRINT(READINPUTS):   create table _mastscan0867(drop=_ean) as select b.*, a.* from code(rename=ean=_ean) a, mastscan0867 b where b.ean=a._ean;
NOTE: Compressing data set WORK._MASTSCAN0867 decreased size by 46.33 percent. 
      Compressed is 424 pages; un-compressed would require 790 pages.
NOTE: Table WORK._MASTSCAN0867 created, with 61545 rows and 25 columns.

MPRINT(READINPUTS):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.12 seconds
      cpu time            8.11 seconds
      

MPRINT(READINPUTS):   proc append data=_mastscan0867 base=mastscan;
MPRINT(READINPUTS):   run;

NOTE: Appending WORK._MASTSCAN0867 to WORK.MASTSCAN.
NOTE: BASE data set does not exist. DATA file is being copied to BASE file.
NOTE: There were 61545 observations read from the data set WORK._MASTSCAN0867.
NOTE: The data set WORK.MASTSCAN has 61545 observations and 25 variables.
NOTE: Compressing data set WORK.MASTSCAN decreased size by 46.33 percent. 
      Compressed is 424 pages; un-compressed would require 790 pages.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.19 seconds
      cpu time            0.19 seconds
      

MPRINT(READINPUTS):   proc delete data=_mastscan0867;
MPRINT(READINPUTS):   run;

NOTE: Deleting WORK._MASTSCAN0867 (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READMASTSCAN):   libname mastlib "/start/allprod";
NOTE: Libref MASTLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /start/allprod
MPRINT(READMASTSCAN):   filename inp "/start/allprod/week0868";
MPRINT(READMASTSCAN):   data mastscan0868;
MPRINT(READMASTSCAN):   infile inp recfm=f lrecl=55;
MPRINT(READMASTSCAN):   input @1 sys ib2. @3 gen ib2. @5 vendor ib4. @9 item ib4. @13 store ib4. @17 week ib2. @21 price rb4. @25 units rb4. @29 feat1 pib1. @29 feat bits1.7 @29 bund bits1.6 @29 infeat bits1.5 @30 instore pib1. @31 disp1 pib1. @31 disp 
bits1.7 @31 dispend bits1.6 @33 b_units rb4. @37 b_price rb4. @43 keycat ib2. @45 packyype $2. @47 numfac rb4. @51 lenfac rb4. ;
MPRINT(READMASTSCAN):   units=units/100;
MPRINT(READMASTSCAN):   price=price/100;
MPRINT(READMASTSCAN):  price=round(price,.01);
MPRINT(READMASTSCAN):   b_price=b_price/100;
MPRINT(READMASTSCAN):  b_price=round(b_price,.01);
MPRINT(READMASTSCAN):   EAN=put(sys,z2.)||put(gen,z2.)||put(vendor,z5.)||put(item,z5.);
MPRINT(READMASTSCAN):   value=price*units;
MPRINT(READMASTSCAN):   period=week;
MPRINT(READMASTSCAN):   output;
MPRINT(READMASTSCAN):   drop sys gen vendor item;
MPRINT(READMASTSCAN):   packtype="";
MPRINT(READMASTSCAN):   packyype="";
MPRINT(READMASTSCAN):   drop packtype packyype;
MPRINT(READMASTSCAN):   run;

NOTE: The infile INP is:
      Filename=/start/allprod/week0868,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Wed Feb 28 12:04:13 2018,
      File Size (bytes)=430502985

NOTE: 7827327 records were read from the infile INP.
NOTE: The data set WORK.MASTSCAN0868 has 7827327 observations and 20 variables.
NOTE: Compressing data set WORK.MASTSCAN0868 decreased size by 44.77 percent. 
      Compressed is 44567 pages; un-compressed would require 80695 pages.
NOTE: DATA statement used (Total process time):
      real time           54.82 seconds
      cpu time            54.50 seconds
      

MPRINT(READMASTSCAN):   libname mastlib clear;
NOTE: Libref MASTLIB has been deassigned.
USER-NOTE: File (week0868) imported
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   proc sql;
MPRINT(READINPUTS):   create table _mastscan0868(drop=_ean) as select b.*, a.* from code(rename=ean=_ean) a, mastscan0868 b where b.ean=a._ean;
NOTE: Compressing data set WORK._MASTSCAN0868 decreased size by 46.37 percent. 
      Compressed is 399 pages; un-compressed would require 744 pages.
NOTE: Table WORK._MASTSCAN0868 created, with 57946 rows and 25 columns.

MPRINT(READINPUTS):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.99 seconds
      cpu time            7.98 seconds
      

MPRINT(READINPUTS):   proc append data=_mastscan0868 base=mastscan;
MPRINT(READINPUTS):   run;

NOTE: Appending WORK._MASTSCAN0868 to WORK.MASTSCAN.
NOTE: There were 57946 observations read from the data set WORK._MASTSCAN0868.
NOTE: 57946 observations added.
NOTE: The data set WORK.MASTSCAN has 119491 observations and 25 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.17 seconds
      cpu time            0.17 seconds
      

MPRINT(READINPUTS):   proc delete data=_mastscan0868;
MPRINT(READINPUTS):   run;

NOTE: Deleting WORK._MASTSCAN0868 (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READMASTSCAN):   libname mastlib "/start/allprod";
NOTE: Libref MASTLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /start/allprod
MPRINT(READMASTSCAN):   filename inp "/start/allprod/week0869";
MPRINT(READMASTSCAN):   data mastscan0869;
MPRINT(READMASTSCAN):   infile inp recfm=f lrecl=55;
MPRINT(READMASTSCAN):   input @1 sys ib2. @3 gen ib2. @5 vendor ib4. @9 item ib4. @13 store ib4. @17 week ib2. @21 price rb4. @25 units rb4. @29 feat1 pib1. @29 feat bits1.7 @29 bund bits1.6 @29 infeat bits1.5 @30 instore pib1. @31 disp1 pib1. @31 disp 
bits1.7 @31 dispend bits1.6 @33 b_units rb4. @37 b_price rb4. @43 keycat ib2. @45 packyype $2. @47 numfac rb4. @51 lenfac rb4. ;
MPRINT(READMASTSCAN):   units=units/100;
MPRINT(READMASTSCAN):   price=price/100;
MPRINT(READMASTSCAN):  price=round(price,.01);
MPRINT(READMASTSCAN):   b_price=b_price/100;
MPRINT(READMASTSCAN):  b_price=round(b_price,.01);
MPRINT(READMASTSCAN):   EAN=put(sys,z2.)||put(gen,z2.)||put(vendor,z5.)||put(item,z5.);
MPRINT(READMASTSCAN):   value=price*units;
MPRINT(READMASTSCAN):   period=week;
MPRINT(READMASTSCAN):   output;
MPRINT(READMASTSCAN):   drop sys gen vendor item;
MPRINT(READMASTSCAN):   packtype="";
MPRINT(READMASTSCAN):   packyype="";
MPRINT(READMASTSCAN):   drop packtype packyype;
MPRINT(READMASTSCAN):   run;

NOTE: The infile INP is:
      Filename=/start/allprod/week0869,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Wed Feb 28 12:05:30 2018,
      File Size (bytes)=473781605

NOTE: 8614211 records were read from the infile INP.
NOTE: Missing values were generated as a result of performing an operation on missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      23 at 5103:197   23 at 5103:208   23 at 5103:150   
NOTE: The data set WORK.MASTSCAN0869 has 8614211 observations and 20 variables.
NOTE: Compressing data set WORK.MASTSCAN0869 decreased size by 43.58 percent. 
      Compressed is 50107 pages; un-compressed would require 88807 pages.
NOTE: DATA statement used (Total process time):
      real time           1:01.93
      cpu time            1:00.27
      

MPRINT(READMASTSCAN):   libname mastlib clear;
NOTE: Libref MASTLIB has been deassigned.
USER-NOTE: File (week0869) imported
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   proc sql;
MPRINT(READINPUTS):   create table _mastscan0869(drop=_ean) as select b.*, a.* from code(rename=ean=_ean) a, mastscan0869 b where b.ean=a._ean;
NOTE: Compressing data set WORK._MASTSCAN0869 decreased size by 45.26 percent. 
      Compressed is 468 pages; un-compressed would require 855 pages.
NOTE: Table WORK._MASTSCAN0869 created, with 66631 rows and 25 columns.

MPRINT(READINPUTS):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.77 seconds
      cpu time            8.75 seconds
      

MPRINT(READINPUTS):   proc append data=_mastscan0869 base=mastscan;
MPRINT(READINPUTS):   run;

NOTE: Appending WORK._MASTSCAN0869 to WORK.MASTSCAN.
NOTE: There were 66631 observations read from the data set WORK._MASTSCAN0869.
NOTE: 66631 observations added.
NOTE: The data set WORK.MASTSCAN has 186122 observations and 25 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.23 seconds
      cpu time            0.22 seconds
      

MPRINT(READINPUTS):   proc delete data=_mastscan0869;
MPRINT(READINPUTS):   run;

NOTE: Deleting WORK._MASTSCAN0869 (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READMASTSCAN):   libname mastlib "/start/allprod";
NOTE: Libref MASTLIB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /start/allprod
MPRINT(READMASTSCAN):   filename inp "/start/allprod/week0870";
MPRINT(READMASTSCAN):   data mastscan0870;
MPRINT(READMASTSCAN):   infile inp recfm=f lrecl=55;
MPRINT(READMASTSCAN):   input @1 sys ib2. @3 gen ib2. @5 vendor ib4. @9 item ib4. @13 store ib4. @17 week ib2. @21 price rb4. @25 units rb4. @29 feat1 pib1. @29 feat bits1.7 @29 bund bits1.6 @29 infeat bits1.5 @30 instore pib1. @31 disp1 pib1. @31 disp 
bits1.7 @31 dispend bits1.6 @33 b_units rb4. @37 b_price rb4. @43 keycat ib2. @45 packyype $2. @47 numfac rb4. @51 lenfac rb4. ;
MPRINT(READMASTSCAN):   units=units/100;
MPRINT(READMASTSCAN):   price=price/100;
MPRINT(READMASTSCAN):  price=round(price,.01);
MPRINT(READMASTSCAN):   b_price=b_price/100;
MPRINT(READMASTSCAN):  b_price=round(b_price,.01);
MPRINT(READMASTSCAN):   EAN=put(sys,z2.)||put(gen,z2.)||put(vendor,z5.)||put(item,z5.);
MPRINT(READMASTSCAN):   value=price*units;
MPRINT(READMASTSCAN):   period=week;
MPRINT(READMASTSCAN):   output;
MPRINT(READMASTSCAN):   drop sys gen vendor item;
MPRINT(READMASTSCAN):   packtype="";
MPRINT(READMASTSCAN):   packyype="";
MPRINT(READMASTSCAN):   drop packtype packyype;
MPRINT(READMASTSCAN):   run;

NOTE: The infile INP is:
      Filename=/start/allprod/week0870,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Wed Feb 28 12:06:54 2018,
      File Size (bytes)=453784980

NOTE: 8250636 records were read from the infile INP.
NOTE: The data set WORK.MASTSCAN0870 has 8250636 observations and 20 variables.
NOTE: Compressing data set WORK.MASTSCAN0870 decreased size by 44.74 percent. 
      Compressed is 47002 pages; un-compressed would require 85059 pages.
NOTE: DATA statement used (Total process time):
      real time           59.07 seconds
      cpu time            58.64 seconds
      

MPRINT(READMASTSCAN):   libname mastlib clear;
NOTE: Libref MASTLIB has been deassigned.
USER-NOTE: File (week0870) imported
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   proc sql;
MPRINT(READINPUTS):   create table _mastscan0870(drop=_ean) as select b.*, a.* from code(rename=ean=_ean) a, mastscan0870 b where b.ean=a._ean;
NOTE: Compressing data set WORK._MASTSCAN0870 decreased size by 46.37 percent. 
      Compressed is 443 pages; un-compressed would require 826 pages.
NOTE: Table WORK._MASTSCAN0870 created, with 64335 rows and 25 columns.

MPRINT(READINPUTS):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           9.65 seconds
      cpu time            9.37 seconds
      

MPRINT(READINPUTS):   proc append data=_mastscan0870 base=mastscan;
MPRINT(READINPUTS):   run;

NOTE: Appending WORK._MASTSCAN0870 to WORK.MASTSCAN.
NOTE: There were 64335 observations read from the data set WORK._MASTSCAN0870.
NOTE: 64335 observations added.
NOTE: The data set WORK.MASTSCAN has 250457 observations and 25 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.21 seconds
      cpu time            0.21 seconds
      

MPRINT(READINPUTS):   proc delete data=_mastscan0870;
MPRINT(READINPUTS):   run;

NOTE: Deleting WORK._MASTSCAN0870 (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(READINPUTS):   data mastscan;
MPRINT(READINPUTS):   set mastscan;
MPRINT(READINPUTS):   period=0128;
MPRINT(READINPUTS):   run;

NOTE: There were 250457 observations read from the data set WORK.MASTSCAN.
NOTE: The data set WORK.MASTSCAN has 250457 observations and 25 variables.
NOTE: Compressing data set WORK.MASTSCAN decreased size by 46.61 percent. 
      Compressed is 1715 pages; un-compressed would require 3212 pages.
NOTE: DATA statement used (Total process time):
      real time           0.95 seconds
      cpu time            0.94 seconds
      

MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):  ********************************************************;
MPRINT(READINPUTS):  * READGEOG.SAS: This macro will read the geography *;
MPRINT(READINPUTS):   * hierarchy file and create two data *;
MPRINT(READINPUTS):   * set gcode scode which will be separ- *;
MPRINT(READINPUTS):   * ately merged with the move data. *;
MPRINT(READINPUTS):   * Rich Rooney 02/10/02 *;
MPRINT(READINPUTS):   ********************************************************;
MPRINT(READGEOG):   data gcode(keep=g1-g3) scode(keep=s1-s4);
MPRINT(READGEOG):   length s1 $2. s2 $2. s3 $2. s4 $2. g1 $2. g2 $2. g3 $2.;
MPRINT(READGEOG):   infile "/data/prod/transition/audit/data/bschfrvNI.geo" delimiter="," missover;
MPRINT(READGEOG):   input s1 $ s2 $ s3 $ s4 $ g1 $ g2 $ g3 $ ;
MPRINT(READGEOG):   if length(trim(left(s1)))=1 then s1="0"!!trim(left(s1));
MPRINT(READGEOG):   if length(trim(left(s2)))=1 then s2="0"!!trim(left(s2));
MPRINT(READGEOG):   if length(trim(left(s3)))=1 then s3="0"!!trim(left(s3));
MPRINT(READGEOG):   if length(trim(left(s4)))=1 then s4="0"!!trim(left(s4));
MPRINT(READGEOG):   if length(trim(left(g1)))=1 then g1="0"!!trim(left(g1));
MPRINT(READGEOG):   if length(trim(left(g2)))=1 then g2="0"!!trim(left(g2));
MPRINT(READGEOG):   if length(trim(left(g3)))=1 then g3="0"!!trim(left(g3));
MPRINT(READGEOG):   run;

NOTE: Compression was disabled for data set WORK.GCODE because compression overhead would increase the size of the data set.
NOTE: Compression was disabled for data set WORK.SCODE because compression overhead would increase the size of the data set.
NOTE: The infile "/data/prod/transition/audit/data/bschfrvNI.geo" is:
      Filename=/data/prod/transition/audit/data/bschfrvNI.geo,
      Owner Name=prod,Group Name=users,
      Access Permission=rwxrwxrwx,
      Last Modified=Thu Mar 23 16:38:49 2017,
      File Size (bytes)=925

NOTE: 45 records were read from the infile "/data/prod/transition/audit/data/bschfrvNI.geo".
      The minimum record length was 0.
      The maximum record length was 20.
NOTE: The data set WORK.GCODE has 45 observations and 3 variables.
NOTE: The data set WORK.SCODE has 45 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/data/bschfrvNI.geo) imported
MPRINT(READGEOG):   proc sort data=gcode nodupkey;
MPRINT(READGEOG):   by g1-g3;
MPRINT(READGEOG):   run;

NOTE: There were 45 observations read from the data set WORK.GCODE.
NOTE: 33 observations with duplicate key values were deleted.
NOTE: The data set WORK.GCODE has 12 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READGEOG):   proc sort data=scode nodupkey;
MPRINT(READGEOG):   by s1-s4;
MPRINT(READGEOG):   run;

NOTE: There were 45 observations read from the data set WORK.SCODE.
NOTE: 40 observations with duplicate key values were deleted.
NOTE: The data set WORK.SCODE has 5 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):  *******************************************************************;
MPRINT(READINPUTS):  * READSTORE.SAS: This macro will read the Integrated Store Master *;
MPRINT(READINPUTS):   * *;
MPRINT(READINPUTS):   * Simon Poole 03/26/03 *;
MPRINT(READINPUTS):   * A.Agostinelli 26/08/2003 *;
MPRINT(READINPUTS):   *******************************************************************;
MPRINT(READSTORE):   data store;
MPRINT(READSTORE):   infile "/data/prod/transition/audit/data/store" missover;
MPRINT(READSTORE):   input @1 store2 $5. @6 retstore 5. @11 storname $30. @41 chain $20. @61 address $30. @91 phone $12. @103 firstwk 4. @107 lastwk 4. @111 numcheck 3. @114 sqrmtr 6. @120 chainid $3. @123 formater 3. @126 storetype $1. @128 servicei $2. ;
MPRINT(READSTORE):   store=input(store2,5.);
MPRINT(READSTORE):   drop store2;
MPRINT(READSTORE):   if servicei in ('IP','IO','ip','io');
MPRINT(READSTORE):   output;
MPRINT(READSTORE):   run;

NOTE: The infile "/data/prod/transition/audit/data/store" is:
      Filename=/data/prod/transition/audit/data/store,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Wed Aug  8 15:22:49 2018,
      File Size (bytes)=1072760

NOTE: 8252 records were read from the infile "/data/prod/transition/audit/data/store".
      The minimum record length was 129.
      The maximum record length was 129.
NOTE: The data set WORK.STORE has 4357 observations and 14 variables.
NOTE: Compressing data set WORK.STORE decreased size by 37.50 percent. 
      Compressed is 55 pages; un-compressed would require 88 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

USER-NOTE: File (/data/prod/transition/audit/data/store) imported
MPRINT(READINPUTS):  ;
MPRINT(READINPUTS):   data store;
MPRINT(READINPUTS):   set store;
MPRINT(READINPUTS):   keep store sqrmtr storetype;
MPRINT(READINPUTS):   run;
NOTE: Compression was disabled for data set WORK.STORE because compression overhead would increase the size of the data set.
NOTE: There were 4357 observations read from the data set WORK.STORE.
NOTE: The data set WORK.STORE has 4357 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READINPUTS):  *****************************************************************;
MPRINT(READINPUTS):  * READCATMAX.SAS: This macro will read the .max *;
MPRINT(READINPUTS):   * geog vs store type file *;
MPRINT(READINPUTS):   * Simon Poole 03/26/03 *;
MPRINT(READINPUTS):   *****************************************************************;
MPRINT(READCATMAX):   data catmax;
MPRINT(READCATMAX):   length g1 s1 $2.;
MPRINT(READCATMAX):   infile "/data/prod/transition/audit/data/bschfrvNI.max" recfm=v delimiter=',' missover;
MPRINT(READCATMAX):   input g1 $ s1 $;
MPRINT(READCATMAX):   if length(trim(left(g1)))=1 then g1="0"!!trim(left(g1));
MPRINT(READCATMAX):   if length(trim(left(s1)))=1 then s1="0"!!trim(left(s1));
MPRINT(READCATMAX):   run;

NOTE: Compression was disabled for data set WORK.CATMAX because compression overhead would increase the size of the data set.
NOTE: The infile "/data/prod/transition/audit/data/bschfrvNI.max" is:
      Filename=/data/prod/transition/audit/data/bschfrvNI.max,
      Owner Name=prod,Group Name=users,
      Access Permission=rwxrwxrwx,
      Last Modified=Thu Mar 23 16:38:49 2017,
      File Size (bytes)=18

NOTE: 3 records were read from the infile "/data/prod/transition/audit/data/bschfrvNI.max".
      The minimum record length was 5.
      The maximum record length was 5.
NOTE: The data set WORK.CATMAX has 3 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/data/bschfrvNI.max) imported
MPRINT(READCATMAX):   proc sort;
MPRINT(READCATMAX):   by g1 s1;
MPRINT(READCATMAX):   run;

NOTE: There were 3 observations read from the data set WORK.CATMAX.
NOTE: The data set WORK.CATMAX has 3 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READINPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READINPUTS):  ;
MPRINT(MAIN):  ;
MPRINT(SORTEM):   proc sort data=mastscan;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 250457 observations read from the data set WORK.MASTSCAN.
NOTE: The data set WORK.MASTSCAN has 250457 observations and 25 variables.
NOTE: Compressing data set WORK.MASTSCAN decreased size by 46.61 percent. 
      Compressed is 1715 pages; un-compressed would require 3212 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           1.21 seconds
      cpu time            1.20 seconds
      

MPRINT(SUBSETMASTER):  ;
MPRINT(MATCHMERGE):   data master ;
MPRINT(MATCHMERGE):   merge mastscan (in=a) code (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 250457 observations read from the data set WORK.MASTSCAN.
NOTE: There were 1000 observations read from the data set WORK.CODE.
NOTE: The data set WORK.MASTER has 250457 observations and 25 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 46.61 percent. 
      Compressed is 1715 pages; un-compressed would require 3212 pages.
NOTE: DATA statement used (Total process time):
      real time           1.04 seconds
      cpu time            1.05 seconds
      

MPRINT(SUBSETMASTER):  ;
MPRINT(SUBSETMASTER):  *************************************************************************************************************************;
MPRINT(SUBSETMASTER):  * APPLY_UNB.SAS ;
MPRINT(SUBSETMASTER):   * This program controls and apply the unbundling settings within the aggregation program. ;
MPRINT(SUBSETMASTER):   * This program MUST run before matching ITEMMAST and MASTSCAN ds ;
MPRINT(SUBSETMASTER):   * This program MUST run on MASTSCAN after having merged it with ITEMMAST ;
MPRINT(SUBSETMASTER):   * Data flow: ;
MPRINT(SUBSETMASTER):   * - check the production flag for undundling: if 'Y/YES' then proceed, else exit without error. ;
MPRINT(SUBSETMASTER):   * - check the existence of [category].unb file: if 'OK' proceed, else exit with error and stop processing aggregation ;
MPRINT(SUBSETMASTER):   * - read [category].unb file ;
MPRINT(SUBSETMASTER):   * - merge [category].unb file with ITEMMAST and update volume attrib. for matching EANs (NOT WORKING UNTIL USAGE OF COUNT;
MPRINT(SUBSETMASTER):   * - merge [category].unb file with MASTSCAN and update price, b_price, value for matching EANs ;
MPRINT(SUBSETMASTER):   * - exit ;
MPRINT(SUBSETMASTER):   * ;
MPRINT(SUBSETMASTER):   * CREATION Author ;
MPRINT(SUBSETMASTER):   * 2003.09.25 A.Agostinelli ;
MPRINT(SUBSETMASTER):   * UPDATE Author description ;
MPRINT(SUBSETMASTER):   * 2003.10.02 A.Agostinelli exclude ;
MPRINT(SUBSETMASTER):   *************************************************************************************************************************;
MPRINT(APPLY_UNB):   run;
MPRINT(SUBSETMASTER):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(SUBSETMASTER):  ;
MPRINT(DATAPREPARATION):  ;
MPRINT(SORTEM):   proc sort data=proj;
MPRINT(SORTEM):   by store;
MPRINT(SORTEM):   run;

NOTE: There were 5405 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJ has 5405 observations and 5 variables.
NOTE: Compressing data set WORK.PROJ increased size by 40.91 percent. 
      Compressed is 31 pages; un-compressed would require 22 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(SORTEM):   proc sort data=store nodupkey;
MPRINT(SORTEM):   by store;
MPRINT(SORTEM):   run;

NOTE: There were 4357 observations read from the data set WORK.STORE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.STORE has 4357 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(MATCHMERGE):   data proj ;
MPRINT(MATCHMERGE):   merge proj (in=a) store (in=b) ;
MPRINT(MATCHMERGE):   by store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 5405 observations read from the data set WORK.PROJ.
NOTE: There were 4357 observations read from the data set WORK.STORE.
NOTE: The data set WORK.PROJ has 5405 observations and 7 variables.
NOTE: Compressing data set WORK.PROJ increased size by 29.63 percent. 
      Compressed is 35 pages; un-compressed would require 27 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(SORTEM):   proc sort data=proj;
MPRINT(SORTEM):   by g1;
MPRINT(SORTEM):   run;

NOTE: There were 5405 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJ has 5405 observations and 7 variables.
NOTE: Compressing data set WORK.PROJ increased size by 29.63 percent. 
      Compressed is 35 pages; un-compressed would require 27 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.03 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(SORTEM):   proc sort data=gcode;
MPRINT(SORTEM):   by g1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(MATCHMERGE):   data proj ;
MPRINT(MATCHMERGE):   merge proj (in=a) gcode (in=b) ;
MPRINT(MATCHMERGE):   by g1 ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 5405 observations read from the data set WORK.PROJ.
NOTE: There were 12 observations read from the data set WORK.GCODE.
NOTE: The data set WORK.PROJ has 5405 observations and 9 variables.
NOTE: Compressing data set WORK.PROJ increased size by 15.15 percent. 
      Compressed is 38 pages; un-compressed would require 33 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(SORTEM):   proc sort data=proj;
MPRINT(SORTEM):   by s1;
MPRINT(SORTEM):   run;

NOTE: There were 5405 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJ has 5405 observations and 9 variables.
NOTE: Compressing data set WORK.PROJ increased size by 15.15 percent. 
      Compressed is 38 pages; un-compressed would require 33 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(SORTEM):   proc sort data=scode;
MPRINT(SORTEM):   by s1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(MATCHMERGE):   data proj ;
MPRINT(MATCHMERGE):   merge proj (in=a) scode (in=b) ;
MPRINT(MATCHMERGE):   by s1 ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 5405 observations read from the data set WORK.PROJ.
NOTE: There were 5 observations read from the data set WORK.SCODE.
NOTE: The data set WORK.PROJ has 152 observations and 12 variables.
NOTE: Compressing data set WORK.PROJ increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(MERGEPROJ):   data proj;
MPRINT(MERGEPROJ):   set proj;
MPRINT(MERGEPROJ):   minfactor=factor;
MPRINT(MERGEPROJ):   run;

NOTE: There were 152 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJ has 152 observations and 13 variables.
NOTE: Compressing data set WORK.PROJ increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGEPROJ):   data projs;
MPRINT(MERGEPROJ):   set proj;
MPRINT(MERGEPROJ):   run;

NOTE: There were 152 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJS has 152 observations and 13 variables.
NOTE: Compressing data set WORK.PROJS increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(SORTEM):   proc sort data=proj;
MPRINT(SORTEM):   by g1 s1 week;
MPRINT(SORTEM):   run;

NOTE: There were 152 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJ has 152 observations and 13 variables.
NOTE: Compressing data set WORK.PROJ increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(MERGEPROJ):  ;
MPRINT(MERGEPROJ):   data proj;
MPRINT(MERGEPROJ):   set proj;
MPRINT(MERGEPROJ):   rename s1=st1 s2=st2 s3=st3 s4=st4 g1=gc1 g2=gc2 g3=gc3;
MPRINT(MERGEPROJ):   numult=minfactor;
MPRINT(MERGEPROJ):   drop minfactor;
MPRINT(MERGEPROJ):   run;

NOTE: There were 152 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJ has 152 observations and 13 variables.
NOTE: Compressing data set WORK.PROJ increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGEPROJ):   data proj;
MPRINT(MERGEPROJ):   set proj;
MPRINT(MERGEPROJ):   s1=st1 ;
MPRINT(MERGEPROJ):   g1=gc1 ;
MPRINT(MERGEPROJ):   drop gc1 st1;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st2 ;
MPRINT(MERGEPROJ):   g1=gc1 ;
MPRINT(MERGEPROJ):   drop gc1 st2;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st3 ;
MPRINT(MERGEPROJ):   g1=gc1 ;
MPRINT(MERGEPROJ):   drop gc1 st3;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st4 ;
MPRINT(MERGEPROJ):   g1=gc1 ;
MPRINT(MERGEPROJ):   drop gc1 st4;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st1 ;
MPRINT(MERGEPROJ):   g1=gc2 ;
MPRINT(MERGEPROJ):   drop gc2 st1;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st2 ;
MPRINT(MERGEPROJ):   g1=gc2 ;
MPRINT(MERGEPROJ):   drop gc2 st2;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st3 ;
MPRINT(MERGEPROJ):   g1=gc2 ;
MPRINT(MERGEPROJ):   drop gc2 st3;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st4 ;
MPRINT(MERGEPROJ):   g1=gc2 ;
MPRINT(MERGEPROJ):   drop gc2 st4;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st1 ;
MPRINT(MERGEPROJ):   g1=gc3 ;
MPRINT(MERGEPROJ):   drop gc3 st1;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st2 ;
MPRINT(MERGEPROJ):   g1=gc3 ;
MPRINT(MERGEPROJ):   drop gc3 st2;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st3 ;
MPRINT(MERGEPROJ):   g1=gc3 ;
MPRINT(MERGEPROJ):   drop gc3 st3;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   s1=st4 ;
MPRINT(MERGEPROJ):   g1=gc3 ;
MPRINT(MERGEPROJ):   drop gc3 st4;
MPRINT(MERGEPROJ):   output;

NOTE: There were 152 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJ has 1824 observations and 8 variables.
NOTE: Compressing data set WORK.PROJ increased size by 16.67 percent. 
      Compressed is 14 pages; un-compressed would require 12 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGEPROJ):   proc sort;
MPRINT(MERGEPROJ):  by g1 s1 week ;

NOTE: There were 1824 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJ has 1824 observations and 8 variables.
NOTE: Compressing data set WORK.PROJ increased size by 16.67 percent. 
      Compressed is 14 pages; un-compressed would require 12 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGEPROJ):   data projsum;
MPRINT(MERGEPROJ):   set proj;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   week=0;
MPRINT(MERGEPROJ):   output;
MPRINT(MERGEPROJ):   keep g1 s1 week store numult;
MPRINT(MERGEPROJ):   run;

NOTE: There were 1824 observations read from the data set WORK.PROJ.
NOTE: The data set WORK.PROJSUM has 3648 observations and 5 variables.
NOTE: Compressing data set WORK.PROJSUM increased size by 40.00 percent. 
      Compressed is 21 pages; un-compressed would require 15 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGEPROJ):   proc summary data=projsum sum nway;
MPRINT(MERGEPROJ):   class g1 s1 week store ;
MPRINT(MERGEPROJ):   var numult;
MPRINT(MERGEPROJ):   output out=projsum(drop=_type_ _freq_) min=numult;
MPRINT(MERGEPROJ):   run;

NOTE: There were 3648 observations read from the data set WORK.PROJSUM.
NOTE: The data set WORK.PROJSUM has 2280 observations and 5 variables.
NOTE: Compressing data set WORK.PROJSUM increased size by 40.00 percent. 
      Compressed is 14 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.04 seconds
      cpu time            0.06 seconds
      

MPRINT(MERGEPROJ):   proc summary data=projsum sum nway;
MPRINT(MERGEPROJ):   class g1 s1 week ;
MPRINT(MERGEPROJ):   var numult;
MPRINT(MERGEPROJ):   output out=numdenom(drop=_type_ _freq_) sum=regfact;
MPRINT(MERGEPROJ):   run;

NOTE: Compression was disabled for data set WORK.NUMDENOM because compression overhead would increase the size of the data set.
NOTE: There were 2280 observations read from the data set WORK.PROJSUM.
NOTE: The data set WORK.NUMDENOM has 120 observations and 4 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

MPRINT(MERGEPROJ):   run;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(MERGEPROJ):  ;
MPRINT(DATAPREPARATION):  ;
MPRINT(SORTEM):   proc sort data=master;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 250457 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 250457 observations and 25 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 46.61 percent. 
      Compressed is 1715 pages; un-compressed would require 3212 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           1.21 seconds
      cpu time            1.20 seconds
      

MPRINT(MERGMAST):  ;
MPRINT(SORTEM):   proc sort data=item;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 955 observations read from the data set WORK.ITEM.
NOTE: The data set WORK.ITEM has 955 observations and 9 variables.
NOTE: Compressing data set WORK.ITEM decreased size by 0.00 percent. 
      Compressed is 9 pages; un-compressed would require 9 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGMAST):  ;
MPRINT(MATCHMERGE):   data master ;
MPRINT(MATCHMERGE):   merge master (in=a) item (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 250457 observations read from the data set WORK.MASTER.
NOTE: There were 955 observations read from the data set WORK.ITEM.
NOTE: The data set WORK.MASTER has 250457 observations and 32 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 50.08 percent. 
      Compressed is 1985 pages; un-compressed would require 3976 pages.
NOTE: DATA statement used (Total process time):
      real time           1.25 seconds
      cpu time            1.25 seconds
      

MPRINT(MERGMAST):  ;
MPRINT(SORTEM):   proc sort data=master;
MPRINT(SORTEM):   by week store;
MPRINT(SORTEM):   run;

NOTE: There were 250457 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 250457 observations and 32 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 50.08 percent. 
      Compressed is 1985 pages; un-compressed would require 3976 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           1.48 seconds
      cpu time            1.40 seconds
      

MPRINT(MERGMAST):  ;
MPRINT(SORTEM):   proc sort data=projs;
MPRINT(SORTEM):   by week store;
MPRINT(SORTEM):   run;

NOTE: There were 152 observations read from the data set WORK.PROJS.
NOTE: The data set WORK.PROJS has 152 observations and 13 variables.
NOTE: Compressing data set WORK.PROJS increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGMAST):  ;
MPRINT(MATCHMERGE):   data master ;
MPRINT(MATCHMERGE):   merge master (in=a) projs (in=b) ;
MPRINT(MATCHMERGE):   by week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 250457 observations read from the data set WORK.MASTER.
NOTE: There were 152 observations read from the data set WORK.PROJS.
NOTE: The data set WORK.MASTER has 4866 observations and 43 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 44.94 percent. 
      Compressed is 49 pages; un-compressed would require 89 pages.
NOTE: DATA statement used (Total process time):
      real time           0.70 seconds
      cpu time            0.65 seconds
      

MPRINT(MERGMAST):  ;
MPRINT(MERGMAST):  ;
MPRINT(MERGMAST):  run;
MPRINT(SORTEM):   proc sort data=master;
MPRINT(SORTEM):   by g1 s1 week;
MPRINT(SORTEM):   run;

NOTE: There were 4866 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 4866 observations and 43 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 44.94 percent. 
      Compressed is 49 pages; un-compressed would require 89 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.04 seconds
      cpu time            0.02 seconds
      

MPRINT(MERGMAST):  ;
MPRINT(MERGMAST):   data master;
MPRINT(MERGMAST):   set master;
MPRINT(MERGMAST):   rename s1=st1 s2=st2 s3=st3 s4=st4 g1=gc1 g2=gc2 g3=gc3;
MPRINT(MERGMAST):   run;

NOTE: There were 4866 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 4866 observations and 43 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 44.94 percent. 
      Compressed is 49 pages; un-compressed would require 89 pages.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.03 seconds
      

MPRINT(MERGMAST):   data master;
MPRINT(MERGMAST):   set master;
MPRINT(MERGMAST):   g1=gc1 ;
MPRINT(MERGMAST):   s1=st1 ;
MPRINT(MERGMAST):   drop gc1 st1;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc1 ;
MPRINT(MERGMAST):   s1=st2 ;
MPRINT(MERGMAST):   drop gc1 st2;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc1 ;
MPRINT(MERGMAST):   s1=st3 ;
MPRINT(MERGMAST):   drop gc1 st3;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc1 ;
MPRINT(MERGMAST):   s1=st4 ;
MPRINT(MERGMAST):   drop gc1 st4;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc2 ;
MPRINT(MERGMAST):   s1=st1 ;
MPRINT(MERGMAST):   drop gc2 st1;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc2 ;
MPRINT(MERGMAST):   s1=st2 ;
MPRINT(MERGMAST):   drop gc2 st2;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc2 ;
MPRINT(MERGMAST):   s1=st3 ;
MPRINT(MERGMAST):   drop gc2 st3;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc2 ;
MPRINT(MERGMAST):   s1=st4 ;
MPRINT(MERGMAST):   drop gc2 st4;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc3 ;
MPRINT(MERGMAST):   s1=st1 ;
MPRINT(MERGMAST):   drop gc3 st1;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc3 ;
MPRINT(MERGMAST):   s1=st2 ;
MPRINT(MERGMAST):   drop gc3 st2;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc3 ;
MPRINT(MERGMAST):   s1=st3 ;
MPRINT(MERGMAST):   drop gc3 st3;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   g1=gc3 ;
MPRINT(MERGMAST):   s1=st4 ;
MPRINT(MERGMAST):   drop gc3 st4;
MPRINT(MERGMAST):   output;
MPRINT(MERGMAST):   run;

NOTE: There were 4866 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 58392 observations and 38 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 48.95 percent. 
      Compressed is 533 pages; un-compressed would require 1044 pages.
NOTE: DATA statement used (Total process time):
      real time           0.18 seconds
      cpu time            0.17 seconds
      

MPRINT(MERGMAST):   proc sort data=master;
MPRINT(MERGMAST):   by g1 s1;
MPRINT(MERGMAST):   run;

NOTE: There were 58392 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 58392 observations and 38 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 48.95 percent. 
      Compressed is 533 pages; un-compressed would require 1044 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.35 seconds
      cpu time            0.33 seconds
      

MPRINT(MERGMAST):   data master;
MPRINT(MERGMAST):   merge master(in=a1) catmax(in=a2 keep=g1 s1);
MPRINT(MERGMAST):   by g1 s1;
MPRINT(MERGMAST):   if a1 and a2;
MPRINT(MERGMAST):   if packtype in ('BD' 'BS' 'EF' 'PO') then spack =1;
MPRINT(MERGMAST):   else spack =0;
MPRINT(MERGMAST):   drop packtype;
MPRINT(MERGMAST):   run;

NOTE: There were 58392 observations read from the data set WORK.MASTER.
NOTE: There were 3 observations read from the data set WORK.CATMAX.
NOTE: The data set WORK.MASTER has 9732 observations and 38 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 49.44 percent. 
      Compressed is 90 pages; un-compressed would require 178 pages.
NOTE: DATA statement used (Total process time):
      real time           0.22 seconds
      cpu time            0.19 seconds
      

MPRINT(MERGMAST):   run;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(MERGMAST):  ;
MPRINT(DATAPREPARATION):  ;
MPRINT(AUDIT_PREP):   run;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(AUDIT_PREP):  ;
MPRINT(DATAPREPARATION):  ;
MPRINT(PROJECT_ISCAN):   data master;
MPRINT(PROJECT_ISCAN):   set master;
MPRINT(PROJECT_ISCAN):   period=1;
MPRINT(PROJECT_ISCAN):   numult=minfactor;
MPRINT(PROJECT_ISCAN):   if vol1=. or vol1=0 then delete;
MPRINT(PROJECT_ISCAN):   weight=factor;
MPRINT(PROJECT_ISCAN):   units=units*weight;
MPRINT(PROJECT_ISCAN):   value=price*units/1;
MPRINT(PROJECT_ISCAN):   volume=units*vol1/1000;
MPRINT(PROJECT_ISCAN):   pnumfac=numfac*weight;
MPRINT(PROJECT_ISCAN):   *projecting facings number and length;
MPRINT(PROJECT_ISCAN):   plenfac=lenfac*weight;
MPRINT(PROJECT_ISCAN):   drop minfactor;
MPRINT(PROJECT_ISCAN):   b_units=b_units*weight;
MPRINT(PROJECT_ISCAN):   bvalue=b_price*b_units/1;
MPRINT(PROJECT_ISCAN):   bvolume = b_units*vol1/1000;
MPRINT(PROJECT_ISCAN):   b_price=(bvalue)/b_units;
MPRINT(PROJECT_ISCAN):   price=(value)/units;
MPRINT(PROJECT_ISCAN):   if (b_price*.95)>=price then prdn=1;
MPRINT(PROJECT_ISCAN):   else prdn=0;
MPRINT(PROJECT_ISCAN):   incvolm = 0;
MPRINT(PROJECT_ISCAN):   bvolm = 0;
MPRINT(PROJECT_ISCAN):   if prdn=1 then mkvalue=(b_price-price)*units;
MPRINT(PROJECT_ISCAN):   else mkvalue=0;
MPRINT(PROJECT_ISCAN):   mkvalm = 0;
MPRINT(PROJECT_ISCAN):   incvalm = 0;
MPRINT(PROJECT_ISCAN):   bvalm = 0;
MPRINT(PROJECT_ISCAN):   bvalue=b_price*b_units;
MPRINT(PROJECT_ISCAN):   if ((b_price*.95)>=price) then do;
MPRINT(PROJECT_ISCAN):   incvalp=value-bvalue;
MPRINT(PROJECT_ISCAN):   bvalp=bvalue;
MPRINT(PROJECT_ISCAN):   end;
MPRINT(PROJECT_ISCAN):   else do;
MPRINT(PROJECT_ISCAN):   incvalp=0;
MPRINT(PROJECT_ISCAN):   bvalp=0;
MPRINT(PROJECT_ISCAN):   end;
MPRINT(PROJECT_ISCAN):   if ((b_price*.95)>=price) then do;
MPRINT(PROJECT_ISCAN):   valp=value;
MPRINT(PROJECT_ISCAN):   end;
MPRINT(PROJECT_ISCAN):   else do;
MPRINT(PROJECT_ISCAN):   valp=0;
MPRINT(PROJECT_ISCAN):   end;
MPRINT(PROJECT_ISCAN):   drop bvalue;
MPRINT(PROJECT_ISCAN):   if feat1>0 or disp1>0 or prdn=1 then do;
MPRINT(PROJECT_ISCAN):   incvolm=volume-bvolume;
MPRINT(PROJECT_ISCAN):   bvolm=bvolume;
MPRINT(PROJECT_ISCAN):   mkvalm=mkvalue;
MPRINT(PROJECT_ISCAN):   incvalm=value-bvalue;
MPRINT(PROJECT_ISCAN):   bvalm=bvalue;
MPRINT(PROJECT_ISCAN):   end;
MPRINT(PROJECT_ISCAN):   volamspack=0;
MPRINT(PROJECT_ISCAN):   valamspack=0;
MPRINT(PROJECT_ISCAN):   if feat1>0 or disp1>0 or prdn=1 or spack=1 then do;
MPRINT(PROJECT_ISCAN):   volamspack=volume;
MPRINT(PROJECT_ISCAN):   valamspack=value;
MPRINT(PROJECT_ISCAN):   end;
MPRINT(PROJECT_ISCAN):   drop bvolume;
MPRINT(PROJECT_ISCAN):   drop bvalue mkvalue;
MPRINT(PROJECT_ISCAN):   run;

NOTE: There were 9732 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 9732 observations and 53 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 56.80 percent. 
      Compressed is 73 pages; un-compressed would require 169 pages.
NOTE: DATA statement used (Total process time):
      real time           0.09 seconds
      cpu time            0.07 seconds
      

MPRINT(PROJECT_ISCAN):   data monthmast0;
MPRINT(PROJECT_ISCAN):   set master;
MPRINT(PROJECT_ISCAN):   week=0;
MPRINT(PROJECT_ISCAN):   b_value=b_price*b_units;
MPRINT(PROJECT_ISCAN):   if (b_price*.95)>=price then prdn=1;
MPRINT(PROJECT_ISCAN):   else prdn=0;
MPRINT(PROJECT_ISCAN):   keep store g1 s1 ean period week keycat units value volume numfac lenfac pnumfac plenfac factor weight feat1 feat bund infeat instore disp disp1 dispend b_value b_units incvolm bvolm incvalm bvalm mkvalm prdn bvalp incvalp valp 
volamspack valamspack;
MPRINT(PROJECT_ISCAN):   run;

NOTE: There were 9732 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MONTHMAST0 has 9732 observations and 37 variables.
NOTE: Compressing data set WORK.MONTHMAST0 decreased size by 58.43 percent. 
      Compressed is 74 pages; un-compressed would require 178 pages.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
      

MPRINT(PROJECT_ISCAN):   proc summary data=monthmast0 sum nway;
MPRINT(PROJECT_ISCAN):   class store g1 s1 ean;
MPRINT(PROJECT_ISCAN):   id period week keycat;
MPRINT(PROJECT_ISCAN):   var units value volume numfac lenfac pnumfac plenfac factor weight feat1 feat bund infeat instore disp disp1 dispend b_value b_units bvalp incvalp valp incvolm bvolm incvalm bvalm mkvalm volamspack valamspack prdn ;
MPRINT(PROJECT_ISCAN):   output out=monthmast1(drop=_type_ _freq_) sum(units value volume numfac lenfac pnumfac plenfac b_value b_units bvalp incvalp valp incvolm bvolm incvalm bvalm mkvalm volamspack valamspack) = units value volume numfac lenfac pnumfac 
plenfac b_value b_units bvalp incvalp valp incvolm bvolm incvalm bvalm mkvalm volamspack valamspack min(factor weight)=factor weight max(feat1 feat bund infeat instore disp disp1 dispend prdn)=feat1 feat bund infeat instore disp disp1 dispend prdn;
MPRINT(PROJECT_ISCAN):   run;

NOTE: There were 9732 observations read from the data set WORK.MONTHMAST0.
NOTE: The data set WORK.MONTHMAST1 has 3346 observations and 37 variables.
NOTE: Compressing data set WORK.MONTHMAST1 decreased size by 51.61 percent. 
      Compressed is 30 pages; un-compressed would require 62 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.10 seconds
      cpu time            0.14 seconds
      

MPRINT(PROJECT_ISCAN):   * normalize monthly data to weekly record format ;
MPRINT(SORTEM):   proc sort data=projsum(where=(week=0));
MPRINT(SORTEM):   by store g1 s1;
MPRINT(SORTEM):   run;

NOTE: There were 456 observations read from the data set WORK.PROJSUM.
      WHERE week=0;
NOTE: The data set WORK.PROJSUM has 456 observations and 5 variables.
NOTE: Compressing data set WORK.PROJSUM increased size by 33.33 percent. 
      Compressed is 4 pages; un-compressed would require 3 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

MPRINT(PROJECT_ISCAN):  ;
MPRINT(MATCHMERGE):   data monthmast1 ;
MPRINT(MATCHMERGE):   merge monthmast1 (in=a) projsum (in=b) ;
MPRINT(MATCHMERGE):   by store g1 s1 ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 3346 observations read from the data set WORK.MONTHMAST1.
NOTE: There were 456 observations read from the data set WORK.PROJSUM.
NOTE: The data set WORK.MONTHMAST1 has 3346 observations and 38 variables.
NOTE: Compressing data set WORK.MONTHMAST1 decreased size by 51.56 percent. 
      Compressed is 31 pages; un-compressed would require 64 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

MPRINT(PROJECT_ISCAN):  ;
MPRINT(SORTEM):   proc sort data=store;
MPRINT(SORTEM):   by store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(PROJECT_ISCAN):  ;
MPRINT(MATCHMERGE):   data monthmast1 ;
MPRINT(MATCHMERGE):   merge monthmast1 (in=a) store (in=b) ;
MPRINT(MATCHMERGE):   by store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 3346 observations read from the data set WORK.MONTHMAST1.
NOTE: There were 4357 observations read from the data set WORK.STORE.
NOTE: The data set WORK.MONTHMAST1 has 3346 observations and 40 variables.
NOTE: Compressing data set WORK.MONTHMAST1 decreased size by 50.77 percent. 
      Compressed is 32 pages; un-compressed would require 65 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

MPRINT(PROJECT_ISCAN):  ;
MPRINT(SORTEM):   proc sort data=code;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(PROJECT_ISCAN):  ;
MPRINT(SORTEM):   proc sort data=monthmast1;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 3346 observations read from the data set WORK.MONTHMAST1.
NOTE: The data set WORK.MONTHMAST1 has 3346 observations and 40 variables.
NOTE: Compressing data set WORK.MONTHMAST1 decreased size by 50.77 percent. 
      Compressed is 32 pages; un-compressed would require 65 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      

MPRINT(PROJECT_ISCAN):  ;
MPRINT(MATCHMERGE):   data monthmast1 ;
MPRINT(MATCHMERGE):   merge monthmast1 (in=a) code (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 3346 observations read from the data set WORK.MONTHMAST1.
NOTE: There were 1000 observations read from the data set WORK.CODE.
NOTE: The data set WORK.MONTHMAST1 has 3346 observations and 45 variables.
NOTE: Compressing data set WORK.MONTHMAST1 decreased size by 51.35 percent. 
      Compressed is 36 pages; un-compressed would require 74 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
      

MPRINT(PROJECT_ISCAN):  ;
MPRINT(SORTEM):   proc sort data=item;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(PROJECT_ISCAN):  ;
MPRINT(MATCHMERGE):   data monthmast1 ;
MPRINT(MATCHMERGE):   merge monthmast1 (in=a) item (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 3346 observations read from the data set WORK.MONTHMAST1.
NOTE: There were 955 observations read from the data set WORK.ITEM.
NOTE: The data set WORK.MONTHMAST1 has 3346 observations and 52 variables.
NOTE: Compressing data set WORK.MONTHMAST1 decreased size by 51.79 percent. 
      Compressed is 27 pages; un-compressed would require 56 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

MPRINT(PROJECT_ISCAN):  ;
MPRINT(PROJECT_ISCAN):   data monthmast1;
MPRINT(PROJECT_ISCAN):   set monthmast1;
MPRINT(PROJECT_ISCAN):   price=value/units;
MPRINT(PROJECT_ISCAN):   b_price=b_value/b_units;
MPRINT(PROJECT_ISCAN):   drop b_value;
MPRINT(PROJECT_ISCAN):   run;

NOTE: There were 3346 observations read from the data set WORK.MONTHMAST1.
NOTE: The data set WORK.MONTHMAST1 has 3346 observations and 53 variables.
NOTE: Compressing data set WORK.MONTHMAST1 decreased size by 50.88 percent. 
      Compressed is 28 pages; un-compressed would require 57 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.02 seconds
      

MPRINT(PROJECT_ISCAN):   data master;
MPRINT(PROJECT_ISCAN):   set master monthmast1 ;
MPRINT(PROJECT_ISCAN):   run;

NOTE: There were 9732 observations read from the data set WORK.MASTER.
NOTE: There were 3346 observations read from the data set WORK.MONTHMAST1.
NOTE: The data set WORK.MASTER has 13078 observations and 54 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 55.75 percent. 
      Compressed is 100 pages; un-compressed would require 226 pages.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.08 seconds
      

MPRINT(PROJECT_ISCAN):   run;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(PROJECT_ISCAN):  ;
MPRINT(DATAPREPARATION):  ;
MPRINT(CREATEPROMOFLAGS):   run;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(CREATEPROMOFLAGS):  ;
MPRINT(DATAPREPARATION):  ;
MPRINT(DATAPREPARATION):   run;
MPRINT(SORTEM):   proc sort data=master;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 13078 observations and 54 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 55.75 percent. 
      Compressed is 100 pages; un-compressed would require 226 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.13 seconds
      cpu time            0.10 seconds
      

MPRINT(CREATEACVS):  ;
MPRINT(CREATEACVS):   data mastacv;
MPRINT(CREATEACVS):   set master (keep= g1 s1 store week value);
MPRINT(CREATEACVS):   run;
NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTACV has 13078 observations and 5 variables.
NOTE: Compressing data set WORK.MASTACV increased size by 46.15 percent. 
      Compressed is 76 pages; un-compressed would require 52 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.05 seconds
      

MPRINT(CREATEACVS):   proc summary data=mastacv sum nway;
MPRINT(CREATEACVS):   by g1 s1 week store;
MPRINT(CREATEACVS):   var value;
MPRINT(CREATEACVS):   output out=acvtot(drop=_type_ _freq_) sum=stacv;

NOTE: There were 13078 observations read from the data set WORK.MASTACV.
NOTE: The data set WORK.ACVTOT has 380 observations and 5 variables.
NOTE: Compressing data set WORK.ACVTOT increased size by 100.00 percent. 
      Compressed is 4 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.03 seconds
      cpu time            0.02 seconds
      

MPRINT(SORTEM):   proc sort data=acvtot;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 380 observations read from the data set WORK.ACVTOT.
NOTE: The data set WORK.ACVTOT has 380 observations and 5 variables.
NOTE: Compressing data set WORK.ACVTOT increased size by 100.00 percent. 
      Compressed is 4 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATEACVS):  ;
MPRINT(CREATEACVS):   data master;
MPRINT(CREATEACVS):   merge master(in=a) acvtot(in=b);
MPRINT(CREATEACVS):   by g1 s1 week store;
MPRINT(CREATEACVS):   if a and b;
MPRINT(CREATEACVS):   run;
NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: There were 380 observations read from the data set WORK.ACVTOT.
NOTE: The data set WORK.MASTER has 13078 observations and 55 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 54.78 percent. 
      Compressed is 104 pages; un-compressed would require 230 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.09 seconds
      

MPRINT(CREATEACVS):   proc summary data=mastacv;
MPRINT(CREATEACVS):   by g1 s1 week;
MPRINT(CREATEACVS):   var value;
MPRINT(CREATEACVS):   output out=acvreg(drop=_type_ _freq_) sum=regacv;

NOTE: Compression was disabled for data set WORK.ACVREG because compression overhead would increase the size of the data set.
NOTE: There were 13078 observations read from the data set WORK.MASTACV.
NOTE: The data set WORK.ACVREG has 10 observations and 4 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATEACVS):   data master;
MPRINT(CREATEACVS):   merge master(in=a) acvreg(in=b);
MPRINT(CREATEACVS):   by g1 s1 week;
MPRINT(CREATEACVS):   if a and b;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: There were 10 observations read from the data set WORK.ACVREG.
NOTE: The data set WORK.MASTER has 13078 observations and 56 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 53.85 percent. 
      Compressed is 108 pages; un-compressed would require 234 pages.
NOTE: DATA statement used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      

MPRINT(SORTEM):   proc sort data=numdenom;
MPRINT(SORTEM):   by g1 s1 week;
MPRINT(SORTEM):   run;

NOTE: There were 120 observations read from the data set WORK.NUMDENOM.
NOTE: The data set WORK.NUMDENOM has 120 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(CREATEACVS):  ;
MPRINT(CREATEACVS):   data master;
MPRINT(CREATEACVS):   merge master(in=a) numdenom(in=b);
MPRINT(CREATEACVS):   by g1 s1 week;
MPRINT(CREATEACVS):   if a and b;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: There were 120 observations read from the data set WORK.NUMDENOM.
NOTE: The data set WORK.MASTER has 13078 observations and 57 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 53.14 percent. 
      Compressed is 112 pages; un-compressed would require 239 pages.
NOTE: DATA statement used (Total process time):
      real time           0.09 seconds
      cpu time            0.10 seconds
      

MPRINT(SORTEM):   proc sort data=master(keep=g1 s1 week store factor) out=tstores nodupkey;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: 12698 observations with duplicate key values were deleted.
NOTE: The data set WORK.TSTORES has 380 observations and 5 variables.
NOTE: Compressing data set WORK.TSTORES increased size by 100.00 percent. 
      Compressed is 4 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.04 seconds
      

MPRINT(CREATEACVS):  ;
MPRINT(CREATEACVS):   *** create minimum weights for each region store and period;
MPRINT(CREATEACVS):   proc summary data=tstores nway;
MPRINT(CREATEACVS):   var factor;
MPRINT(CREATEACVS):   by g1 s1 week store;
MPRINT(CREATEACVS):   output out=minstore(drop=_type_ _freq_) min=minwgt;
MPRINT(CREATEACVS):   run;

NOTE: There were 380 observations read from the data set WORK.TSTORES.
NOTE: The data set WORK.MINSTORE has 380 observations and 5 variables.
NOTE: Compressing data set WORK.MINSTORE increased size by 100.00 percent. 
      Compressed is 4 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATEACVS):   *** create variable for total stores for the week;
MPRINT(CREATEACVS):   proc summary data=tstores nway;
MPRINT(CREATEACVS):   var factor;
MPRINT(CREATEACVS):   by g1 s1 week ;
MPRINT(CREATEACVS):   output out=totstore(drop=_type_ _freq_) sum=tstores;
MPRINT(CREATEACVS):   run;

NOTE: Compression was disabled for data set WORK.TOTSTORE because compression overhead would increase the size of the data set.
NOTE: There were 380 observations read from the data set WORK.TSTORES.
NOTE: The data set WORK.TOTSTORE has 10 observations and 4 variables.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(CREATEACVS):  ;
MPRINT(DATAPREPARATION):  ;
MPRINT(CREATECATVALUE):   run;
MPRINT(SORTEM):   proc sort data=master;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 13078 observations and 57 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 53.14 percent. 
      Compressed is 112 pages; un-compressed would require 239 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.09 seconds
      cpu time            0.10 seconds
      

MPRINT(CREATECATVALUE):  ;
MPRINT(CREATECATVALUE):   proc summary data=master sum nway;
MPRINT(CREATECATVALUE):   var value units volume lenfac;
MPRINT(CREATECATVALUE):   by g1 s1 week store;
MPRINT(CREATECATVALUE):   output out=stcatval(drop=_type_ _freq_) sum=stcatval stcatuni stcatvol stcatlen;
MPRINT(CREATECATVALUE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.STCATVAL has 380 observations and 8 variables.
NOTE: Compressing data set WORK.STCATVAL increased size by 66.67 percent. 
      Compressed is 5 pages; un-compressed would require 3 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.05 seconds
      cpu time            0.04 seconds
      

MPRINT(CREATECATVALUE):   data master;
MPRINT(CREATECATVALUE):   merge master(in=a) stcatval(in=b);
MPRINT(CREATECATVALUE):   by g1 s1 week store;
MPRINT(CREATECATVALUE):   if a and b;
MPRINT(CREATECATVALUE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: There were 380 observations read from the data set WORK.STCATVAL.
NOTE: The data set WORK.MASTER has 13078 observations and 61 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 51.75 percent. 
      Compressed is 124 pages; un-compressed would require 257 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.12 seconds
      

MPRINT(CREATECATVALUE):   proc summary data=master noprint;
MPRINT(CREATECATVALUE):   by g1 s1 week ;
MPRINT(CREATECATVALUE):   var value units volume plenfac pnumfac;
MPRINT(CREATECATVALUE):   output out=reg (drop=_type_ _freq_) sum=regvalue regunits regvolume regcatlen regcatfac;
MPRINT(CREATECATVALUE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.REG has 10 observations and 8 variables.
NOTE: Compressing data set WORK.REG increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.05 seconds
      cpu time            0.04 seconds
      

MPRINT(CREATECATVALUE):   data master;
MPRINT(CREATECATVALUE):   merge master(in=a) reg(in=b);
MPRINT(CREATECATVALUE):   by g1 s1 week ;
MPRINT(CREATECATVALUE):   if a and b;
MPRINT(CREATECATVALUE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: There were 10 observations read from the data set WORK.REG.
NOTE: The data set WORK.MASTER has 13078 observations and 66 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 50.18 percent. 
      Compressed is 139 pages; un-compressed would require 279 pages.
NOTE: DATA statement used (Total process time):
      real time           0.12 seconds
      cpu time            0.12 seconds
      

MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(CREATECATVALUE):  ;
MPRINT(DATAPREPARATION):  ;
MPRINT(MAIN):  ;
MPRINT(SORTEM):   proc sort data=master;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 13078 observations and 66 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 50.18 percent. 
      Compressed is 139 pages; un-compressed would require 279 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.11 seconds
      cpu time            0.12 seconds
      

MPRINT(AGGVALUE_CWD):  ;
MPRINT(AGGVALUE_CWD):   proc summary data=master nway;
MPRINT(AGGVALUE_CWD):   var value units volume Plenfac;
MPRINT(AGGVALUE_CWD):   by g1 s1 week store;
MPRINT(AGGVALUE_CWD):   output out=stcatval(drop=_type_ _freq_) sum=stcatval stcatuni stcatvol stcatlen;
MPRINT(AGGVALUE_CWD):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.STCATVAL has 380 observations and 8 variables.
NOTE: Compressing data set WORK.STCATVAL increased size by 66.67 percent. 
      Compressed is 5 pages; un-compressed would require 3 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.04 seconds
      cpu time            0.05 seconds
      

MPRINT(AGGVALUE_CWD):   proc means data=stcatval noprint;
MPRINT(AGGVALUE_CWD):   var stcatval stcatuni stcatvol stcatlen;
MPRINT(AGGVALUE_CWD):   by g1 s1 week ;
MPRINT(AGGVALUE_CWD):   output out=tstctval(drop=_type_ _freq_) sum=tstctval tstctuni tstctvol tstctlen;
MPRINT(AGGVALUE_CWD):   run;

NOTE: There were 380 observations read from the data set WORK.STCATVAL.
NOTE: The data set WORK.TSTCTVAL has 10 observations and 7 variables.
NOTE: Compressing data set WORK.TSTCTVAL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGVALUE_CWD):   data master;
MPRINT(AGGVALUE_CWD):   merge stcatval(in=a) master(in=b);
MPRINT(AGGVALUE_CWD):   by g1 s1 week store;
MPRINT(AGGVALUE_CWD):   if b;
MPRINT(AGGVALUE_CWD):   stcatvaf=0;
MPRINT(AGGVALUE_CWD):   stcatvad=0;
MPRINT(AGGVALUE_CWD):   stcatvp=0;
MPRINT(AGGVALUE_CWD):   stcatvmr=0;
MPRINT(AGGVALUE_CWD):   if feat1 > 0 then stcatvaf=stcatval;
MPRINT(AGGVALUE_CWD):   if disp1 > 0 then stcatvad=stcatval;
MPRINT(AGGVALUE_CWD):   if (prdn > 0 and feat1=0 and disp1=0) then stcatvp=stcatval;
MPRINT(AGGVALUE_CWD):   if feat1 > 0 or disp1 > 0 or instore >0 or prdn > 0 then stcatvmr=stcatval;
MPRINT(AGGVALUE_CWD):   run;

NOTE: There were 380 observations read from the data set WORK.STCATVAL.
NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 13078 observations and 70 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 51.03 percent. 
      Compressed is 143 pages; un-compressed would require 292 pages.
NOTE: DATA statement used (Total process time):
      real time           0.12 seconds
      cpu time            0.13 seconds
      

MPRINT(AGGVALUE_CWD):   *----------------------------------------------------------------------------------;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(AGGVALUE_CWD):  ;
MPRINT(AGGREGATION_ISCAN):  ;
MPRINT(READSECTOTALS):   data sectot1 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 2000 > lev1 >= 1000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT1 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT1 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READSECTOTALS):   data sectot2 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 3000 > lev1 >= 2000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT2 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT2 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(READSECTOTALS):   data sectot3 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 4000 > lev1 >= 3000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT3 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT3 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(READSECTOTALS):   data sectot4 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 5000 > lev1 >= 4000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT4 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT4 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READSECTOTALS):   data sectot5 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 6000 > lev1 >= 5000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT5 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT5 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READSECTOTALS):   data sectot6 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 7000 > lev1 >= 6000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT6 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT6 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(READSECTOTALS):   data sectot7 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 8000 > lev1 >= 7000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT7 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT7 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(READSECTOTALS):   data sectot8 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 9000 > lev1 >= 8000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT8 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT8 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READSECTOTALS):   data sectot9 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 10000 > lev1 >= 9000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT9 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT9 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.03 seconds
      

MPRINT(READSECTOTALS):   data sectot10 ;
MPRINT(READSECTOTALS):   set sectot;
MPRINT(READSECTOTALS):   if 11000 > lev1 >= 10000;
MPRINT(READSECTOTALS):   run;

NOTE: There were 10000 observations read from the data set WORK.SECTOT.
NOTE: The data set WORK.SECTOT10 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT10 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=sectot1;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT1.
NOTE: The data set WORK.SECTOT1 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT1 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READSECTOTALS):  ;
MPRINT(SORTEM):   proc sort data=sectot2;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT2.
NOTE: The data set WORK.SECTOT2 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT2 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READSECTOTALS):  ;
MPRINT(SORTEM):   proc sort data=sectot3;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT3.
NOTE: The data set WORK.SECTOT3 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT3 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READSECTOTALS):  ;
MPRINT(SORTEM):   proc sort data=sectot4;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT4.
NOTE: The data set WORK.SECTOT4 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT4 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READSECTOTALS):  ;
MPRINT(SORTEM):   proc sort data=sectot5;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT5.
NOTE: The data set WORK.SECTOT5 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT5 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READSECTOTALS):  ;
MPRINT(SORTEM):   proc sort data=sectot6;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT6.
NOTE: The data set WORK.SECTOT6 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT6 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READSECTOTALS):  ;
MPRINT(SORTEM):   proc sort data=sectot7;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT7.
NOTE: The data set WORK.SECTOT7 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT7 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READSECTOTALS):  ;
MPRINT(SORTEM):   proc sort data=sectot8;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT8.
NOTE: The data set WORK.SECTOT8 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT8 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READSECTOTALS):  ;
MPRINT(SORTEM):   proc sort data=sectot9;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT9.
NOTE: The data set WORK.SECTOT9 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT9 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(READSECTOTALS):  ;
MPRINT(SORTEM):   proc sort data=sectot10;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 1000 observations read from the data set WORK.SECTOT10.
NOTE: The data set WORK.SECTOT10 has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT10 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READSECTOTALS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(READSECTOTALS):  ;
MPRINT(AGGREGATION_ISCAN):  ;
MPRINT(SORTEM):   proc sort data=master;
MPRINT(SORTEM):   by g1 s1 week ean;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 13078 observations and 70 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 51.37 percent. 
      Compressed is 142 pages; un-compressed would require 292 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.12 seconds
      

MPRINT(CALCINCVOLUME):  ;
MPRINT(CALCINCVOLUME):   *change from promo;
MPRINT(CALCINCVOLUME):   proc summary data=master sum nway;
MPRINT(CALCINCVOLUME):   by g1 s1 week EAN;
MPRINT(CALCINCVOLUME):   var incvolm;
MPRINT(CALCINCVOLUME):   output out=totinc(drop=_type_ _freq_) sum=totinc;
MPRINT(CALCINCVOLUME):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.TOTINC has 774 observations and 5 variables.
NOTE: Compressing data set WORK.TOTINC increased size by 40.00 percent. 
      Compressed is 7 pages; un-compressed would require 5 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.05 seconds
      cpu time            0.04 seconds
      

MPRINT(MATCHMERGE):   data master ;
MPRINT(MATCHMERGE):   merge master (in=a) totinc (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: There were 774 observations read from the data set WORK.TOTINC.
NOTE: The data set WORK.MASTER has 13078 observations and 71 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 51.34 percent. 
      Compressed is 145 pages; un-compressed would require 298 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.12 seconds
      

MPRINT(CALCINCVOLUME):  ;
MPRINT(CALCINCVOLUME):   data master;
MPRINT(CALCINCVOLUME):   set master;
MPRINT(CALCINCVOLUME):   inczerou=incunim;
MPRINT(CALCINCVOLUME):   inczerov=incvolm;
MPRINT(CALCINCVOLUME):   if totinc<0 then do;
MPRINT(CALCINCVOLUME):   inczerou=0;
MPRINT(CALCINCVOLUME):   inczerov=0;
MPRINT(CALCINCVOLUME):   end;
MPRINT(CALCINCVOLUME):  ;

NOTE: Variable incunim is uninitialized.
NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 13078 observations and 74 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 51.71 percent. 
      Compressed is 113 pages; un-compressed would require 234 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(CALCINCVOLUME):   proc summary data=master sum nway;
MPRINT(CALCINCVOLUME):   by g1 s1 week;
MPRINT(CALCINCVOLUME):   var inczerou inczerov ;
MPRINT(CALCINCVOLUME):   output out=catincr(drop=_type_ _freq_) sum=catincu catincv catincva;
MPRINT(CALCINCVOLUME):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.CATINCR has 10 observations and 5 variables.
NOTE: Compressing data set WORK.CATINCR increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(CALCINCVOLUME):  ;
MPRINT(AGGREGATION_ISCAN):  ;
MPRINT(MASTERSECTOT):   data mastsectot;
MPRINT(MASTERSECTOT):   set master (drop=lev1-lev5);
MPRINT(MASTERSECTOT):   item=.;
MPRINT(MASTERSECTOT):   drop item;
MPRINT(MASTERSECTOT):   numean=1;
MPRINT(MASTERSECTOT):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTSECTOT has 13078 observations and 70 variables.
NOTE: Compressing data set WORK.MASTSECTOT decreased size by 51.37 percent. 
      Compressed is 142 pages; un-compressed would require 292 pages.
NOTE: DATA statement used (Total process time):
      real time           0.09 seconds
      cpu time            0.11 seconds
      

MPRINT(SORTEM):   proc sort data=mastsectot;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: The data set WORK.MASTSECTOT has 13078 observations and 70 variables.
NOTE: Compressing data set WORK.MASTSECTOT decreased size by 51.37 percent. 
      Compressed is 142 pages; un-compressed would require 292 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas1 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot1 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT1.
NOTE: The data set WORK.SECMAS1 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS1 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas2 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot2 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT2.
NOTE: The data set WORK.SECMAS2 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS2 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.11 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas3 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot3 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT3.
NOTE: The data set WORK.SECMAS3 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS3 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas4 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot4 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT4.
NOTE: The data set WORK.SECMAS4 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS4 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.12 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas5 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot5 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT5.
NOTE: The data set WORK.SECMAS5 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS5 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas6 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot6 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT6.
NOTE: The data set WORK.SECMAS6 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS6 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas7 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot7 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT7.
NOTE: The data set WORK.SECMAS7 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS7 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas8 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot8 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT8.
NOTE: The data set WORK.SECMAS8 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS8 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.11 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas9 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot9 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT9.
NOTE: The data set WORK.SECMAS9 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS9 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.12 seconds
      

MPRINT(MASTERSECTOT):  ;
MPRINT(MATCHMERGE):   data secmas10 ;
MPRINT(MATCHMERGE):   merge mastsectot (in=a) sectot10 (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTSECTOT.
NOTE: There were 1000 observations read from the data set WORK.SECTOT10.
NOTE: The data set WORK.SECMAS10 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS10 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(MASTERSECTOT):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(MASTERSECTOT):  ;
MPRINT(AGGREGATION_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   data master;
MPRINT(AGGSALES_ISCAN):   set master;
MPRINT(AGGSALES_ISCAN):   numean=1;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 13078 observations and 75 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 50.85 percent. 
      Compressed is 115 pages; un-compressed would require 234 pages.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.10 seconds
      

MPRINT(SORTEM):   proc sort data=master;
MPRINT(SORTEM):   by g1 s1 week store lev1 lev2 lev3 lev4 lev5;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTER has 13078 observations and 75 variables.
NOTE: Compressing data set WORK.MASTER decreased size by 50.85 percent. 
      Compressed is 115 pages; un-compressed would require 234 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.13 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=master noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1 lev2 lev3 lev4 lev5;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC bvalp incvalp valp incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=lev5(drop=_freq_ _type_) sum=;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.LEV5 has 8866 observations and 40 variables.
NOTE: Compressing data set WORK.LEV5 decreased size by 44.44 percent. 
      Compressed is 95 pages; un-compressed would require 171 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.18 seconds
      cpu time            0.17 seconds
      

MPRINT(AGGSALES_ISCAN):   proc summary data=lev5 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1 lev2 lev3 lev4;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC bvalp incvalp valp incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=lev4(drop=_freq_ _type_) sum=;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 8866 observations read from the data set WORK.LEV5.
NOTE: The data set WORK.LEV4 has 8866 observations and 39 variables.
NOTE: Compressing data set WORK.LEV4 decreased size by 44.64 percent. 
      Compressed is 93 pages; un-compressed would require 168 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.16 seconds
      cpu time            0.17 seconds
      

MPRINT(AGGSALES_ISCAN):   proc summary data=lev4 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1 lev2 lev3;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC bvalp incvalp valp incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=lev3(drop=_freq_ _type_) sum=;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 8866 observations read from the data set WORK.LEV4.
NOTE: The data set WORK.LEV3 has 4804 observations and 38 variables.
NOTE: Compressing data set WORK.LEV3 decreased size by 38.64 percent. 
      Compressed is 54 pages; un-compressed would require 88 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.10 seconds
      cpu time            0.09 seconds
      

MPRINT(AGGSALES_ISCAN):   proc summary data=lev3 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1 lev2;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC bvalp incvalp valp incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=lev2(drop=_freq_ _type_) sum=;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 4804 observations read from the data set WORK.LEV3.
NOTE: The data set WORK.LEV2 has 1396 observations and 37 variables.
NOTE: Compressing data set WORK.LEV2 decreased size by 26.92 percent. 
      Compressed is 19 pages; un-compressed would require 26 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.04 seconds
      cpu time            0.05 seconds
      

MPRINT(AGGSALES_ISCAN):   proc summary data=lev2 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC bvalp incvalp valp incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=lev1(drop=_freq_ _type_) sum=;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 1396 observations read from the data set WORK.LEV2.
NOTE: The data set WORK.LEV1 has 380 observations and 36 variables.
NOTE: Compressing data set WORK.LEV1 decreased size by 0.00 percent. 
      Compressed is 7 pages; un-compressed would require 7 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(SORTEM):   proc sort data=secmas1;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS1.
NOTE: The data set WORK.SECMAS1 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS1 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.11 seconds
      cpu time            0.12 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas1 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst1(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS1.
NOTE: The data set WORK.LEVST1 has 1180 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST1 decreased size by 25.00 percent. 
      Compressed is 15 pages; un-compressed would require 20 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

MPRINT(SORTEM):   proc sort data=secmas2;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS2.
NOTE: The data set WORK.SECMAS2 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS2 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.13 seconds
      cpu time            0.13 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas2 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst2(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS2.
NOTE: The data set WORK.LEVST2 has 1180 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST2 decreased size by 25.00 percent. 
      Compressed is 15 pages; un-compressed would require 20 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.08 seconds
      cpu time            0.09 seconds
      

MPRINT(SORTEM):   proc sort data=secmas3;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS3.
NOTE: The data set WORK.SECMAS3 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS3 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.11 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas3 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst3(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS3.
NOTE: The data set WORK.LEVST3 has 3464 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST3 decreased size by 33.93 percent. 
      Compressed is 37 pages; un-compressed would require 56 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(SORTEM):   proc sort data=secmas4;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS4.
NOTE: The data set WORK.SECMAS4 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS4 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.12 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas4 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst4(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS4.
NOTE: The data set WORK.LEVST4 has 2756 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST4 decreased size by 33.33 percent. 
      Compressed is 30 pages; un-compressed would require 45 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.10 seconds
      cpu time            0.10 seconds
      

MPRINT(SORTEM):   proc sort data=secmas5;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS5.
NOTE: The data set WORK.SECMAS5 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS5 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.12 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas5 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst5(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS5.
NOTE: The data set WORK.LEVST5 has 756 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST5 decreased size by 15.38 percent. 
      Compressed is 11 pages; un-compressed would require 13 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

MPRINT(SORTEM):   proc sort data=secmas6;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS6.
NOTE: The data set WORK.SECMAS6 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS6 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.13 seconds
      cpu time            0.13 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas6 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst6(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS6.
NOTE: The data set WORK.LEVST6 has 2226 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST6 decreased size by 27.78 percent. 
      Compressed is 26 pages; un-compressed would require 36 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.10 seconds
      cpu time            0.09 seconds
      

MPRINT(SORTEM):   proc sort data=secmas7;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS7.
NOTE: The data set WORK.SECMAS7 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS7 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.13 seconds
      cpu time            0.12 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas7 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst7(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS7.
NOTE: The data set WORK.LEVST7 has 1880 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST7 decreased size by 25.81 percent. 
      Compressed is 23 pages; un-compressed would require 31 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.08 seconds
      cpu time            0.09 seconds
      

MPRINT(SORTEM):   proc sort data=secmas8;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS8.
NOTE: The data set WORK.SECMAS8 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS8 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.14 seconds
      cpu time            0.13 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas8 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst8(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS8.
NOTE: The data set WORK.LEVST8 has 564 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST8 decreased size by 10.00 percent. 
      Compressed is 9 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.07 seconds
      cpu time            0.08 seconds
      

MPRINT(SORTEM):   proc sort data=secmas9;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS9.
NOTE: The data set WORK.SECMAS9 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS9 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.12 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas9 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst9(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS9.
NOTE: The data set WORK.LEVST9 has 694 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST9 decreased size by 16.67 percent. 
      Compressed is 10 pages; un-compressed would require 12 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

MPRINT(SORTEM):   proc sort data=secmas10;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS10.
NOTE: The data set WORK.SECMAS10 has 13078 observations and 76 variables.
NOTE: Compressing data set WORK.SECMAS10 decreased size by 52.67 percent. 
      Compressed is 115 pages; un-compressed would require 243 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.13 seconds
      

MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGSALES_ISCAN):   proc summary data=secmas10 noprint;
MPRINT(AGGSALES_ISCAN):   by g1 s1 week store lev1;
MPRINT(AGGSALES_ISCAN):   id period factor stcatval regvalue regfact numult stacv regacv regcatlen regcatfac;
MPRINT(AGGSALES_ISCAN):   var units value volume NUMEAN PNUMFAC PLENFAC incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(AGGSALES_ISCAN):   output out=levst10(drop=_freq_ _type_) sum= ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS10.
NOTE: The data set WORK.LEVST10 has 694 observations and 33 variables.
NOTE: Compressing data set WORK.LEVST10 decreased size by 16.67 percent. 
      Compressed is 10 pages; un-compressed would require 12 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

MPRINT(AGGSALES_ISCAN):   data aggmast;
MPRINT(AGGSALES_ISCAN):   set master lev1 lev2 lev3 lev4 lev5 levst1 levst2 levst3 levst4 levst5 levst6 levst7 levst8 levst9 levst10 ;
MPRINT(AGGSALES_ISCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: There were 380 observations read from the data set WORK.LEV1.
NOTE: There were 1396 observations read from the data set WORK.LEV2.
NOTE: There were 4804 observations read from the data set WORK.LEV3.
NOTE: There were 8866 observations read from the data set WORK.LEV4.
NOTE: There were 8866 observations read from the data set WORK.LEV5.
NOTE: There were 1180 observations read from the data set WORK.LEVST1.
NOTE: There were 1180 observations read from the data set WORK.LEVST2.
NOTE: There were 3464 observations read from the data set WORK.LEVST3.
NOTE: There were 2756 observations read from the data set WORK.LEVST4.
NOTE: There were 756 observations read from the data set WORK.LEVST5.
NOTE: There were 2226 observations read from the data set WORK.LEVST6.
NOTE: There were 1880 observations read from the data set WORK.LEVST7.
NOTE: There were 564 observations read from the data set WORK.LEVST8.
NOTE: There were 694 observations read from the data set WORK.LEVST9.
NOTE: There were 694 observations read from the data set WORK.LEVST10.
NOTE: The data set WORK.AGGMAST has 52784 observations and 75 variables.
NOTE: Compressing data set WORK.AGGMAST decreased size by 42.84 percent. 
      Compressed is 539 pages; un-compressed would require 943 pages.
NOTE: DATA statement used (Total process time):
      real time           0.46 seconds
      cpu time            0.44 seconds
      

MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(AGGSALES_ISCAN):  ;
MPRINT(AGGREGATION_ISCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data masteraa;
MPRINT(AGGSTORE_INFOSCAN):   set master;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTER.
NOTE: The data set WORK.MASTERAA has 13078 observations and 75 variables.
NOTE: Compressing data set WORK.MASTERAA decreased size by 50.85 percent. 
      Compressed is 115 pages; un-compressed would require 234 pages.
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.11 seconds
      

MPRINT(SORTEM):   proc sort data=masteraa;
MPRINT(SORTEM):   by g1 s1 week store ean;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTERAA.
NOTE: The data set WORK.MASTERAA has 13078 observations and 75 variables.
NOTE: Compressing data set WORK.MASTERAA decreased size by 50.85 percent. 
      Compressed is 115 pages; un-compressed would require 234 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.11 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=masteraa noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store ean;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=storeean(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTERAA.
NOTE: The data set WORK.STOREEAN has 13078 observations and 18 variables.
NOTE: Compressing data set WORK.STOREEAN decreased size by 22.98 percent. 
      Compressed is 181 pages; un-compressed would require 235 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.18 seconds
      cpu time            0.19 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   run;
MPRINT(SORTEM):   proc sort data=masteraa;
MPRINT(SORTEM):   by g1 s1 week store lev1 lev2 lev3 lev4 lev5;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTERAA.
NOTE: The data set WORK.MASTERAA has 13078 observations and 75 variables.
NOTE: Compressing data set WORK.MASTERAA decreased size by 50.85 percent. 
      Compressed is 115 pages; un-compressed would require 234 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.14 seconds
      cpu time            0.14 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=masteraa noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev1(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTERAA.
NOTE: The data set WORK.LEV1 has 380 observations and 18 variables.
NOTE: Compressing data set WORK.LEV1 decreased size by 0.00 percent. 
      Compressed is 7 pages; un-compressed would require 7 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.05 seconds
      cpu time            0.06 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: The data set WORK.MINSTORE has 380 observations and 5 variables.
NOTE: Compressing data set WORK.MINSTORE increased size by 100.00 percent. 
      Compressed is 4 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=lev1;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 380 observations read from the data set WORK.LEV1.
NOTE: The data set WORK.LEV1 has 380 observations and 18 variables.
NOTE: Compressing data set WORK.LEV1 decreased size by 0.00 percent. 
      Compressed is 7 pages; un-compressed would require 7 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data lev1;
MPRINT(AGGSTORE_INFOSCAN):   merge lev1(in=a) minstore(in=b);
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 380 observations read from the data set WORK.LEV1.
NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: The data set WORK.LEV1 has 380 observations and 18 variables.
NOTE: Compressing data set WORK.LEV1 decreased size by 0.00 percent. 
      Compressed is 7 pages; un-compressed would require 7 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   run;
MPRINT(SORTEM):   proc sort data=lev1;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 380 observations read from the data set WORK.LEV1.
NOTE: The data set WORK.LEV1 has 380 observations and 18 variables.
NOTE: Compressing data set WORK.LEV1 decreased size by 0.00 percent. 
      Compressed is 7 pages; un-compressed would require 7 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=lev1 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period REGFACT REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev1(drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 380 observations read from the data set WORK.LEV1.
NOTE: The data set WORK.LEV1 has 10 observations and 14 variables.
NOTE: Compressing data set WORK.LEV1 increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   proc summary data=masteraa noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1 lev2;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev2(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTERAA.
NOTE: The data set WORK.LEV2 has 1396 observations and 19 variables.
NOTE: Compressing data set WORK.LEV2 decreased size by 15.38 percent. 
      Compressed is 22 pages; un-compressed would require 26 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=lev2;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 1396 observations read from the data set WORK.LEV2.
NOTE: The data set WORK.LEV2 has 1396 observations and 19 variables.
NOTE: Compressing data set WORK.LEV2 decreased size by 15.38 percent. 
      Compressed is 22 pages; un-compressed would require 26 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data lev2;
MPRINT(AGGSTORE_INFOSCAN):   merge lev2(in=a) minstore(in=b);
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 1396 observations read from the data set WORK.LEV2.
NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: The data set WORK.LEV2 has 1396 observations and 19 variables.
NOTE: Compressing data set WORK.LEV2 decreased size by 15.38 percent. 
      Compressed is 22 pages; un-compressed would require 26 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   run;
MPRINT(SORTEM):   proc sort data=lev2;
MPRINT(SORTEM):   by g1 s1 week lev1 lev2;
MPRINT(SORTEM):   run;

NOTE: There were 1396 observations read from the data set WORK.LEV2.
NOTE: The data set WORK.LEV2 has 1396 observations and 19 variables.
NOTE: Compressing data set WORK.LEV2 decreased size by 15.38 percent. 
      Compressed is 22 pages; un-compressed would require 26 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=lev2 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1 lev2;
MPRINT(AGGSTORE_INFOSCAN):   id period REGFACT REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev2(drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 1396 observations read from the data set WORK.LEV2.
NOTE: The data set WORK.LEV2 has 50 observations and 15 variables.
NOTE: Compressing data set WORK.LEV2 decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   proc summary data=masteraa noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1 lev2 lev3;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev3(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTERAA.
NOTE: The data set WORK.LEV3 has 4804 observations and 20 variables.
NOTE: Compressing data set WORK.LEV3 decreased size by 25.00 percent. 
      Compressed is 69 pages; un-compressed would require 92 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.10 seconds
      cpu time            0.10 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=lev3;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 4804 observations read from the data set WORK.LEV3.
NOTE: The data set WORK.LEV3 has 4804 observations and 20 variables.
NOTE: Compressing data set WORK.LEV3 decreased size by 25.00 percent. 
      Compressed is 69 pages; un-compressed would require 92 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data lev3;
MPRINT(AGGSTORE_INFOSCAN):   merge lev3(in=a) minstore(in=b);
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 4804 observations read from the data set WORK.LEV3.
NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: The data set WORK.LEV3 has 4804 observations and 20 variables.
NOTE: Compressing data set WORK.LEV3 decreased size by 25.00 percent. 
      Compressed is 69 pages; un-compressed would require 92 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.04 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   run;
MPRINT(SORTEM):   proc sort data=lev3;
MPRINT(SORTEM):   by g1 s1 week lev1 lev2 lev3;
MPRINT(SORTEM):   run;

NOTE: There were 4804 observations read from the data set WORK.LEV3.
NOTE: The data set WORK.LEV3 has 4804 observations and 20 variables.
NOTE: Compressing data set WORK.LEV3 decreased size by 25.00 percent. 
      Compressed is 69 pages; un-compressed would require 92 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=lev3 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1 lev2 lev3;
MPRINT(AGGSTORE_INFOSCAN):   id period REGFACT REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev3(drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 4804 observations read from the data set WORK.LEV3.
NOTE: The data set WORK.LEV3 has 172 observations and 16 variables.
NOTE: Compressing data set WORK.LEV3 decreased size by 0.00 percent. 
      Compressed is 4 pages; un-compressed would require 4 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   proc summary data=masteraa noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1 lev2 lev3 lev4;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev4(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTERAA.
NOTE: The data set WORK.LEV4 has 8866 observations and 21 variables.
NOTE: Compressing data set WORK.LEV4 decreased size by 27.27 percent. 
      Compressed is 64 pages; un-compressed would require 88 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.14 seconds
      cpu time            0.14 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=lev4;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 8866 observations read from the data set WORK.LEV4.
NOTE: The data set WORK.LEV4 has 8866 observations and 21 variables.
NOTE: Compressing data set WORK.LEV4 decreased size by 27.27 percent. 
      Compressed is 64 pages; un-compressed would require 88 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data lev4;
MPRINT(AGGSTORE_INFOSCAN):   merge lev4(in=a) minstore(in=b);
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 8866 observations read from the data set WORK.LEV4.
NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: The data set WORK.LEV4 has 8866 observations and 21 variables.
NOTE: Compressing data set WORK.LEV4 decreased size by 27.27 percent. 
      Compressed is 64 pages; un-compressed would require 88 pages.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.05 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   run;
MPRINT(SORTEM):   proc sort data=lev4;
MPRINT(SORTEM):   by g1 s1 week lev1 lev2 lev3 lev4;
MPRINT(SORTEM):   run;

NOTE: There were 8866 observations read from the data set WORK.LEV4.
NOTE: The data set WORK.LEV4 has 8866 observations and 21 variables.
NOTE: Compressing data set WORK.LEV4 decreased size by 27.27 percent. 
      Compressed is 64 pages; un-compressed would require 88 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.04 seconds
      cpu time            0.05 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=lev4 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1 lev2 lev3 lev4;
MPRINT(AGGSTORE_INFOSCAN):   id period REGFACT REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev4(drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 8866 observations read from the data set WORK.LEV4.
NOTE: The data set WORK.LEV4 has 346 observations and 17 variables.
NOTE: Compressing data set WORK.LEV4 decreased size by 0.00 percent. 
      Compressed is 6 pages; un-compressed would require 6 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   proc summary data=masteraa noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1 lev2 lev3 lev4 lev5;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev5(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.MASTERAA.
NOTE: The data set WORK.LEV5 has 8866 observations and 22 variables.
NOTE: Compressing data set WORK.LEV5 decreased size by 28.26 percent. 
      Compressed is 66 pages; un-compressed would require 92 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.14 seconds
      cpu time            0.14 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=lev5;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 8866 observations read from the data set WORK.LEV5.
NOTE: The data set WORK.LEV5 has 8866 observations and 22 variables.
NOTE: Compressing data set WORK.LEV5 decreased size by 28.26 percent. 
      Compressed is 66 pages; un-compressed would require 92 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.04 seconds
      cpu time            0.05 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data lev5;
MPRINT(AGGSTORE_INFOSCAN):   merge lev5(in=a) minstore(in=b);
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 8866 observations read from the data set WORK.LEV5.
NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: The data set WORK.LEV5 has 8866 observations and 22 variables.
NOTE: Compressing data set WORK.LEV5 decreased size by 28.26 percent. 
      Compressed is 66 pages; un-compressed would require 92 pages.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.05 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   run;
MPRINT(SORTEM):   proc sort data=lev5;
MPRINT(SORTEM):   by g1 s1 week lev1 lev2 lev3 lev4 lev5;
MPRINT(SORTEM):   run;

NOTE: There were 8866 observations read from the data set WORK.LEV5.
NOTE: The data set WORK.LEV5 has 8866 observations and 22 variables.
NOTE: Compressing data set WORK.LEV5 decreased size by 28.26 percent. 
      Compressed is 66 pages; un-compressed would require 92 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.04 seconds
      cpu time            0.05 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=lev5 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1 lev2 lev3 lev4 lev5;
MPRINT(AGGSTORE_INFOSCAN):   id period REGFACT REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=lev5(drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 8866 observations read from the data set WORK.LEV5.
NOTE: The data set WORK.LEV5 has 346 observations and 18 variables.
NOTE: Compressing data set WORK.LEV5 decreased size by 14.29 percent. 
      Compressed is 6 pages; un-compressed would require 7 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=storeean;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.STOREEAN.
NOTE: The data set WORK.STOREEAN has 13078 observations and 18 variables.
NOTE: Compressing data set WORK.STOREEAN decreased size by 22.98 percent. 
      Compressed is 181 pages; un-compressed would require 235 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.05 seconds
      cpu time            0.07 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data storeean ;
MPRINT(MATCHMERGE):   merge minstore (in=a) storeean (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 13078 observations read from the data set WORK.STOREEAN.
NOTE: The data set WORK.STOREEAN has 13078 observations and 19 variables.
NOTE: Compressing data set WORK.STOREEAN decreased size by 24.19 percent. 
      Compressed is 188 pages; un-compressed would require 248 pages.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.07 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data storeean;
MPRINT(AGGSTORE_INFOSCAN):   set storeean;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.STOREEAN.
NOTE: The data set WORK.STOREEAN has 13078 observations and 18 variables.
NOTE: Compressing data set WORK.STOREEAN decreased size by 22.98 percent. 
      Compressed is 181 pages; un-compressed would require 235 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.05 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   run;
MPRINT(SORTEM):   proc sort data=storeean;
MPRINT(SORTEM):   by g1 s1 week EAN;
MPRINT(SORTEM):   run;

NOTE: There were 13078 observations read from the data set WORK.STOREEAN.
NOTE: The data set WORK.STOREEAN has 13078 observations and 18 variables.
NOTE: Compressing data set WORK.STOREEAN decreased size by 22.98 percent. 
      Compressed is 181 pages; un-compressed would require 235 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.05 seconds
      cpu time            0.05 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc means data=storeean noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week EAN;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=storeean(drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 13078 observations read from the data set WORK.STOREEAN.
NOTE: The data set WORK.STOREEAN has 774 observations and 14 variables.
NOTE: Compressing data set WORK.STOREEAN decreased size by 16.67 percent. 
      Compressed is 10 pages; un-compressed would require 12 pages.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.04 seconds
      cpu time            0.05 seconds
      

MPRINT(SORTEM):   proc sort data=storeean;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: There were 774 observations read from the data set WORK.STOREEAN.
NOTE: The data set WORK.STOREEAN has 774 observations and 14 variables.
NOTE: Compressing data set WORK.STOREEAN decreased size by 16.67 percent. 
      Compressed is 10 pages; un-compressed would require 12 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=code;
MPRINT(SORTEM):   by ean;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data storeean ;
MPRINT(MATCHMERGE):   merge storeean (in=a) code (in=b) ;
MPRINT(MATCHMERGE):   by ean ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 774 observations read from the data set WORK.STOREEAN.
NOTE: There were 1000 observations read from the data set WORK.CODE.
NOTE: The data set WORK.STOREEAN has 774 observations and 19 variables.
NOTE: Compressing data set WORK.STOREEAN decreased size by 25.00 percent. 
      Compressed is 12 pages; un-compressed would require 16 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=secmas1;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas1 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst1(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS1.
NOTE: The data set WORK.LEVST1 has 1180 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST1 decreased size by 14.29 percent. 
      Compressed is 18 pages; un-compressed would require 21 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst1;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 1180 observations read from the data set WORK.LEVST1.
NOTE: The data set WORK.LEVST1 has 1180 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST1 decreased size by 14.29 percent. 
      Compressed is 18 pages; un-compressed would require 21 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst1 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst1 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 1180 observations read from the data set WORK.LEVST1.
NOTE: The data set WORK.LEVST1 has 1180 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST1 decreased size by 13.64 percent. 
      Compressed is 19 pages; un-compressed would require 22 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst1;
MPRINT(AGGSTORE_INFOSCAN):   set levst1;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 1180 observations read from the data set WORK.LEVST1.
NOTE: The data set WORK.LEVST1 has 1180 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST1 decreased size by 14.29 percent. 
      Compressed is 18 pages; un-compressed would require 21 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(SORTEM):   proc sort data=levst1;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 1180 observations read from the data set WORK.LEVST1.
NOTE: The data set WORK.LEVST1 has 1180 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST1 decreased size by 14.29 percent. 
      Compressed is 18 pages; un-compressed would require 21 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst1 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst1 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 1180 observations read from the data set WORK.LEVST1.
NOTE: The data set WORK.LEVST1 has 40 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST1 decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(SORTEM):   proc sort data=secmas2;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas2 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst2(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS2.
NOTE: The data set WORK.LEVST2 has 1180 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST2 decreased size by 14.29 percent. 
      Compressed is 18 pages; un-compressed would require 21 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst2;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 1180 observations read from the data set WORK.LEVST2.
NOTE: The data set WORK.LEVST2 has 1180 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST2 decreased size by 14.29 percent. 
      Compressed is 18 pages; un-compressed would require 21 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst2 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst2 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 1180 observations read from the data set WORK.LEVST2.
NOTE: The data set WORK.LEVST2 has 1180 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST2 decreased size by 13.64 percent. 
      Compressed is 19 pages; un-compressed would require 22 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst2;
MPRINT(AGGSTORE_INFOSCAN):   set levst2;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 1180 observations read from the data set WORK.LEVST2.
NOTE: The data set WORK.LEVST2 has 1180 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST2 decreased size by 14.29 percent. 
      Compressed is 18 pages; un-compressed would require 21 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=levst2;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 1180 observations read from the data set WORK.LEVST2.
NOTE: The data set WORK.LEVST2 has 1180 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST2 decreased size by 14.29 percent. 
      Compressed is 18 pages; un-compressed would require 21 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst2 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst2 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 1180 observations read from the data set WORK.LEVST2.
NOTE: The data set WORK.LEVST2 has 40 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST2 decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(SORTEM):   proc sort data=secmas3;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas3 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst3(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS3.
NOTE: The data set WORK.LEVST3 has 3464 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST3 decreased size by 21.67 percent. 
      Compressed is 47 pages; un-compressed would require 60 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.08 seconds
      cpu time            0.08 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst3;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 3464 observations read from the data set WORK.LEVST3.
NOTE: The data set WORK.LEVST3 has 3464 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST3 decreased size by 21.67 percent. 
      Compressed is 47 pages; un-compressed would require 60 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst3 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst3 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 3464 observations read from the data set WORK.LEVST3.
NOTE: The data set WORK.LEVST3 has 3464 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST3 decreased size by 22.22 percent. 
      Compressed is 49 pages; un-compressed would require 63 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst3;
MPRINT(AGGSTORE_INFOSCAN):   set levst3;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 3464 observations read from the data set WORK.LEVST3.
NOTE: The data set WORK.LEVST3 has 3464 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST3 decreased size by 21.67 percent. 
      Compressed is 47 pages; un-compressed would require 60 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=levst3;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 3464 observations read from the data set WORK.LEVST3.
NOTE: The data set WORK.LEVST3 has 3464 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST3 decreased size by 21.67 percent. 
      Compressed is 47 pages; un-compressed would require 60 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst3 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst3 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 3464 observations read from the data set WORK.LEVST3.
NOTE: The data set WORK.LEVST3 has 120 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST3 decreased size by 0.00 percent. 
      Compressed is 3 pages; un-compressed would require 3 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(SORTEM):   proc sort data=secmas4;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas4 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst4(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS4.
NOTE: The data set WORK.LEVST4 has 2756 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST4 decreased size by 20.83 percent. 
      Compressed is 38 pages; un-compressed would require 48 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.08 seconds
      cpu time            0.08 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst4;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 2756 observations read from the data set WORK.LEVST4.
NOTE: The data set WORK.LEVST4 has 2756 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST4 decreased size by 20.83 percent. 
      Compressed is 38 pages; un-compressed would require 48 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst4 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst4 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 2756 observations read from the data set WORK.LEVST4.
NOTE: The data set WORK.LEVST4 has 2756 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST4 decreased size by 20.00 percent. 
      Compressed is 40 pages; un-compressed would require 50 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst4;
MPRINT(AGGSTORE_INFOSCAN):   set levst4;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 2756 observations read from the data set WORK.LEVST4.
NOTE: The data set WORK.LEVST4 has 2756 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST4 decreased size by 20.83 percent. 
      Compressed is 38 pages; un-compressed would require 48 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=levst4;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 2756 observations read from the data set WORK.LEVST4.
NOTE: The data set WORK.LEVST4 has 2756 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST4 decreased size by 20.83 percent. 
      Compressed is 38 pages; un-compressed would require 48 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst4 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst4 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 2756 observations read from the data set WORK.LEVST4.
NOTE: The data set WORK.LEVST4 has 100 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST4 increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(SORTEM):   proc sort data=secmas5;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas5 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst5(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS5.
NOTE: The data set WORK.LEVST5 has 756 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST5 decreased size by 7.14 percent. 
      Compressed is 13 pages; un-compressed would require 14 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.05 seconds
      cpu time            0.06 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst5;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 756 observations read from the data set WORK.LEVST5.
NOTE: The data set WORK.LEVST5 has 756 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST5 decreased size by 7.14 percent. 
      Compressed is 13 pages; un-compressed would require 14 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst5 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst5 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 756 observations read from the data set WORK.LEVST5.
NOTE: The data set WORK.LEVST5 has 756 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST5 decreased size by 13.33 percent. 
      Compressed is 13 pages; un-compressed would require 15 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst5;
MPRINT(AGGSTORE_INFOSCAN):   set levst5;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 756 observations read from the data set WORK.LEVST5.
NOTE: The data set WORK.LEVST5 has 756 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST5 decreased size by 7.14 percent. 
      Compressed is 13 pages; un-compressed would require 14 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=levst5;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 756 observations read from the data set WORK.LEVST5.
NOTE: The data set WORK.LEVST5 has 756 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST5 decreased size by 7.14 percent. 
      Compressed is 13 pages; un-compressed would require 14 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst5 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst5 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 756 observations read from the data set WORK.LEVST5.
NOTE: The data set WORK.LEVST5 has 20 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST5 increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(SORTEM):   proc sort data=secmas6;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas6 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst6(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS6.
NOTE: The data set WORK.LEVST6 has 2226 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST6 decreased size by 17.95 percent. 
      Compressed is 32 pages; un-compressed would require 39 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.07 seconds
      cpu time            0.08 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst6;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 2226 observations read from the data set WORK.LEVST6.
NOTE: The data set WORK.LEVST6 has 2226 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST6 decreased size by 17.95 percent. 
      Compressed is 32 pages; un-compressed would require 39 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst6 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst6 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 2226 observations read from the data set WORK.LEVST6.
NOTE: The data set WORK.LEVST6 has 2226 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST6 decreased size by 19.51 percent. 
      Compressed is 33 pages; un-compressed would require 41 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst6;
MPRINT(AGGSTORE_INFOSCAN):   set levst6;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 2226 observations read from the data set WORK.LEVST6.
NOTE: The data set WORK.LEVST6 has 2226 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST6 decreased size by 17.95 percent. 
      Compressed is 32 pages; un-compressed would require 39 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(SORTEM):   proc sort data=levst6;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 2226 observations read from the data set WORK.LEVST6.
NOTE: The data set WORK.LEVST6 has 2226 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST6 decreased size by 17.95 percent. 
      Compressed is 32 pages; un-compressed would require 39 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst6 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst6 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 2226 observations read from the data set WORK.LEVST6.
NOTE: The data set WORK.LEVST6 has 70 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST6 increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=secmas7;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas7 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst7(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS7.
NOTE: The data set WORK.LEVST7 has 1880 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST7 decreased size by 18.18 percent. 
      Compressed is 27 pages; un-compressed would require 33 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst7;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 1880 observations read from the data set WORK.LEVST7.
NOTE: The data set WORK.LEVST7 has 1880 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST7 decreased size by 18.18 percent. 
      Compressed is 27 pages; un-compressed would require 33 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst7 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst7 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 1880 observations read from the data set WORK.LEVST7.
NOTE: The data set WORK.LEVST7 has 1880 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST7 decreased size by 20.00 percent. 
      Compressed is 28 pages; un-compressed would require 35 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst7;
MPRINT(AGGSTORE_INFOSCAN):   set levst7;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 1880 observations read from the data set WORK.LEVST7.
NOTE: The data set WORK.LEVST7 has 1880 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST7 decreased size by 18.18 percent. 
      Compressed is 27 pages; un-compressed would require 33 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=levst7;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 1880 observations read from the data set WORK.LEVST7.
NOTE: The data set WORK.LEVST7 has 1880 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST7 decreased size by 18.18 percent. 
      Compressed is 27 pages; un-compressed would require 33 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst7 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst7 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 1880 observations read from the data set WORK.LEVST7.
NOTE: The data set WORK.LEVST7 has 60 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST7 increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=secmas8;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas8 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst8(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS8.
NOTE: The data set WORK.LEVST8 has 564 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST8 decreased size by 9.09 percent. 
      Compressed is 10 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.05 seconds
      cpu time            0.06 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst8;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 564 observations read from the data set WORK.LEVST8.
NOTE: The data set WORK.LEVST8 has 564 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST8 decreased size by 9.09 percent. 
      Compressed is 10 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst8 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst8 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 564 observations read from the data set WORK.LEVST8.
NOTE: The data set WORK.LEVST8 has 564 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST8 decreased size by 9.09 percent. 
      Compressed is 10 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst8;
MPRINT(AGGSTORE_INFOSCAN):   set levst8;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 564 observations read from the data set WORK.LEVST8.
NOTE: The data set WORK.LEVST8 has 564 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST8 decreased size by 9.09 percent. 
      Compressed is 10 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(SORTEM):   proc sort data=levst8;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 564 observations read from the data set WORK.LEVST8.
NOTE: The data set WORK.LEVST8 has 564 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST8 decreased size by 9.09 percent. 
      Compressed is 10 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst8 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst8 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 564 observations read from the data set WORK.LEVST8.
NOTE: The data set WORK.LEVST8 has 20 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST8 increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=secmas9;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas9 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst9(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS9.
NOTE: The data set WORK.LEVST9 has 694 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST9 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.05 seconds
      cpu time            0.05 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst9;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 694 observations read from the data set WORK.LEVST9.
NOTE: The data set WORK.LEVST9 has 694 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST9 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst9 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst9 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 694 observations read from the data set WORK.LEVST9.
NOTE: The data set WORK.LEVST9 has 694 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST9 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst9;
MPRINT(AGGSTORE_INFOSCAN):   set levst9;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 694 observations read from the data set WORK.LEVST9.
NOTE: The data set WORK.LEVST9 has 694 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST9 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(SORTEM):   proc sort data=levst9;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 694 observations read from the data set WORK.LEVST9.
NOTE: The data set WORK.LEVST9 has 694 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST9 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst9 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst9 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 694 observations read from the data set WORK.LEVST9.
NOTE: The data set WORK.LEVST9 has 30 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST9 increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(SORTEM):   proc sort data=secmas10;
MPRINT(SORTEM):   by g1 s1 week store lev1;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=secmas10 noprint;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week store lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult stacv regacv ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst10(drop=_freq_ _type_) max= ;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 13078 observations read from the data set WORK.SECMAS10.
NOTE: The data set WORK.LEVST10 has 694 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST10 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
      

MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(SORTEM):   proc sort data=levst10;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 694 observations read from the data set WORK.LEVST10.
NOTE: The data set WORK.LEVST10 has 694 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST10 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(MATCHMERGE):   data levst10 ;
MPRINT(MATCHMERGE):   merge minstore (in=a) levst10 (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 694 observations read from the data set WORK.LEVST10.
NOTE: The data set WORK.LEVST10 has 694 observations and 19 variables.
NOTE: Compressing data set WORK.LEVST10 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   data levst10;
MPRINT(AGGSTORE_INFOSCAN):   set levst10;
MPRINT(AGGSTORE_INFOSCAN):   numult=minwgt;
MPRINT(AGGSTORE_INFOSCAN):   drop minwgt;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 694 observations read from the data set WORK.LEVST10.
NOTE: The data set WORK.LEVST10 has 694 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST10 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=levst10;
MPRINT(SORTEM):   by g1 s1 week lev1;
MPRINT(SORTEM):   run;

NOTE: There were 694 observations read from the data set WORK.LEVST10.
NOTE: The data set WORK.LEVST10 has 694 observations and 18 variables.
NOTE: Compressing data set WORK.LEVST10 decreased size by 7.69 percent. 
      Compressed is 12 pages; un-compressed would require 13 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGSTORE_INFOSCAN):   proc summary data=levst10 nway;
MPRINT(AGGSTORE_INFOSCAN):   by g1 s1 week lev1;
MPRINT(AGGSTORE_INFOSCAN):   id period regfact REGCATLEN regcatfac NUMULT regvalue;
MPRINT(AGGSTORE_INFOSCAN):   var stcatval stcatvaf stcatvad stcatvp stcatvmr numult ;
MPRINT(AGGSTORE_INFOSCAN):   output out=levst10 (drop=_type_ _freq_) sum=stcatval stcatvaf stcatvad stcatvp stcatvmr ;

NOTE: There were 694 observations read from the data set WORK.LEVST10.
NOTE: The data set WORK.LEVST10 has 30 observations and 15 variables.
NOTE: Compressing data set WORK.LEVST10 increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   data aggstore;
MPRINT(AGGSTORE_INFOSCAN):   set storeean lev1 lev2 lev3 lev4 lev5;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 774 observations read from the data set WORK.STOREEAN.
NOTE: There were 10 observations read from the data set WORK.LEV1.
NOTE: There were 50 observations read from the data set WORK.LEV2.
NOTE: There were 172 observations read from the data set WORK.LEV3.
NOTE: There were 346 observations read from the data set WORK.LEV4.
NOTE: There were 346 observations read from the data set WORK.LEV5.
NOTE: The data set WORK.AGGSTORE has 1698 observations and 19 variables.
NOTE: Compressing data set WORK.AGGSTORE decreased size by 27.27 percent. 
      Compressed is 24 pages; un-compressed would require 33 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(AGGSTORE_INFOSCAN):   data aggstore;
MPRINT(AGGSTORE_INFOSCAN):   set aggstore levst1 levst2 levst3 levst4 levst5 levst6 levst7 levst8 levst9 levst10;
MPRINT(AGGSTORE_INFOSCAN):   run;

NOTE: There were 1698 observations read from the data set WORK.AGGSTORE.
NOTE: There were 40 observations read from the data set WORK.LEVST1.
NOTE: There were 40 observations read from the data set WORK.LEVST2.
NOTE: There were 120 observations read from the data set WORK.LEVST3.
NOTE: There were 100 observations read from the data set WORK.LEVST4.
NOTE: There were 20 observations read from the data set WORK.LEVST5.
NOTE: There were 70 observations read from the data set WORK.LEVST6.
NOTE: There were 60 observations read from the data set WORK.LEVST7.
NOTE: There were 20 observations read from the data set WORK.LEVST8.
NOTE: There were 30 observations read from the data set WORK.LEVST9.
NOTE: There were 30 observations read from the data set WORK.LEVST10.
NOTE: The data set WORK.AGGSTORE has 2228 observations and 20 variables.
NOTE: Compressing data set WORK.AGGSTORE decreased size by 30.43 percent. 
      Compressed is 32 pages; un-compressed would require 46 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(AGGSTORE_INFOSCAN):  ;
MPRINT(AGGREGATION_ISCAN):  ;
MPRINT(SORTEM):   proc sort data=minstore;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(GEOPREP):  ;
MPRINT(SORTEM):   proc sort data=aggmast;
MPRINT(SORTEM):   by g1 s1 week store;
MPRINT(SORTEM):   run;

NOTE: There were 52784 observations read from the data set WORK.AGGMAST.
NOTE: The data set WORK.AGGMAST has 52784 observations and 75 variables.
NOTE: Compressing data set WORK.AGGMAST decreased size by 42.84 percent. 
      Compressed is 539 pages; un-compressed would require 943 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.55 seconds
      cpu time            0.55 seconds
      

MPRINT(GEOPREP):  ;
MPRINT(MATCHMERGE):   data aggmast ;
MPRINT(MATCHMERGE):   merge minstore (in=a) aggmast (in=b) ;
MPRINT(MATCHMERGE):   by g1 s1 week store ;
MPRINT(MATCHMERGE):   if a and b;
MPRINT(MATCHMERGE):   run;

NOTE: There were 380 observations read from the data set WORK.MINSTORE.
NOTE: There were 52784 observations read from the data set WORK.AGGMAST.
NOTE: The data set WORK.AGGMAST has 52784 observations and 76 variables.
NOTE: Compressing data set WORK.AGGMAST decreased size by 43.18 percent. 
      Compressed is 546 pages; un-compressed would require 961 pages.
NOTE: DATA statement used (Total process time):
      real time           0.51 seconds
      cpu time            0.51 seconds
      

MPRINT(GEOPREP):  ;
MPRINT(GEOPREP):   data aggmast(drop=k);
MPRINT(GEOPREP):   set aggmast;
MPRINT(GEOPREP):   array misscheck {5} lev1-lev5 ;
MPRINT(GEOPREP):   if ean='' then ean='00000000000000';
MPRINT(GEOPREP):   do k=1 to 5 ;
MPRINT(GEOPREP):   if misscheck{k}=. then misscheck{k}=0;
MPRINT(GEOPREP):   end;
MPRINT(GEOPREP):   length lineitem $34;
MPRINT(GEOPREP):   lineitem=compbl(lev1 || lev2 || lev3 || lev4 || lev5 || ean);
MPRINT(GEOPREP):   nums=(units > 0) * numult;
MPRINT(GEOPREP):  *sales;
MPRINT(GEOPREP):   svals=(units > 0) * stcatval;
MPRINT(GEOPREP):  *sales;
MPRINT(GEOPREP):   acvs=(units > 0) * stacv;
MPRINT(GEOPREP):  *stacv;
MPRINT(GEOPREP):   PNUMS=nums;
MPRINT(GEOPREP):   PNUMEAN=NUMEAN*numult;
MPRINT(GEOPREP):   numsfac=(pnumfac > 0);
MPRINT(GEOPREP):   pnumsfac=numsfac*numult;
MPRINT(GEOPREP):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5103:139   5103:5     5103:5     5103:5     5103:5     
NOTE: There were 52784 observations read from the data set WORK.AGGMAST.
NOTE: The data set WORK.AGGMAST has 52784 observations and 84 variables.
NOTE: Compressing data set WORK.AGGMAST decreased size by 44.32 percent. 
      Compressed is 613 pages; un-compressed would require 1101 pages.
NOTE: DATA statement used (Total process time):
      real time           0.57 seconds
      cpu time            0.58 seconds
      

MPRINT(SORTEM):   proc sort data=aggmast;
MPRINT(SORTEM):   by g1 s1 week lineitem;
MPRINT(SORTEM):   run;

NOTE: There were 52784 observations read from the data set WORK.AGGMAST.
NOTE: The data set WORK.AGGMAST has 52784 observations and 84 variables.
NOTE: Compressing data set WORK.AGGMAST decreased size by 44.32 percent. 
      Compressed is 613 pages; un-compressed would require 1101 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.58 seconds
      cpu time            0.59 seconds
      

MPRINT(GEOPREP):  ;
MPRINT(GEOPREP):   proc summary data=aggmast noprint;
MPRINT(GEOPREP):   id period factor stcatval regvalue regfact stacv regacv regcatlen regcatfac;
MPRINT(GEOPREP):   by g1 s1 week lineitem ;
MPRINT(GEOPREP):   var units volume value nums svals acvs pnums PNUMEAN PNUMFAC PLENFAC NUMSFAC PNUMSFAC bvalp incvalp valp incvolm bvolm inczerov stcatvaf stcatvad stcatvp stcatvmr incvalm bvalm mkvalm volamspack valamspack ;
MPRINT(GEOPREP):   output out=alltot(drop=_type_ _freq_) sum= ;
MPRINT(GEOPREP):   run;

NOTE: There were 52784 observations read from the data set WORK.AGGMAST.
NOTE: The data set WORK.ALLTOT has 2228 observations and 40 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 27.66 percent. 
      Compressed is 34 pages; un-compressed would require 47 pages.
NOTE: PROCEDURE SUMMARY used (Total process time):
      real time           0.31 seconds
      cpu time            0.31 seconds
      

MPRINT(GEOPREP):   data aggstore(drop=k);
MPRINT(GEOPREP):   set aggstore;
MPRINT(GEOPREP):   array misscheck {5} lev1-lev5 ;
MPRINT(GEOPREP):   if ean='' then ean='00000000000000';
MPRINT(GEOPREP):   do k=1 to 5 ;
MPRINT(GEOPREP):   if misscheck{k}=. then misscheck{k}=0;
MPRINT(GEOPREP):   end;
MPRINT(GEOPREP):   length lineitem $34;
MPRINT(GEOPREP):   lineitem=compbl(lev1 || lev2 || lev3 || lev4 || lev5 || ean);

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5103:250   5103:5     5103:5     5103:5     5103:5     
NOTE: There were 2228 observations read from the data set WORK.AGGSTORE.
NOTE: The data set WORK.AGGSTORE has 2228 observations and 21 variables.
NOTE: Compressing data set WORK.AGGSTORE decreased size by 33.33 percent. 
      Compressed is 18 pages; un-compressed would require 27 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(GEOPREP):   proc sort data=alltot;
MPRINT(GEOPREP):   by g1 s1 week lineitem;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 40 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 27.66 percent. 
      Compressed is 34 pages; un-compressed would require 47 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(GEOPREP):   proc sort data=aggstore;
MPRINT(GEOPREP):   by g1 s1 week lineitem;

NOTE: There were 2228 observations read from the data set WORK.AGGSTORE.
NOTE: The data set WORK.AGGSTORE has 2228 observations and 21 variables.
NOTE: Compressing data set WORK.AGGSTORE decreased size by 33.33 percent. 
      Compressed is 18 pages; un-compressed would require 27 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(GEOPREP):   data alltot;
MPRINT(GEOPREP):   merge alltot(in=a) aggstore(in=b);
MPRINT(GEOPREP):   by g1 s1 week lineitem;
MPRINT(GEOPREP):   if a;
MPRINT(GEOPREP):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: There were 2228 observations read from the data set WORK.AGGSTORE.
NOTE: The data set WORK.ALLTOT has 2228 observations and 47 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 32.43 percent. 
      Compressed is 25 pages; un-compressed would require 37 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      

MPRINT(SORTEM):   proc sort data=alltot;
MPRINT(SORTEM):   by g1 s1 week;
MPRINT(SORTEM):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 47 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 32.43 percent. 
      Compressed is 25 pages; un-compressed would require 37 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.03 seconds
      

MPRINT(GEOPREP):  ;
MPRINT(SORTEM):   proc sort data=tstctval;
MPRINT(SORTEM):   by g1 s1 week;
MPRINT(SORTEM):   run;

NOTE: There were 10 observations read from the data set WORK.TSTCTVAL.
NOTE: The data set WORK.TSTCTVAL has 10 observations and 7 variables.
NOTE: Compressing data set WORK.TSTCTVAL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(GEOPREP):  ;
MPRINT(GEOPREP):   data alltot;
MPRINT(GEOPREP):   merge alltot tstctval;
MPRINT(GEOPREP):   by g1 s1 week;
MPRINT(GEOPREP):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: There were 10 observations read from the data set WORK.TSTCTVAL.
NOTE: The data set WORK.ALLTOT has 2228 observations and 51 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 31.71 percent. 
      Compressed is 28 pages; un-compressed would require 41 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(GEOPREP):  ;
MPRINT(AGGREGATION_ISCAN):  ;
MPRINT(MAIN):  ;
MPRINT(CREATEMEASURES):   data alltot;
MPRINT(CREATEMEASURES):   set alltot;
MPRINT(CREATEMEASURES):   lev1=scan(lineitem,1)*1;
MPRINT(CREATEMEASURES):   lev2=scan(lineitem,2)*1;
MPRINT(CREATEMEASURES):   run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      5103:38   5103:63   
NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 51 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 31.71 percent. 
      Compressed is 28 pages; un-compressed would require 41 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATEMEASURES):   proc sort data=alltot;
MPRINT(CREATEMEASURES):   by lev1 lev2;
MPRINT(CREATEMEASURES):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 51 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 31.71 percent. 
      Compressed is 28 pages; un-compressed would require 41 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATEMEASURES):   data alltot(drop=lev1 lev2);
MPRINT(CREATEMEASURES):   merge alltot(in=a1) subkeycats(in=a2 drop=levname);
MPRINT(CREATEMEASURES):   by lev1 lev2;
MPRINT(CREATEMEASURES):   if a1 then do;
MPRINT(CREATEMEASURES):   if not a2 then do;
MPRINT(CREATEMEASURES):   volcon=1000;
MPRINT(CREATEMEASURES):   valcon=1;
MPRINT(CREATEMEASURES):   pricecon=1;
MPRINT(CREATEMEASURES):   adcon=1;
MPRINT(CREATEMEASURES):   end;
MPRINT(CREATEMEASURES):   output;
MPRINT(CREATEMEASURES):   end;
MPRINT(CREATEMEASURES):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: There were 0 observations read from the data set WORK.SUBKEYCATS.
NOTE: The data set WORK.ALLTOT has 2228 observations and 54 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 32.56 percent. 
      Compressed is 29 pages; un-compressed would require 43 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATEMEASURES):   data alltot;
MPRINT(CREATEMEASURES):   set alltot;
MPRINT(CREATEMEASURES):   length plev1 $17;
MPRINT(CREATEMEASURES):   plev1 = scan(lineitem,1);
MPRINT(CREATEMEASURES):   lev1 = plev1 * 1;
MPRINT(CREATEMEASURES):   drop plev1;
MPRINT(CREATEMEASURES):   run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      5103:87   
NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 55 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 34.09 percent. 
      Compressed is 29 pages; un-compressed would require 44 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATEMEASURES):   proc sort data=alltot;
MPRINT(CREATEMEASURES):   by g1 s1 week lev1 lineitem ean;
MPRINT(CREATEMEASURES):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 55 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 34.09 percent. 
      Compressed is 29 pages; un-compressed would require 44 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(CREATEMEASURES):   data alltot(drop= lev2 lev3 lev4 lev5);
MPRINT(CREATEMEASURES):   retain nr_level_cat 0;
MPRINT(CREATEMEASURES):   set alltot;
MPRINT(CREATEMEASURES):   length plev2 $17;
MPRINT(CREATEMEASURES):   plev2 = scan(lineitem,2);
MPRINT(CREATEMEASURES):   lev2 = plev2 * 1;
MPRINT(CREATEMEASURES):   drop plev2;
MPRINT(CREATEMEASURES):   length plev3 $17;
MPRINT(CREATEMEASURES):   plev3 = scan(lineitem,3);
MPRINT(CREATEMEASURES):   lev3 = plev3 * 1;
MPRINT(CREATEMEASURES):   drop plev3;
MPRINT(CREATEMEASURES):   length plev4 $17;
MPRINT(CREATEMEASURES):   plev4 = scan(lineitem,4);
MPRINT(CREATEMEASURES):   lev4 = plev4 * 1;
MPRINT(CREATEMEASURES):   drop plev4;
MPRINT(CREATEMEASURES):   length plev5 $17;
MPRINT(CREATEMEASURES):   plev5 = scan(lineitem,5);
MPRINT(CREATEMEASURES):   lev5 = plev5 * 1;
MPRINT(CREATEMEASURES):   drop plev5;
MPRINT(CREATEMEASURES):   if lev1 < 100 and ean="00000000000000" and lev2 = 0 and lev3 = 0 and lev4 = 0 and lev5 = 0 then nr_level_cat = lev1;
MPRINT(CREATEMEASURES):   run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      5103:2   5103:2   5103:2   5103:2   
NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 53 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 30.95 percent. 
      Compressed is 29 pages; un-compressed would require 42 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.04 seconds
      

MPRINT(CREATEMEASURES):   proc sort data=alltot;
MPRINT(CREATEMEASURES):   by g1 s1 week lev1 lineitem ean;
MPRINT(CREATEMEASURES):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 53 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 30.95 percent. 
      Compressed is 29 pages; un-compressed would require 42 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

MPRINT(CREATEMEASURES):   data alltot;
MPRINT(CREATEMEASURES):   retain total_M001 1 total_M002 1 total_M003 1 total_M005 1 ;
MPRINT(CREATEMEASURES):   set alltot;
MPRINT(CREATEMEASURES):   by g1 s1 week lev1 lineitem ean;
MPRINT(READMEASURELIST):   M001_tmp = value*1/valcon;
MPRINT(READMEASURELIST):   M002_tmp = (volume*1000)/volcon;
MPRINT(READMEASURELIST):   M003_tmp = units;
MPRINT(READMEASURELIST):   if volume > 0 then M005_tmp=(value/(volume*1000/volcon) / pricecon);
MPRINT(READMEASURELIST):   else M005_tmp=0;
MPRINT(READMEASURELIST):   M001 = M001_tmp;
MPRINT(READMEASURELIST):   M002 = M002_tmp;
MPRINT(READMEASURELIST):   M001=value*1/valcon;
MPRINT(READMEASURELIST):   M002=(volume*1000)/volcon;
MPRINT(READMEASURELIST):   M003=units;
MPRINT(READMEASURELIST):   if units > 0 then M004= (value/units);
MPRINT(READMEASURELIST):  else M004=0;
MPRINT(READMEASURELIST):   *change--took out times by 1000--4/30/02 DO NOT SCALE;
MPRINT(READMEASURELIST):   if volume > 0 then M005=(value/(volume*1000/volcon) / pricecon);
MPRINT(READMEASURELIST):   else M005=0;
MPRINT(READMEASURELIST):   if regfact > 0 then do;
MPRINT(READMEASURELIST):   M007=(nums/regfact)*100;
MPRINT(READMEASURELIST):   M007=round(M007,1);
MPRINT(READMEASURELIST):   end;
MPRINT(READMEASURELIST):   else M007=0;
MPRINT(READMEASURELIST):   if regvalue > 0 then do;
MPRINT(READMEASURELIST):   M008=(svals/regvalue)*100;
MPRINT(READMEASURELIST):   M008=round(M008,1);
MPRINT(READMEASURELIST):   end;
MPRINT(READMEASURELIST):   else M008=0;
MPRINT(CREATEMEASURES):  ;
MPRINT(CREATEMEASURES):   if first.lev1 and lev1 < 100 then do;
MPRINT(CREATEMEASURES):   total_M001 = M001_tmp;
MPRINT(CREATEMEASURES):   total_M002 = M002_tmp;
MPRINT(CREATEMEASURES):   total_M003 = M003_tmp;
MPRINT(CREATEMEASURES):   total_M005 = M005_tmp;
MPRINT(CREATEMEASURES):   M254 = 100;
MPRINT(CREATEMEASURES):   M255 = 100;
MPRINT(CREATEMEASURES):   M256 = 100;
MPRINT(CREATEMEASURES):   M257 = 100;
MPRINT(CREATEMEASURES):   end;
MPRINT(CREATEMEASURES):   if nr_level_cat > 1 and lev1 >= 100 then do;
MPRINT(CREATEMEASURES):   M254 = .;
MPRINT(CREATEMEASURES):   M255 = .;
MPRINT(CREATEMEASURES):   M256 = .;
MPRINT(CREATEMEASURES):   M257 = .;
MPRINT(CREATEMEASURES):   total_M001 = .;
MPRINT(CREATEMEASURES):   total_M002 = .;
MPRINT(CREATEMEASURES):   total_M003 = .;
MPRINT(CREATEMEASURES):   total_M005 = .;
MPRINT(CREATEMEASURES):   end;
MPRINT(CREATEMEASURES):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 72 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 26.19 percent. 
      Compressed is 31 pages; un-compressed would require 42 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.05 seconds
      

MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(CREATEMEASURES):  ;
MPRINT(MAIN):  ;
MPRINT(ADDDESCRIPTIONS):   data alltot;
MPRINT(ADDDESCRIPTIONS):   set alltot;
MPRINT(ADDDESCRIPTIONS):   length plev1 $17;
MPRINT(ADDDESCRIPTIONS):   plev1 = scan(lineitem,1);
MPRINT(ADDDESCRIPTIONS):   lev1 = plev1 * 1;
MPRINT(ADDDESCRIPTIONS):   drop plev1;
MPRINT(ADDDESCRIPTIONS):   length plev2 $17;
MPRINT(ADDDESCRIPTIONS):   plev2 = scan(lineitem,2);
MPRINT(ADDDESCRIPTIONS):   lev2 = plev2 * 1;
MPRINT(ADDDESCRIPTIONS):   drop plev2;
MPRINT(ADDDESCRIPTIONS):   length plev3 $17;
MPRINT(ADDDESCRIPTIONS):   plev3 = scan(lineitem,3);
MPRINT(ADDDESCRIPTIONS):   lev3 = plev3 * 1;
MPRINT(ADDDESCRIPTIONS):   drop plev3;
MPRINT(ADDDESCRIPTIONS):   length plev4 $17;
MPRINT(ADDDESCRIPTIONS):   plev4 = scan(lineitem,4);
MPRINT(ADDDESCRIPTIONS):   lev4 = plev4 * 1;
MPRINT(ADDDESCRIPTIONS):   drop plev4;
MPRINT(ADDDESCRIPTIONS):   length plev5 $17;
MPRINT(ADDDESCRIPTIONS):   plev5 = scan(lineitem,5);
MPRINT(ADDDESCRIPTIONS):   lev5 = plev5 * 1;
MPRINT(ADDDESCRIPTIONS):   drop plev5;
MPRINT(ADDDESCRIPTIONS):   length ean $14;
MPRINT(ADDDESCRIPTIONS):   lp=length(plev5);
MPRINT(ADDDESCRIPTIONS):   if lp=15 then do;
MPRINT(ADDDESCRIPTIONS):   lev5=substr(plev5,1,1);
MPRINT(ADDDESCRIPTIONS):   ean=substr(plev5,2,14);
MPRINT(ADDDESCRIPTIONS):   end;
MPRINT(ADDDESCRIPTIONS):   if lp=16 then do;
MPRINT(ADDDESCRIPTIONS):   lev5=substr(plev5,1,2);
MPRINT(ADDDESCRIPTIONS):   ean=substr(plev5,3,14);
MPRINT(ADDDESCRIPTIONS):   end;
MPRINT(ADDDESCRIPTIONS):   if lp=17 then do;
MPRINT(ADDDESCRIPTIONS):   lev5=substr(plev5,1,3);
MPRINT(ADDDESCRIPTIONS):   ean=substr(plev5,4,14);
MPRINT(ADDDESCRIPTIONS):   end;
MPRINT(ADDDESCRIPTIONS):   drop lineitem lp;
MPRINT(ADDDESCRIPTIONS):   run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      5103:2     5103:2     5103:2     5103:2     5103:2     5103:79    5103:179   5103:27    
NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 75 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 28.57 percent. 
      Compressed is 30 pages; un-compressed would require 42 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

MPRINT(ADDDESCRIPTIONS):   data geogagg;
MPRINT(ADDDESCRIPTIONS):   set alltot(keep=g1 s1 lev1-lev5 ean week period M001 M002);
MPRINT(ADDDESCRIPTIONS):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.GEOGAGG has 2228 observations and 12 variables.
NOTE: Compressing data set WORK.GEOGAGG decreased size by 18.52 percent. 
      Compressed is 22 pages; un-compressed would require 27 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(SORTEM):   proc sort data=geogagg;
MPRINT(SORTEM):   by lev1-lev5 ean;
MPRINT(SORTEM):   run;

NOTE: There were 2228 observations read from the data set WORK.GEOGAGG.
NOTE: The data set WORK.GEOGAGG has 2228 observations and 12 variables.
NOTE: Compressing data set WORK.GEOGAGG decreased size by 18.52 percent. 
      Compressed is 22 pages; un-compressed would require 27 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ADDDESCRIPTIONS):  ;
MPRINT(SORTEM):   proc sort data=desc;
MPRINT(SORTEM):   by lev1-lev5 ean;
MPRINT(SORTEM):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(ADDDESCRIPTIONS):  ;
MPRINT(ADDDESCRIPTIONS):   data geogagg2;
MPRINT(ADDDESCRIPTIONS):   merge geogagg(in=a) desc(in=b);
MPRINT(ADDDESCRIPTIONS):   by lev1-lev5 ean;
MPRINT(ADDDESCRIPTIONS):   length levnames $ 200 pcode $ 200;
MPRINT(LEVREAD):   substr(pcode,1,5)=put(lev1,z5.);
MPRINT(LEVREAD):   substr(pcode,6,5)=put(lev2,z5.);
MPRINT(LEVREAD):   substr(pcode,11,5)=put(lev3,z5.);
MPRINT(LEVREAD):   substr(pcode,16,5)=put(lev4,z5.);
MPRINT(LEVREAD):   substr(pcode,21,5)=put(lev5,z5.);
MPRINT(ADDDESCRIPTIONS):  ;
MPRINT(ADDDESCRIPTIONS):   levnames=trim(left(pcode));
MPRINT(ADDDESCRIPTIONS):   if (a and b) and (substr(levnames,1,5)='00001' and substr(levnames,6,5)='00000' and substr(levnames,11,5)='00000' and substr(levnames,16,5)='00000' and substr(levnames,21,5)='00000');
MPRINT(ADDDESCRIPTIONS):   keep g1 s1 week period M001 M002;
MPRINT(ADDDESCRIPTIONS):   run;

NOTE: There were 2228 observations read from the data set WORK.GEOGAGG.
NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.GEOGAGG2 has 10 observations and 6 variables.
NOTE: Compressing data set WORK.GEOGAGG2 increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      

MPRINT(SORTEM):   proc sort data=geogagg2;
MPRINT(SORTEM):   by g1 s1 week;
MPRINT(SORTEM):   run;

NOTE: There were 10 observations read from the data set WORK.GEOGAGG2.
NOTE: The data set WORK.GEOGAGG2 has 10 observations and 6 variables.
NOTE: Compressing data set WORK.GEOGAGG2 increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ADDDESCRIPTIONS):  ;
MPRINT(ADDDESCRIPTIONS):   proc means data=geogagg2 noprint;
MPRINT(ADDDESCRIPTIONS):   var M001 M002;
MPRINT(ADDDESCRIPTIONS):   by g1 s1 week;
MPRINT(ADDDESCRIPTIONS):   id period;
MPRINT(ADDDESCRIPTIONS):   output out=geogaggs(drop=_type_ _freq_) sum=;
MPRINT(ADDDESCRIPTIONS):   run;

NOTE: There were 10 observations read from the data set WORK.GEOGAGG2.
NOTE: The data set WORK.GEOGAGGS has 10 observations and 6 variables.
NOTE: Compressing data set WORK.GEOGAGGS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(ADDDESCRIPTIONS):   data _null_;
MPRINT(ADDDESCRIPTIONS):   set desc(obs=1 keep=levcode rename=levcode=lev);
MPRINT(ADDDESCRIPTIONS):   lev2 = put(lev, 3.);
MPRINT(ADDDESCRIPTIONS):   call symput('lev2',trim(lev2));
MPRINT(ADDDESCRIPTIONS):   run;

NOTE: There were 1 observations read from the data set WORK.DESC.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ADDDESCRIPTIONS):   data geogaggs;
MPRINT(ADDDESCRIPTIONS):  set geogaggs;
MPRINT(ADDDESCRIPTIONS):   levs = "C52";
MPRINT(ADDDESCRIPTIONS):   run;

NOTE: There were 10 observations read from the data set WORK.GEOGAGGS.
NOTE: The data set WORK.GEOGAGGS has 10 observations and 7 variables.
NOTE: Compressing data set WORK.GEOGAGGS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ADDDESCRIPTIONS):   data geog(keep=num desc) shop(keep=num desc);
MPRINT(ADDDESCRIPTIONS):   infile "/data/prod/transition/audit/data/store.shop" recfm=v delimiter=',' missover;
MPRINT(ADDDESCRIPTIONS):   length desc $45. num $2.;
MPRINT(ADDDESCRIPTIONS):   input numtype $ desc $;
MPRINT(ADDDESCRIPTIONS):   type = substr(numtype,1,1);
MPRINT(ADDDESCRIPTIONS):   num = substr(numtype,2);
MPRINT(ADDDESCRIPTIONS):   if length(trim(left(num)))=1 then num="0"!!trim(left(num));
MPRINT(ADDDESCRIPTIONS):   if type = "G" then output geog;
MPRINT(ADDDESCRIPTIONS):   if type = "S" then output shop;
MPRINT(ADDDESCRIPTIONS):   run;

NOTE: The infile "/data/prod/transition/audit/data/store.shop" is:
      Filename=/data/prod/transition/audit/data/store.shop,
      Owner Name=prod,Group Name=users,
      Access Permission=rwxrwxrwx,
      Last Modified=Tue Oct 14 15:39:17 2014,
      File Size (bytes)=2620

NOTE: 112 records were read from the infile "/data/prod/transition/audit/data/store.shop".
      The minimum record length was 8.
      The maximum record length was 36.
NOTE: The data set WORK.GEOG has 23 observations and 2 variables.
NOTE: Compressing data set WORK.GEOG increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.SHOP has 89 observations and 2 variables.
NOTE: Compressing data set WORK.SHOP increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/data/store.shop) imported
MPRINT(SORTEM):   proc sort data=geog(rename=num=g1 rename=desc=geog);
MPRINT(SORTEM):   by g1;
MPRINT(SORTEM):   run;

NOTE: There were 23 observations read from the data set WORK.GEOG.
NOTE: The data set WORK.GEOG has 23 observations and 2 variables.
NOTE: Compressing data set WORK.GEOG increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(STORE):  ;
MPRINT(SORTEM):   proc sort data=geogaggs;
MPRINT(SORTEM):   by g1;
MPRINT(SORTEM):   run;

NOTE: There were 10 observations read from the data set WORK.GEOGAGGS.
NOTE: The data set WORK.GEOGAGGS has 10 observations and 7 variables.
NOTE: Compressing data set WORK.GEOGAGGS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(STORE):  ;
MPRINT(STORE):   data geogaggs;
MPRINT(STORE):   merge geog geogaggs(in=a);
MPRINT(STORE):   if a;
MPRINT(STORE):   by g1;
MPRINT(STORE):   run;

NOTE: There were 23 observations read from the data set WORK.GEOG.
NOTE: There were 10 observations read from the data set WORK.GEOGAGGS.
NOTE: The data set WORK.GEOGAGGS has 10 observations and 8 variables.
NOTE: Compressing data set WORK.GEOGAGGS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ADDDESCRIPTIONS):  ;
MPRINT(SORTEM):   proc sort data=shop(rename=num=s1 rename=desc=shop);
MPRINT(SORTEM):   by s1;
MPRINT(SORTEM):   run;

NOTE: There were 89 observations read from the data set WORK.SHOP.
NOTE: The data set WORK.SHOP has 89 observations and 2 variables.
NOTE: Compressing data set WORK.SHOP increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(STORE):  ;
MPRINT(SORTEM):   proc sort data=geogaggs;
MPRINT(SORTEM):   by s1;
MPRINT(SORTEM):   run;

NOTE: There were 10 observations read from the data set WORK.GEOGAGGS.
NOTE: The data set WORK.GEOGAGGS has 10 observations and 8 variables.
NOTE: Compressing data set WORK.GEOGAGGS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(STORE):  ;
MPRINT(STORE):   data geogaggs;
MPRINT(STORE):   merge shop geogaggs(in=a);
MPRINT(STORE):   if a;
MPRINT(STORE):   by s1;
MPRINT(STORE):   run;

NOTE: There were 89 observations read from the data set WORK.SHOP.
NOTE: There were 10 observations read from the data set WORK.GEOGAGGS.
NOTE: The data set WORK.GEOGAGGS has 10 observations and 9 variables.
NOTE: Compressing data set WORK.GEOGAGGS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ADDDESCRIPTIONS):  ;
MPRINT(SORTEM):   proc sort data=geogaggs;
MPRINT(SORTEM):   by g1 s1;
MPRINT(SORTEM):   run;

NOTE: There were 10 observations read from the data set WORK.GEOGAGGS.
NOTE: The data set WORK.GEOGAGGS has 10 observations and 9 variables.
NOTE: Compressing data set WORK.GEOGAGGS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ADDDESCRIPTIONS):  ;
MPRINT(ADDDESCRIPTIONS):  run;
MPRINT(SORTEM):   proc sort data=alltot;
MPRINT(SORTEM):   by g1 s1 week lev1-lev5 ean;
MPRINT(SORTEM):   run;

NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: The data set WORK.ALLTOT has 2228 observations and 75 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 28.57 percent. 
      Compressed is 30 pages; un-compressed would require 42 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

MPRINT(ADDDESCRIPTIONS):  ;
MPRINT(ADDDESCRIPTIONS):   data alltot;
MPRINT(ADDDESCRIPTIONS):   merge alltot(in=a) catmax(in=b);
MPRINT(ADDDESCRIPTIONS):   by g1 s1;
MPRINT(ADDDESCRIPTIONS):   if a and b;
MPRINT(ADDDESCRIPTIONS):   run;
NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: There were 3 observations read from the data set WORK.CATMAX.
NOTE: The data set WORK.ALLTOT has 2228 observations and 75 variables.
NOTE: Compressing data set WORK.ALLTOT decreased size by 28.57 percent. 
      Compressed is 30 pages; un-compressed would require 42 pages.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.03 seconds
      

MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(ADDDESCRIPTIONS):  ;
MPRINT(MAIN):  ;
MPRINT(OUTPUTS):   data _null_;
MPRINT(OUTPUTS):   set alltot;
MPRINT(OUTPUTS):   if week= 867 then do;
MPRINT(OUTPUTS):   period=867;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867" lrecl=370 recfm=v;
MPRINT(OUTPUTS):  **************************************************************;
MPRINT(OUTPUTS):  * WRITEGROSSUP: This macro will write out a file in the *;
MPRINT(OUTPUTS):   * structure of the gross up data file. *;
MPRINT(OUTPUTS):   * Variables passed to the macro: *;
MPRINT(OUTPUTS):   * plevels = number of levels in hierarchy -1 *;
MPRINT(OUTPUTS):   * mlist = list of measure numbers in category generated *;
MPRINT(OUTPUTS):   * from macro catdesc.sas *;
MPRINT(OUTPUTS):   * mlevel = number of measures in the category generated *;
MPRINT(OUTPUTS):   * from macro catdesc.sas *;
MPRINT(OUTPUTS):   * Update Author Description *;
MPRINT(OUTPUTS):   * 21OCT02 Tom Dominski Change length from 3 to 4 *;
MPRINT(OUTPUTS):   * 25MAR02 Simon Poole Change length from 4 to 5 *;
MPRINT(OUTPUTS):   **************************************************************;
MPRINT(WRITEGROSSUP_V10):   put @1 lev1 z5. @6 lev2 z5. @11 lev3 z5. @16 lev4 z5. @21 lev5 z5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period z4. @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(WRITEGROSSUP_V10):   *run;
MPRINT(WRITEGROSSUP_V10):   *CHANGED A.A. 04.Sep.2003;
MPRINT(OUTPUTS):  ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   if week= 868 then do;
MPRINT(OUTPUTS):   period=868;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868" lrecl=370 recfm=v;
MPRINT(WRITEGROSSUP_V10):   put @1 lev1 z5. @6 lev2 z5. @11 lev3 z5. @16 lev4 z5. @21 lev5 z5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period z4. @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(WRITEGROSSUP_V10):   *run;
MPRINT(WRITEGROSSUP_V10):   *CHANGED A.A. 04.Sep.2003;
MPRINT(OUTPUTS):  ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   if week= 869 then do;
MPRINT(OUTPUTS):   period=869;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869" lrecl=370 recfm=v;
MPRINT(WRITEGROSSUP_V10):   put @1 lev1 z5. @6 lev2 z5. @11 lev3 z5. @16 lev4 z5. @21 lev5 z5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period z4. @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(WRITEGROSSUP_V10):   *run;
MPRINT(WRITEGROSSUP_V10):   *CHANGED A.A. 04.Sep.2003;
MPRINT(OUTPUTS):  ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   if week= 870 then do;
MPRINT(OUTPUTS):   period=870;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870" lrecl=370 recfm=v;
MPRINT(WRITEGROSSUP_V10):   put @1 lev1 z5. @6 lev2 z5. @11 lev3 z5. @16 lev4 z5. @21 lev5 z5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period z4. @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(WRITEGROSSUP_V10):   *run;
MPRINT(WRITEGROSSUP_V10):   *CHANGED A.A. 04.Sep.2003;
MPRINT(OUTPUTS):  ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   if week =0 then do;
MPRINT(OUTPUTS):   period=0128;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128" lrecl=370 recfm=v;
MPRINT(WRITEGROSSUP_V10):   put @1 lev1 z5. @6 lev2 z5. @11 lev3 z5. @16 lev4 z5. @21 lev5 z5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period z4. @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(WRITEGROSSUP_V10):   *run;
MPRINT(WRITEGROSSUP_V10):   *CHANGED A.A. 04.Sep.2003;
MPRINT(OUTPUTS):  ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   run;

NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: 446 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: 428 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: 448 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: 442 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: 464 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: There were 2228 observations read from the data set WORK.ALLTOT.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128) created
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MPRINT(OUTPUTS):   data _null_;
MPRINT(OUTPUTS):   set geogaggs;
MPRINT(OUTPUTS):   if g1 not in(99);
MPRINT(OUTPUTS):   *writes weekly data for Infoscan;
MPRINT(OUTPUTS):   if week= 867 then do;
MPRINT(OUTPUTS):   period=867;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/week0867/geog.bschfrvNI.p0867" lrecl=90 recfm=v;
MPRINT(OUTPUTS):   put @1 levs $3. @5 geog $20. @25 shop $40. @65 M001 12.2 @77 M002 12.2 ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   *writes weekly data for Infoscan;
MPRINT(OUTPUTS):   if week= 868 then do;
MPRINT(OUTPUTS):   period=868;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/week0868/geog.bschfrvNI.p0868" lrecl=90 recfm=v;
MPRINT(OUTPUTS):   put @1 levs $3. @5 geog $20. @25 shop $40. @65 M001 12.2 @77 M002 12.2 ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   *writes weekly data for Infoscan;
MPRINT(OUTPUTS):   if week= 869 then do;
MPRINT(OUTPUTS):   period=869;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/week0869/geog.bschfrvNI.p0869" lrecl=90 recfm=v;
MPRINT(OUTPUTS):   put @1 levs $3. @5 geog $20. @25 shop $40. @65 M001 12.2 @77 M002 12.2 ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   *writes weekly data for Infoscan;
MPRINT(OUTPUTS):   if week= 870 then do;
MPRINT(OUTPUTS):   period=870;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/week0870/geog.bschfrvNI.p0870" lrecl=90 recfm=v;
MPRINT(OUTPUTS):   put @1 levs $3. @5 geog $20. @25 shop $40. @65 M001 12.2 @77 M002 12.2 ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   if week= 0 then do;
MPRINT(OUTPUTS):   *writes monthly data for Infoscan;
MPRINT(OUTPUTS):   period=0128;
MPRINT(OUTPUTS):   file "/data/prod/transition/audit/aggregate/data/Infoscan/period0128/geog.bschfrvNI.p0128" lrecl=90 recfm=v;
MPRINT(OUTPUTS):   put @1 levs $3. @5 geog $20. @25 shop $40. @65 M001 12.2 @77 M002 12.2 ;
MPRINT(OUTPUTS):   end;
MPRINT(OUTPUTS):   run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      5103:46   
NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/week0867/geog.bschfrvNI.p0867" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0867/geog.bschfrvNI.p0867,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/week0868/geog.bschfrvNI.p0868" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0868/geog.bschfrvNI.p0868,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/week0869/geog.bschfrvNI.p0869" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0869/geog.bschfrvNI.p0869,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/week0870/geog.bschfrvNI.p0870" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0870/geog.bschfrvNI.p0870,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: The file "/data/prod/transition/audit/aggregate/data/Infoscan/period0128/geog.bschfrvNI.p0128" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/period0128/geog.bschfrvNI.p0128,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018

NOTE: 2 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/week0867/geog.bschfrvNI.p0867".
      The minimum record length was 88.
      The maximum record length was 88.
NOTE: 2 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/week0868/geog.bschfrvNI.p0868".
      The minimum record length was 88.
      The maximum record length was 88.
NOTE: 2 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/week0869/geog.bschfrvNI.p0869".
      The minimum record length was 88.
      The maximum record length was 88.
NOTE: 2 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/week0870/geog.bschfrvNI.p0870".
      The minimum record length was 88.
      The maximum record length was 88.
NOTE: 2 records were written to the file "/data/prod/transition/audit/aggregate/data/Infoscan/period0128/geog.bschfrvNI.p0128".
      The minimum record length was 88.
      The maximum record length was 88.
NOTE: There were 10 observations read from the data set WORK.GEOGAGGS.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(OUTPUTS):   *writes weekly data for Infoscan;
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0867/geog.bschfrvNI.p0867) created
MPRINT(OUTPUTS):   *writes weekly data for Infoscan;
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0868/geog.bschfrvNI.p0868) created
MPRINT(OUTPUTS):   *writes weekly data for Infoscan;
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0869/geog.bschfrvNI.p0869) created
MPRINT(OUTPUTS):   *writes weekly data for Infoscan;
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0870/geog.bschfrvNI.p0870) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/period0128/geog.bschfrvNI.p0128) created
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
MPRINT(OUTPUTS):  ;
MPRINT(MAIN):  ;
5104       
5105       /*** 20131121 : Performance monitoring ***/
5106       %monitor(                  _mod_=4);
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
5107       %monitor(_var_= , _val_= , _mod_=0);
MACROGEN(MONITOR):   options nomprint nosource nonotes nomacrogen;
MPRINT(MONITOR):   notes macrogen;
5108       /*** 20131121 : Performance monitoring ***/
5109       
5110       proc delete data=_all_; run;

NOTE: Deleting WORK.ACVREG (memtype=DATA).
NOTE: Deleting WORK.ACVTOT (memtype=DATA).
NOTE: Deleting WORK.AGGMAST (memtype=DATA).
NOTE: Deleting WORK.AGGSTORE (memtype=DATA).
NOTE: Deleting WORK.ALLNAMES (memtype=DATA).
NOTE: Deleting WORK.ALLTOT (memtype=DATA).
NOTE: Deleting WORK.CATINCR (memtype=DATA).
NOTE: Deleting WORK.CATMAX (memtype=DATA).
NOTE: Deleting WORK.CODE (memtype=DATA).
NOTE: Deleting WORK.DESC (memtype=DATA).
NOTE: Deleting WORK.DESC_CONV (memtype=DATA).
NOTE: Deleting WORK.DIRLIST (memtype=DATA).
NOTE: Deleting WORK.EANLIST (memtype=DATA).
NOTE: Deleting WORK.GCODE (memtype=DATA).
NOTE: Deleting WORK.GEOG (memtype=DATA).
NOTE: Deleting WORK.GEOGAGG (memtype=DATA).
NOTE: Deleting WORK.GEOGAGG2 (memtype=DATA).
NOTE: Deleting WORK.GEOGAGGS (memtype=DATA).
NOTE: Deleting WORK.GEOL (memtype=DATA).
NOTE: Deleting WORK.ITEM (memtype=DATA).
NOTE: Deleting WORK.KCLIST (memtype=DATA).
NOTE: Deleting WORK.KEYCATS (memtype=DATA).
NOTE: Deleting WORK.LEV1 (memtype=DATA).
NOTE: Deleting WORK.LEV2 (memtype=DATA).
NOTE: Deleting WORK.LEV3 (memtype=DATA).
NOTE: Deleting WORK.LEV4 (memtype=DATA).
NOTE: Deleting WORK.LEV5 (memtype=DATA).
NOTE: Deleting WORK.LEVST1 (memtype=DATA).
NOTE: Deleting WORK.LEVST10 (memtype=DATA).
NOTE: Deleting WORK.LEVST2 (memtype=DATA).
NOTE: Deleting WORK.LEVST3 (memtype=DATA).
NOTE: Deleting WORK.LEVST4 (memtype=DATA).
NOTE: Deleting WORK.LEVST5 (memtype=DATA).
NOTE: Deleting WORK.LEVST6 (memtype=DATA).
NOTE: Deleting WORK.LEVST7 (memtype=DATA).
NOTE: Deleting WORK.LEVST8 (memtype=DATA).
NOTE: Deleting WORK.LEVST9 (memtype=DATA).
NOTE: Deleting WORK.MASTACV (memtype=DATA).
NOTE: Deleting WORK.MASTER (memtype=DATA).
NOTE: Deleting WORK.MASTERAA (memtype=DATA).
NOTE: Deleting WORK.MASTSCAN (memtype=DATA).
NOTE: Deleting WORK.MASTSCAN0867 (memtype=DATA).
NOTE: Deleting WORK.MASTSCAN0868 (memtype=DATA).
NOTE: Deleting WORK.MASTSCAN0869 (memtype=DATA).
NOTE: Deleting WORK.MASTSCAN0870 (memtype=DATA).
NOTE: Deleting WORK.MASTSECTOT (memtype=DATA).
NOTE: Deleting WORK.MEAS (memtype=DATA).
NOTE: Deleting WORK.MINSTORE (memtype=DATA).
NOTE: Deleting WORK.MONITOR (memtype=DATA).
NOTE: Deleting WORK.MONTHMAST0 (memtype=DATA).
NOTE: Deleting WORK.MONTHMAST1 (memtype=DATA).
NOTE: Deleting WORK.NUMDENOM (memtype=DATA).
NOTE: Deleting WORK.PERIOD_MANAGER (memtype=DATA).
NOTE: Deleting WORK.PRJ (memtype=DATA).
NOTE: Deleting WORK.PROD_PARAMETERS (memtype=DATA).
NOTE: Deleting WORK.PROJ (memtype=DATA).
NOTE: Deleting WORK.PROJS (memtype=DATA).
NOTE: Deleting WORK.PROJSUM (memtype=DATA).
NOTE: Deleting WORK.REG (memtype=DATA).
NOTE: Deleting WORK.SASWORK_GB (memtype=DATA).
NOTE: Deleting WORK.SCODE (memtype=DATA).
NOTE: Deleting WORK.SECMAS1 (memtype=DATA).
NOTE: Deleting WORK.SECMAS10 (memtype=DATA).
NOTE: Deleting WORK.SECMAS2 (memtype=DATA).
NOTE: Deleting WORK.SECMAS3 (memtype=DATA).
NOTE: Deleting WORK.SECMAS4 (memtype=DATA).
NOTE: Deleting WORK.SECMAS5 (memtype=DATA).
NOTE: Deleting WORK.SECMAS6 (memtype=DATA).
NOTE: Deleting WORK.SECMAS7 (memtype=DATA).
NOTE: Deleting WORK.SECMAS8 (memtype=DATA).
NOTE: Deleting WORK.SECMAS9 (memtype=DATA).
NOTE: Deleting WORK.SECTOT (memtype=DATA).
NOTE: Deleting WORK.SECTOT1 (memtype=DATA).
NOTE: Deleting WORK.SECTOT10 (memtype=DATA).
NOTE: Deleting WORK.SECTOT2 (memtype=DATA).
NOTE: Deleting WORK.SECTOT3 (memtype=DATA).
NOTE: Deleting WORK.SECTOT4 (memtype=DATA).
NOTE: Deleting WORK.SECTOT5 (memtype=DATA).
NOTE: Deleting WORK.SECTOT6 (memtype=DATA).
NOTE: Deleting WORK.SECTOT7 (memtype=DATA).
NOTE: Deleting WORK.SECTOT8 (memtype=DATA).
NOTE: Deleting WORK.SECTOT9 (memtype=DATA).
NOTE: Deleting WORK.SHOP (memtype=DATA).
NOTE: Deleting WORK.STCATVAL (memtype=DATA).
NOTE: Deleting WORK.STORE (memtype=DATA).
NOTE: Deleting WORK.STOREEAN (memtype=DATA).
NOTE: Deleting WORK.STYL (memtype=DATA).
NOTE: Deleting WORK.SUBKEYCATS (memtype=DATA).
NOTE: Deleting WORK.TOTINC (memtype=DATA).
NOTE: Deleting WORK.TOTSTORE (memtype=DATA).
NOTE: Deleting WORK.TSTCTVAL (memtype=DATA).
NOTE: Deleting WORK.TSTORES (memtype=DATA).
NOTE: Deleting WORK.TYPE (memtype=DATA).
NOTE: Deleting WORK.UNB (memtype=DATA).
NOTE: Deleting WORK.VOL (memtype=DATA).
NOTE: Deleting WORK._BLOCKSPACE_ (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

5111       
5112       /*------------------------------------------------------------------------*/
5113       /* Call the OSA-production                                                */
5114       /*------------------------------------------------------------------------*/
5115       %osa;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * MACRO CATSPEC: This macro generates the macro variables *;
MPRINT(CATSPEC):   * used by the aggregation engine *;
MPRINT(CATSPEC):   * geog => contains geography information *;
MPRINT(CATSPEC):   * stype => contains store type information *;
MPRINT(CATSPEC):   * meas => contains measure information *;
MPRINT(CATSPEC):   * prj => contains projection and universe name (assumes same name *;
MPRINT(CATSPEC):   *----------------------------------------------------------------- *;
MPRINT(CATSPEC):   * UPDATE DATE AUTHOR Description *;
MPRINT(CATSPEC):   * 2003.jun.30 A.Agostinelli Selection by SERVICE *;
MPRINT(CATSPEC):   * 2003.jul.27 A.Agostinelli manage Sample_name and Univ_name *;
MPRINT(CATSPEC):   * for Combined service *;
MPRINT(CATSPEC):   * 2003.sep.29 A.Agostinelli Use of Unbundling settings- type='U' *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   libname cload "/data/prod/transition/audit";
NOTE: Libref CLOAD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit
MPRINT(CATSPEC):   data allnames;
MPRINT(CATSPEC):   set cload.catall;
MPRINT(CATSPEC):   if upcase(namecat)=upcase("bschfrvNI");
MPRINT(CATSPEC):   *service="&_service_";
MPRINT(CATSPEC):   if service='' or upcase(service)=upcase("Infoscan") then do;
MPRINT(CATSPEC):   call symput('ok','Y');
MPRINT(CATSPEC):   output;
MPRINT(CATSPEC):   end;
MPRINT(CATSPEC):   run;

NOTE: There were 193704 observations read from the data set CLOAD.CATALL.
NOTE: The data set WORK.ALLNAMES has 15 observations and 5 variables.
NOTE: Compressing data set WORK.ALLNAMES increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.13 seconds
      cpu time            0.14 seconds
      

USER-NOTE: File (/data/prod/transition/audit/catall) imported
MPRINT(CATSPEC):   data geog type meas prj vol geol styl unb;
MPRINT(CATSPEC):   set allnames;
MPRINT(CATSPEC):   *if namecat="&_category_";
MPRINT(CATSPEC):   if type='G' then output geog;
MPRINT(CATSPEC):   if type='S' then output type;
MPRINT(CATSPEC):   if type='M' then output meas;
MPRINT(CATSPEC):   if type='P' then output prj;
MPRINT(CATSPEC):   if type='V' then output vol;
MPRINT(CATSPEC):   if type='L' then output geol;
MPRINT(CATSPEC):   if type='T' then output styl;
MPRINT(CATSPEC):   if type='U' then output unb;
MPRINT(CATSPEC):   run;

NOTE: There were 15 observations read from the data set WORK.ALLNAMES.
NOTE: The data set WORK.GEOG has 2 observations and 5 variables.
NOTE: Compressing data set WORK.GEOG increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.TYPE has 1 observations and 5 variables.
NOTE: Compressing data set WORK.TYPE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.MEAS has 7 observations and 5 variables.
NOTE: Compressing data set WORK.MEAS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.PRJ has 1 observations and 5 variables.
NOTE: Compressing data set WORK.PRJ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.VOL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.VOL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.GEOL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.GEOL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.STYL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.STYL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: The data set WORK.UNB has 1 observations and 5 variables.
NOTE: Compressing data set WORK.UNB increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * these next couple of meas datasteps create two macro variables: *;
MPRINT(CATSPEC):   * meascnt = number of measures in the _category_ *;
MPRINT(CATSPEC):   * measlist = character string indicating all measure numbers *;
MPRINT(CATSPEC):   * in this _category_ *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data meas;
MPRINT(CATSPEC):   set meas end=last;
MPRINT(CATSPEC):   if last then call symput("meascnt",_n_);
MPRINT(CATSPEC):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:138   
NOTE: There were 7 observations read from the data set WORK.MEAS.
NOTE: The data set WORK.MEAS has 7 observations and 5 variables.
NOTE: Compressing data set WORK.MEAS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   data meas;
MPRINT(CATSPEC):   set meas end=last;
MPRINT(CATSPEC):   length measlist $ 28 ;
MPRINT(CATSPEC):   retain measlist;
MPRINT(CATSPEC):   if _n_=1 then measlist=trim(left(typenum));
MPRINT(CATSPEC):   else measlist=trim(left(measlist)) || " " || trim(left(typenum));
MPRINT(CATSPEC):   put measlist;
MPRINT(CATSPEC):   if last then do;
MPRINT(CATSPEC):   call symput("measlist",measlist);
MPRINT(CATSPEC):   call symput("measurelist",measlist);
MPRINT(CATSPEC):   end;
MPRINT(CATSPEC):   run;

001
001 002
001 002 003
001 002 003 004
001 002 003 004 005
001 002 003 004 005 007
001 002 003 004 005 007 008
NOTE: There were 7 observations read from the data set WORK.MEAS.
NOTE: The data set WORK.MEAS has 7 observations and 6 variables.
NOTE: Compressing data set WORK.MEAS increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * these next couple of geog datasteps create two macro variables: *;
MPRINT(CATSPEC):   * geocnt = number of geographies in the _category_ *;
MPRINT(CATSPEC):   * geolist = character string indicating all geography numbers *;
MPRINT(CATSPEC):   * in this _category_ *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data geog;
MPRINT(CATSPEC):   set geog end=last;
MPRINT(CATSPEC):   if last then call symput("geocnt",_n_);
MPRINT(CATSPEC):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:47   
NOTE: There were 2 observations read from the data set WORK.GEOG.
NOTE: The data set WORK.GEOG has 2 observations and 5 variables.
NOTE: Compressing data set WORK.GEOG increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CATSPEC):   data geog;
MPRINT(CATSPEC):   set geog end=last;
MPRINT(CATSPEC):   length geolist $ 8 ;
MPRINT(CATSPEC):   retain geolist;
MPRINT(CATSPEC):   if _n_=1 then geolist=trim(left(typenum));
MPRINT(CATSPEC):   else geolist=trim(left(geolist)) || " " || trim(left(typenum));
MPRINT(CATSPEC):   put geolist;
MPRINT(CATSPEC):   if last then do;
MPRINT(CATSPEC):   call symput("geolist",geolist);
MPRINT(CATSPEC):   end;
MPRINT(CATSPEC):   run;

000
000 008
NOTE: There were 2 observations read from the data set WORK.GEOG.
NOTE: The data set WORK.GEOG has 2 observations and 6 variables.
NOTE: Compressing data set WORK.GEOG increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * these next couple of type datasteps create two macro variables: *;
MPRINT(CATSPEC):   * typecnt = number of store types in the _category_ *;
MPRINT(CATSPEC):   * typelist = character string indicating all stype values *;
MPRINT(CATSPEC):   * in this _category_ *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data type;
MPRINT(CATSPEC):   set type end=last;
MPRINT(CATSPEC):   if last then call symput("typecnt",_n_);
MPRINT(CATSPEC):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:237   
NOTE: There were 1 observations read from the data set WORK.TYPE.
NOTE: The data set WORK.TYPE has 1 observations and 5 variables.
NOTE: Compressing data set WORK.TYPE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   data type;
MPRINT(CATSPEC):   set type end=last;
MPRINT(CATSPEC):   length typelist $ 4 ;
MPRINT(CATSPEC):   retain typelist;
MPRINT(CATSPEC):   if _n_=1 then typelist=trim(left(typenum));
MPRINT(CATSPEC):   else typelist=trim(left(typelist)) || " " || trim(left(typenum));
MPRINT(CATSPEC):   put typelist;
MPRINT(CATSPEC):   if last then do;
MPRINT(CATSPEC):   call symput("typelist",typelist);
MPRINT(CATSPEC):   end;
MPRINT(CATSPEC):   run;

0X0
NOTE: There were 1 observations read from the data set WORK.TYPE.
NOTE: The data set WORK.TYPE has 1 observations and 6 variables.
NOTE: Compressing data set WORK.TYPE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create two macro variables: *;
MPRINT(CATSPEC):   * sample= name of projection factor file *;
MPRINT(CATSPEC):   * univ= name of universe file *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data prj;
MPRINT(CATSPEC):   set prj end=last;
MPRINT(CATSPEC):   length typeuniv $50. typeproj $50. typenumerical $50.;
MPRINT(CATSPEC):   typeproj=trim(left(typedesc))||"0128"||'.csv';
MPRINT(CATSPEC):   typeuniv=trim(left(typedesc))||"0128"||'.uni';
MPRINT(CATSPEC):   typenumerical = trim(left(typedesc)) || "0128" || '.num';
MPRINT(CATSPEC):   if last then call symput("sample",typeproj);
MPRINT(CATSPEC):   if last then call symput("sample_name",trim(left(typedesc)));
MPRINT(CATSPEC):   if last then call symput("univ",typeuniv);
MPRINT(CATSPEC):   if last then call symput("univ_name",trim(left(typedesc)));
MPRINT(CATSPEC):   if last then call symput("numerical", trim(left(typenumerical)));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.PRJ.
NOTE: The data set WORK.PRJ has 1 observations and 8 variables.
NOTE: Compressing data set WORK.PRJ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

chipall0128.csv
chipall0128.uni
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create one macro variable: *;
MPRINT(CATSPEC):   * volfact= name of volume conversion facto for _category_ *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data vol;
MPRINT(CATSPEC):   set vol end=last;
MPRINT(CATSPEC):   if last then call symput("volfact",trim(left(typedesc)));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.VOL.
NOTE: The data set WORK.VOL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.VOL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create one macro variable: *;
MPRINT(CATSPEC):   * glev= number of levels in the geography dimension *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data geol;
MPRINT(CATSPEC):   set geol end=last;
MPRINT(CATSPEC):   if last then call symput("glev",trim(left(typedesc)));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.GEOL.
NOTE: The data set WORK.GEOL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.GEOL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create one macro variable: *;
MPRINT(CATSPEC):   * slev= number of levels in the store type dimension *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data styl;
MPRINT(CATSPEC):   set styl end=last;
MPRINT(CATSPEC):   if last then call symput("slev",trim(left(typedesc)));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.STYL.
NOTE: The data set WORK.STYL has 1 observations and 5 variables.
NOTE: Compressing data set WORK.STYL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   * this next type datasteps create one macro variable: *;
MPRINT(CATSPEC):   * unb_flag= flag for unbundling ('YES' / 'NO'[default value]) *;
MPRINT(CATSPEC):   ********************************************************************;
MPRINT(CATSPEC):   data _null_;
MPRINT(CATSPEC):   call symput("unb_flag",'NO');
MPRINT(CATSPEC):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CATSPEC):   data unb;
MPRINT(CATSPEC):   set unb end=last;
MPRINT(CATSPEC):   if last then call symput("unb_flag",trim(left(upcase(typedesc))));
MPRINT(CATSPEC):   run;

NOTE: There were 1 observations read from the data set WORK.UNB.
NOTE: The data set WORK.UNB has 1 observations and 5 variables.
NOTE: Compressing data set WORK.UNB increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

meascnt     =            7
measlist    = 001 002 003 004 005 007 008
measurelist = 001 002 003 004 005 007 008
geocnt      =            2
geolist     = 000 008
typecnt     =            1
typelist    = 0X0
sample      = chipall0128.csv
sample_name = chipall
univ        = chipall0128.uni
univ_name   = chipall
numerical   = chipall0128.num
volfact     = 1
glev        = 3
slev        = 4
unb_flag    = NO
MPRINT(OSA):  ;
MPRINT(READCODE_V10):   data _null_;
MPRINT(READCODE_V10):   infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde";
MPRINT(READCODE_V10):   if _n_ =1 then do;
MPRINT(READCODE_V10):   input levels sectot;
MPRINT(READCODE_V10):   call symput("levels",levels);
MPRINT(READCODE_V10):   call symput("sectot",sectot);
MPRINT(READCODE_V10):   end;
MPRINT(READCODE_V10):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:150   5115:186   
NOTE: The infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde" is:
      Filename=/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Thu Aug 23 16:19:23 2018,
      File Size (bytes)=440005

NOTE: DATA STEP stopped due to looping.
NOTE: 1 record was read from the infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde".
      The minimum record length was 4.
      The maximum record length was 4.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

10
MPRINT(READCODE_V10):   data code(drop=levels sectot) sectot(drop=levels sectot);
MPRINT(READCODE_V10):   infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde";
MPRINT(READCODE_V10):   if _n_ =1 then do;
MPRINT(READCODE_V10):   input levels sectot;
MPRINT(READCODE_V10):   delete;
MPRINT(READCODE_V10):   end;
MPRINT(READCODE_V10):   else do;
MPRINT(READCODE_V10):   length item $ 14;
MPRINT(READCODE_V10):   input @1 lev1 5. @6 lev2 5. @11 lev3 5. @16 lev4 5. @21 lev5 5. @26 item $ ;
MPRINT(READCODE_V10):   ean=item;
MPRINT(READCODE_V10):   *if lev1 <100 then * do;
MPRINT(READCODE_V10):   * sku2=lev2;
MPRINT(READCODE_V10):   * sku=substr(sku2,2,8);
MPRINT(READCODE_V10):   * end;
MPRINT(READCODE_V10):   if lev1 >=100 then output sectot;
MPRINT(READCODE_V10):   else output code;
MPRINT(READCODE_V10):   end;
MPRINT(READCODE_V10):   run;

NOTE: The infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde" is:
      Filename=/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Thu Aug 23 16:19:23 2018,
      File Size (bytes)=440005

NOTE: 11001 records were read from the infile "/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde".
      The minimum record length was 4.
      The maximum record length was 39.
NOTE: The data set WORK.CODE has 1000 observations and 7 variables.
NOTE: Compressing data set WORK.CODE increased size by 10.00 percent. 
      Compressed is 11 pages; un-compressed would require 10 pages.
NOTE: The data set WORK.SECTOT has 10000 observations and 7 variables.
NOTE: Compressing data set WORK.SECTOT decreased size by 15.73 percent. 
      Compressed is 75 pages; un-compressed would require 89 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

USER-NOTE: File (/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde) imported
MPRINT(OSA):  ;
MPRINT(READDESC_V10):   data _null_;
MPRINT(READDESC_V10):   infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc" lrecl=500;
MPRINT(READDESC_V10):   if _n_ =1 then do;
MPRINT(READDESC_V10):   input levels sectot;
MPRINT(READDESC_V10):   call symput("levels",levels);
MPRINT(READDESC_V10):   call symput("sectot",sectot);
MPRINT(READDESC_V10):   end;
MPRINT(READDESC_V10):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:144   5115:176   
NOTE: The infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc" is:
      Filename=/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Thu Aug 23 16:19:23 2018,
      File Size (bytes)=452513

NOTE: DATA STEP stopped due to looping.
NOTE: 1 record was read from the infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc".
      The minimum record length was 4.
      The maximum record length was 4.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

USER-NOTE: File (/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc) imported
MPRINT(READDESC_V10):   data desc(drop=levels sectot);
MPRINT(READDESC_V10):   infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc" lrecl=500;
MPRINT(READDESC_V10):   if _n_ =1 then do;
MPRINT(READDESC_V10):   input levels sectot;
MPRINT(READDESC_V10):   delete;
MPRINT(READDESC_V10):   end;
MPRINT(READDESC_V10):   else do;
MPRINT(READDESC_V10):   length levname $ 200 levcode $ 15;
MPRINT(READDESC_V10):   input @1 lev1 5. @6 lev2 5. @11 lev3 5. @16 lev4 5. @21 lev5 5. @26 ean $14. @41 levname $200. @242 levcode $ ;
MPRINT(READDESC_V10):   end;
MPRINT(READDESC_V10):   run;

NOTE: The infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc" is:
      Filename=/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-rw-r--,
      Last Modified=Thu Aug 23 16:19:23 2018,
      File Size (bytes)=452513

NOTE: 1783 records were read from the infile "/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc".
      The minimum record length was 4.
      The maximum record length was 256.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(OSA):  ;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   * READGROSSUP: This macro will read in a gross up data file *;
MPRINT(READGROSSUP_V10):   * Variables passed to the macro: *;
MPRINT(READGROSSUP_V10):   * plevels = number of levels in hierarchy -1 *;
MPRINT(READGROSSUP_V10):   * mlist = list of measure numbers in category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   * mlevel = number of measures in the category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   *01April2003 Simon Poole Changed length from 4 to 5 *;
MPRINT(READGROSSUP_V10):   *15June2003 a.agostinelli Changed Infile in order to insert *;
MPRINT(READGROSSUP_V10):   * 'service' name in the path *;
MPRINT(READGROSSUP_V10):   *23jul2003 a.agostinelli Changed ITEM to EAN *;
MPRINT(READGROSSUP_V10):   *15sep2003 a.agostinelli added *;
MPRINT(READGROSSUP_V10):   * _TP_=type_period *;
MPRINT(READGROSSUP_V10):   * _per_=period value *;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   data grossup;
MPRINT(READGROSSUP_V10):   infile "/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128" lrecl=1500 recfm=v truncover;
MPRINT(READGROSSUP_V10):   input @1 lev1 5. @6 lev2 5. @11 lev3 5. @16 lev4 5. @21 lev5 5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(READGROSSUP_V10):   run;

NOTE: The infile "/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018,
      File Size (bytes)=66816

NOTE: 464 records were read from the infile "/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: The data set WORK.GROSSUP has 464 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 0.00 percent. 
      Compressed is 8 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128) imported
MPRINT(FORMAT_OSA):  ;
MPRINT(MERGE_DESC):   proc sort data=grossup;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 464 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 464 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 0.00 percent. 
      Compressed is 8 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(MERGE_DESC):   data desc;
MPRINT(MERGE_DESC):   set desc;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGE_DESC):   proc sort data=desc nodupkey;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGE_DESC):   data grossup;
MPRINT(MERGE_DESC):   merge grossup(in=a) desc(in=b);
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   if a and b;
MPRINT(MERGE_DESC):   run;

NOTE: There were 464 observations read from the data set WORK.GROSSUP.
NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.GROSSUP has 464 observations and 18 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 54.55 percent. 
      Compressed is 5 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(FORMAT_OSA):  ;
MPRINT(READFORM):   libname fload "/data/prod/transition/audit/formspec";
NOTE: Libref FLOAD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec
MPRINT(READFORM):   libname fosa "/data/prod/transition/audit/formspec/osa";
NOTE: Libref FOSA was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec/osa
MPRINT(READFORM):   data form;
MPRINT(READFORM):   set fosa.formcat;
MPRINT(READFORM):   if upcase(namecat)=upcase("bschfrvNI");
MPRINT(READFORM):   if upcase(service)=upcase("Infoscan");
MPRINT(READFORM):   length fcode $ 4;
MPRINT(READFORM):   if type='G' then fcode='gg1';
MPRINT(READFORM):   if type='S' then fcode='ss1';
MPRINT(READFORM):   if type='P' then fcode='lev';
MPRINT(READFORM):   if type='M' then fcode=trim(left(type))||trim(left(typenum));
MPRINT(READFORM):   run;

NOTE: There were 99142 observations read from the data set FOSA.FORMCAT.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   call symput('formtype',trim(left(ctype)));
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:62   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc sort data=form;
MPRINT(READFORM):   by columnposition;
MPRINT(READFORM):   run;

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   if type ^='M';

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.NFORM has 3 observations and 9 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(DOSA):   data gform(keep=gosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="G";
MPRINT(DOSA):   length gosastruc $ 40;
MPRINT(DOSA):   gosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      21454:128   21454:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.GFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.GFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(DOSA):   data sform(keep=sosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="S";
MPRINT(DOSA):   length sosastruc $ 40;
MPRINT(DOSA):   sosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      21463:128   21463:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.SFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.SFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(DOSA):   data pform(keep=posastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="P";
MPRINT(DOSA):   length posastruc $ 40;
MPRINT(DOSA):   posastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      21472:128   21472:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.PFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.PFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   merge gform sform pform;
MPRINT(READFORM):   length nosastruc $ 80;
MPRINT(READFORM):   nosastruc=trim(left(gosastruc))||' '||trim(left(sosastruc))||' '||trim(left(posastruc));
MPRINT(READFORM):   call symput('nosastruc',trim(left(nosastruc)));
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GFORM.
NOTE: There were 1 observations read from the data set WORK.SFORM.
NOTE: There were 1 observations read from the data set WORK.PFORM.
NOTE: The data set WORK.NFORM has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data mform;
MPRINT(READFORM):   set form end=last;
MPRINT(READFORM):   retain cnt 0;
MPRINT(READFORM):   if type='M';
MPRINT(READFORM):   cnt=cnt+1;
MPRINT(READFORM):   columnlengths=trim(left(columnlength));
MPRINT(READFORM):   if columnlength eq int(columnlength) then columnlengths=trim(left(columnlengths))||'.';
MPRINT(READFORM):   mosastruc="@" || trim(left(columnposition))|| " " || trim(left(fcode)) || " " || trim(left(columnlengths));
MPRINT(READFORM):   call symput ("form" || left(cnt), mosastruc);
MPRINT(READFORM):   if last then do;
MPRINT(READFORM):   call symput('nform',cnt);
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:34    5115:171   5115:50    5115:124   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.MFORM has 7 observations and 12 variables.
NOTE: Compressing data set WORK.MFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   if substr(levcode,1,1)='C' then do;
MPRINT(READFORM):   cat=substr(levcode,2,2);
MPRINT(READFORM):   call symput('catnum',trim(left(cat)));
MPRINT(READFORM):   stop;
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   length cats $ 2;
MPRINT(READFORM):   cats=symget('catnum');
MPRINT(READFORM):   cats=trim(left(cats));
MPRINT(READFORM):   if length(trim(left(g1)))=1 then gg1="0"!!trim(left(g1));
MPRINT(READFORM):   else gg1=g1;
MPRINT(READFORM):   if length(trim(left(s1)))=1 then ss1="0"!!trim(left(s1));
MPRINT(READFORM):   else ss1=s1;
MPRINT(READFORM):   ggg1="0"!!trim(left(gg1));
MPRINT(READFORM):   sss1="0"!!trim(left(ss1));
MPRINT(READFORM):   run;

NOTE: There were 464 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 464 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(GG):   data null_;
MPRINT(GG):   length geogs $ 300 types $ 300 sgeogs $ 400 stypes $ 400;
MPRINT(GG):   geogs="000 008 ";
MPRINT(GG):  types="0X0 ";
MPRINT(GG):   sgeogs='"'||scan(geogs,1)||'"'||',';
MPRINT(GG):   sgeogs=trim(left(sgeogs))||'"'||scan(geogs,2)||'"';
MPRINT(GG):   stypes='"'||scan(types,1)||'"';
MPRINT(GG):   call symput("stypes", trim(left(stypes)));
MPRINT(GG):   call symput("sgeogs", trim(left(sgeogs)));
MPRINT(GG):   run;

NOTE: The data set WORK.NULL_ has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NULL_ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):  ;
MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   rename levcode=lev;
MPRINT(READFORM):   if ggg1 in ("000","008") and sss1 in ("0X0");
MPRINT(READFORM):   run;

NOTE: There were 464 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 464 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):   by lev gg1 ss1;

NOTE: There were 464 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 464 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc freq data=grossup noprint;
MPRINT(READFORM):   tables lev*gg1*ss1 / list out=cc;
NOTE: There were 464 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.CC has 454 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 66.67 percent. 
      Compressed is 5 pages; un-compressed would require 3 pages.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(READFORM):   data cc;
MPRINT(READFORM):  set cc;
MPRINT(READFORM):  if count>1;
NOTE: There were 454 observations read from the data set WORK.CC.
NOTE: The data set WORK.CC has 2 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc print;
NOTE: There were 2 observations read from the data set WORK.CC.
NOTE: The PROCEDURE PRINT printed page 1.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):  by lev1-lev5 ean;
NOTE: There were 464 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 464 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   file "/data/prod/transition/audit/formspec/osa/Infoscan/period0128/bschfrvNI.0128" lrecl=1000 recfm=v;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc ;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc;
MPRINT(READFORM):   *put @1 cats $2. &osastruc;
MPRINT(READFORM):   *A.A. commented out 15.sep.2003 ;
MPRINT(READFORM):   put @1 cats $2. @3 gg1 $2. @5 ss1 $2. @7 lev $20. @27 M001 12.2 @40 M002 12.2 @53 M003 12.2 @66 M004 12.2 @79 M005 12.2 @92 M007 6.2 @99 M008 6.2 ;
MPRINT(READFORM):   run;

NOTE: The file "/data/prod/transition/audit/formspec/osa/Infoscan/period0128/bschfrvNI.0128" is:
      Filename=/data/prod/transition/audit/formspec/osa/Infoscan/period0128/bschfrvNI.0128,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:42 2018

NOTE: 464 records were written to the file "/data/prod/transition/audit/formspec/osa/Infoscan/period0128/bschfrvNI.0128".
      The minimum record length was 104.
      The maximum record length was 104.
NOTE: There were 464 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/period0128/bschfrvNI.0128,1) created
MPRINT(FORMAT_OSA):  ;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   * READGROSSUP: This macro will read in a gross up data file *;
MPRINT(READGROSSUP_V10):   * Variables passed to the macro: *;
MPRINT(READGROSSUP_V10):   * plevels = number of levels in hierarchy -1 *;
MPRINT(READGROSSUP_V10):   * mlist = list of measure numbers in category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   * mlevel = number of measures in the category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   *01April2003 Simon Poole Changed length from 4 to 5 *;
MPRINT(READGROSSUP_V10):   *15June2003 a.agostinelli Changed Infile in order to insert *;
MPRINT(READGROSSUP_V10):   * 'service' name in the path *;
MPRINT(READGROSSUP_V10):   *23jul2003 a.agostinelli Changed ITEM to EAN *;
MPRINT(READGROSSUP_V10):   *15sep2003 a.agostinelli added *;
MPRINT(READGROSSUP_V10):   * _TP_=type_period *;
MPRINT(READGROSSUP_V10):   * _per_=period value *;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   data grossup;
MPRINT(READGROSSUP_V10):   infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867" lrecl=1500 recfm=v truncover;
MPRINT(READGROSSUP_V10):   input @1 lev1 5. @6 lev2 5. @11 lev3 5. @16 lev4 5. @21 lev5 5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(READGROSSUP_V10):   run;

NOTE: The infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018,
      File Size (bytes)=64224

NOTE: 446 records were read from the infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: The data set WORK.GROSSUP has 446 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 12.50 percent. 
      Compressed is 7 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867) imported
MPRINT(FORMAT_OSA):  ;
MPRINT(MERGE_DESC):   proc sort data=grossup;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 446 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 446 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 12.50 percent. 
      Compressed is 7 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(MERGE_DESC):   data desc;
MPRINT(MERGE_DESC):   set desc;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGE_DESC):   proc sort data=desc nodupkey;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(MERGE_DESC):   data grossup;
MPRINT(MERGE_DESC):   merge grossup(in=a) desc(in=b);
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   if a and b;
MPRINT(MERGE_DESC):   run;

NOTE: There were 446 observations read from the data set WORK.GROSSUP.
NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.GROSSUP has 446 observations and 18 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 50.00 percent. 
      Compressed is 5 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(FORMAT_OSA):  ;
MPRINT(READFORM):   libname fload "/data/prod/transition/audit/formspec";
NOTE: Libref FLOAD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec
MPRINT(READFORM):   libname fosa "/data/prod/transition/audit/formspec/osa";
NOTE: Libref FOSA was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec/osa
MPRINT(READFORM):   data form;
MPRINT(READFORM):   set fosa.formcat;
MPRINT(READFORM):   if upcase(namecat)=upcase("bschfrvNI");
MPRINT(READFORM):   if upcase(service)=upcase("Infoscan");
MPRINT(READFORM):   length fcode $ 4;
MPRINT(READFORM):   if type='G' then fcode='gg1';
MPRINT(READFORM):   if type='S' then fcode='ss1';
MPRINT(READFORM):   if type='P' then fcode='lev';
MPRINT(READFORM):   if type='M' then fcode=trim(left(type))||trim(left(typenum));
MPRINT(READFORM):   run;

NOTE: There were 99142 observations read from the data set FOSA.FORMCAT.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   call symput('formtype',trim(left(ctype)));
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:62   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc sort data=form;
MPRINT(READFORM):   by columnposition;
MPRINT(READFORM):   run;

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   if type ^='M';

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.NFORM has 3 observations and 9 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(DOSA):   data gform(keep=gosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="G";
MPRINT(DOSA):   length gosastruc $ 40;
MPRINT(DOSA):   gosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      21961:128   21961:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.GFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.GFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(DOSA):   data sform(keep=sosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="S";
MPRINT(DOSA):   length sosastruc $ 40;
MPRINT(DOSA):   sosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      21970:128   21970:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.SFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.SFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(DOSA):   data pform(keep=posastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="P";
MPRINT(DOSA):   length posastruc $ 40;
MPRINT(DOSA):   posastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      21979:128   21979:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.PFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.PFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   merge gform sform pform;
MPRINT(READFORM):   length nosastruc $ 80;
MPRINT(READFORM):   nosastruc=trim(left(gosastruc))||' '||trim(left(sosastruc))||' '||trim(left(posastruc));
MPRINT(READFORM):   call symput('nosastruc',trim(left(nosastruc)));
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GFORM.
NOTE: There were 1 observations read from the data set WORK.SFORM.
NOTE: There were 1 observations read from the data set WORK.PFORM.
NOTE: The data set WORK.NFORM has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data mform;
MPRINT(READFORM):   set form end=last;
MPRINT(READFORM):   retain cnt 0;
MPRINT(READFORM):   if type='M';
MPRINT(READFORM):   cnt=cnt+1;
MPRINT(READFORM):   columnlengths=trim(left(columnlength));
MPRINT(READFORM):   if columnlength eq int(columnlength) then columnlengths=trim(left(columnlengths))||'.';
MPRINT(READFORM):   mosastruc="@" || trim(left(columnposition))|| " " || trim(left(fcode)) || " " || trim(left(columnlengths));
MPRINT(READFORM):   call symput ("form" || left(cnt), mosastruc);
MPRINT(READFORM):   if last then do;
MPRINT(READFORM):   call symput('nform',cnt);
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:34    5115:171   5115:50    5115:124   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.MFORM has 7 observations and 12 variables.
NOTE: Compressing data set WORK.MFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   if substr(levcode,1,1)='C' then do;
MPRINT(READFORM):   cat=substr(levcode,2,2);
MPRINT(READFORM):   call symput('catnum',trim(left(cat)));
MPRINT(READFORM):   stop;
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   length cats $ 2;
MPRINT(READFORM):   cats=symget('catnum');
MPRINT(READFORM):   cats=trim(left(cats));
MPRINT(READFORM):   if length(trim(left(g1)))=1 then gg1="0"!!trim(left(g1));
MPRINT(READFORM):   else gg1=g1;
MPRINT(READFORM):   if length(trim(left(s1)))=1 then ss1="0"!!trim(left(s1));
MPRINT(READFORM):   else ss1=s1;
MPRINT(READFORM):   ggg1="0"!!trim(left(gg1));
MPRINT(READFORM):   sss1="0"!!trim(left(ss1));
MPRINT(READFORM):   run;

NOTE: There were 446 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 446 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(GG):   data null_;
MPRINT(GG):   length geogs $ 300 types $ 300 sgeogs $ 400 stypes $ 400;
MPRINT(GG):   geogs="000 008 ";
MPRINT(GG):  types="0X0 ";
MPRINT(GG):   sgeogs='"'||scan(geogs,1)||'"'||',';
MPRINT(GG):   sgeogs=trim(left(sgeogs))||'"'||scan(geogs,2)||'"';
MPRINT(GG):   stypes='"'||scan(types,1)||'"';
MPRINT(GG):   call symput("stypes", trim(left(stypes)));
MPRINT(GG):   call symput("sgeogs", trim(left(sgeogs)));
MPRINT(GG):   run;

NOTE: The data set WORK.NULL_ has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NULL_ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):  ;
MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   rename levcode=lev;
MPRINT(READFORM):   if ggg1 in ("000","008") and sss1 in ("0X0");
MPRINT(READFORM):   run;

NOTE: There were 446 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 446 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):   by lev gg1 ss1;

NOTE: There were 446 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 446 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc freq data=grossup noprint;
MPRINT(READFORM):   tables lev*gg1*ss1 / list out=cc;
NOTE: There were 446 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.CC has 436 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 66.67 percent. 
      Compressed is 5 pages; un-compressed would require 3 pages.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data cc;
MPRINT(READFORM):  set cc;
MPRINT(READFORM):  if count>1;
NOTE: There were 436 observations read from the data set WORK.CC.
NOTE: The data set WORK.CC has 2 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc print;
NOTE: There were 2 observations read from the data set WORK.CC.
NOTE: The PROCEDURE PRINT printed page 2.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):  by lev1-lev5 ean;
NOTE: There were 446 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 446 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   file "/data/prod/transition/audit/formspec/osa/Infoscan/week0867/bschfrvNI.0867" lrecl=1000 recfm=v;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc ;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc;
MPRINT(READFORM):   *put @1 cats $2. &osastruc;
MPRINT(READFORM):   *A.A. commented out 15.sep.2003 ;
MPRINT(READFORM):   put @1 cats $2. @3 gg1 $2. @5 ss1 $2. @7 lev $20. @27 M001 12.2 @40 M002 12.2 @53 M003 12.2 @66 M004 12.2 @79 M005 12.2 @92 M007 6.2 @99 M008 6.2 ;
MPRINT(READFORM):   run;

NOTE: The file "/data/prod/transition/audit/formspec/osa/Infoscan/week0867/bschfrvNI.0867" is:
      Filename=/data/prod/transition/audit/formspec/osa/Infoscan/week0867/bschfrvNI.0867,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:43 2018

NOTE: 446 records were written to the file "/data/prod/transition/audit/formspec/osa/Infoscan/week0867/bschfrvNI.0867".
      The minimum record length was 104.
      The maximum record length was 104.
NOTE: There were 446 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/week0867/bschfrvNI.0867,0) created
MPRINT(FORMAT_OSA):  ;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   * READGROSSUP: This macro will read in a gross up data file *;
MPRINT(READGROSSUP_V10):   * Variables passed to the macro: *;
MPRINT(READGROSSUP_V10):   * plevels = number of levels in hierarchy -1 *;
MPRINT(READGROSSUP_V10):   * mlist = list of measure numbers in category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   * mlevel = number of measures in the category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   *01April2003 Simon Poole Changed length from 4 to 5 *;
MPRINT(READGROSSUP_V10):   *15June2003 a.agostinelli Changed Infile in order to insert *;
MPRINT(READGROSSUP_V10):   * 'service' name in the path *;
MPRINT(READGROSSUP_V10):   *23jul2003 a.agostinelli Changed ITEM to EAN *;
MPRINT(READGROSSUP_V10):   *15sep2003 a.agostinelli added *;
MPRINT(READGROSSUP_V10):   * _TP_=type_period *;
MPRINT(READGROSSUP_V10):   * _per_=period value *;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   data grossup;
MPRINT(READGROSSUP_V10):   infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868" lrecl=1500 recfm=v truncover;
MPRINT(READGROSSUP_V10):   input @1 lev1 5. @6 lev2 5. @11 lev3 5. @16 lev4 5. @21 lev5 5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(READGROSSUP_V10):   run;

NOTE: The infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018,
      File Size (bytes)=61632

NOTE: 428 records were read from the infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: The data set WORK.GROSSUP has 428 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 12.50 percent. 
      Compressed is 7 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868) imported
MPRINT(FORMAT_OSA):  ;
MPRINT(MERGE_DESC):   proc sort data=grossup;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 428 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 428 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 12.50 percent. 
      Compressed is 7 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGE_DESC):   data desc;
MPRINT(MERGE_DESC):   set desc;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGE_DESC):   proc sort data=desc nodupkey;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGE_DESC):   data grossup;
MPRINT(MERGE_DESC):   merge grossup(in=a) desc(in=b);
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   if a and b;
MPRINT(MERGE_DESC):   run;

NOTE: There were 428 observations read from the data set WORK.GROSSUP.
NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.GROSSUP has 428 observations and 18 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 50.00 percent. 
      Compressed is 5 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(FORMAT_OSA):  ;
MPRINT(READFORM):   libname fload "/data/prod/transition/audit/formspec";
NOTE: Libref FLOAD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec
MPRINT(READFORM):   libname fosa "/data/prod/transition/audit/formspec/osa";
NOTE: Libref FOSA was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec/osa
MPRINT(READFORM):   data form;
MPRINT(READFORM):   set fosa.formcat;
MPRINT(READFORM):   if upcase(namecat)=upcase("bschfrvNI");
MPRINT(READFORM):   if upcase(service)=upcase("Infoscan");
MPRINT(READFORM):   length fcode $ 4;
MPRINT(READFORM):   if type='G' then fcode='gg1';
MPRINT(READFORM):   if type='S' then fcode='ss1';
MPRINT(READFORM):   if type='P' then fcode='lev';
MPRINT(READFORM):   if type='M' then fcode=trim(left(type))||trim(left(typenum));
MPRINT(READFORM):   run;

NOTE: There were 99142 observations read from the data set FOSA.FORMCAT.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   call symput('formtype',trim(left(ctype)));
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:62   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc sort data=form;
MPRINT(READFORM):   by columnposition;
MPRINT(READFORM):   run;

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   if type ^='M';

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.NFORM has 3 observations and 9 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(DOSA):   data gform(keep=gosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="G";
MPRINT(DOSA):   length gosastruc $ 40;
MPRINT(DOSA):   gosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      22459:128   22459:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.GFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.GFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(DOSA):   data sform(keep=sosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="S";
MPRINT(DOSA):   length sosastruc $ 40;
MPRINT(DOSA):   sosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      22468:128   22468:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.SFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.SFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(DOSA):   data pform(keep=posastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="P";
MPRINT(DOSA):   length posastruc $ 40;
MPRINT(DOSA):   posastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      22477:128   22477:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.PFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.PFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   merge gform sform pform;
MPRINT(READFORM):   length nosastruc $ 80;
MPRINT(READFORM):   nosastruc=trim(left(gosastruc))||' '||trim(left(sosastruc))||' '||trim(left(posastruc));
MPRINT(READFORM):   call symput('nosastruc',trim(left(nosastruc)));
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GFORM.
NOTE: There were 1 observations read from the data set WORK.SFORM.
NOTE: There were 1 observations read from the data set WORK.PFORM.
NOTE: The data set WORK.NFORM has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data mform;
MPRINT(READFORM):   set form end=last;
MPRINT(READFORM):   retain cnt 0;
MPRINT(READFORM):   if type='M';
MPRINT(READFORM):   cnt=cnt+1;
MPRINT(READFORM):   columnlengths=trim(left(columnlength));
MPRINT(READFORM):   if columnlength eq int(columnlength) then columnlengths=trim(left(columnlengths))||'.';
MPRINT(READFORM):   mosastruc="@" || trim(left(columnposition))|| " " || trim(left(fcode)) || " " || trim(left(columnlengths));
MPRINT(READFORM):   call symput ("form" || left(cnt), mosastruc);
MPRINT(READFORM):   if last then do;
MPRINT(READFORM):   call symput('nform',cnt);
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:34    5115:171   5115:50    5115:124   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.MFORM has 7 observations and 12 variables.
NOTE: Compressing data set WORK.MFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   if substr(levcode,1,1)='C' then do;
MPRINT(READFORM):   cat=substr(levcode,2,2);
MPRINT(READFORM):   call symput('catnum',trim(left(cat)));
MPRINT(READFORM):   stop;
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   length cats $ 2;
MPRINT(READFORM):   cats=symget('catnum');
MPRINT(READFORM):   cats=trim(left(cats));
MPRINT(READFORM):   if length(trim(left(g1)))=1 then gg1="0"!!trim(left(g1));
MPRINT(READFORM):   else gg1=g1;
MPRINT(READFORM):   if length(trim(left(s1)))=1 then ss1="0"!!trim(left(s1));
MPRINT(READFORM):   else ss1=s1;
MPRINT(READFORM):   ggg1="0"!!trim(left(gg1));
MPRINT(READFORM):   sss1="0"!!trim(left(ss1));
MPRINT(READFORM):   run;

NOTE: There were 428 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 428 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 40.00 percent. 
      Compressed is 6 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(GG):   data null_;
MPRINT(GG):   length geogs $ 300 types $ 300 sgeogs $ 400 stypes $ 400;
MPRINT(GG):   geogs="000 008 ";
MPRINT(GG):  types="0X0 ";
MPRINT(GG):   sgeogs='"'||scan(geogs,1)||'"'||',';
MPRINT(GG):   sgeogs=trim(left(sgeogs))||'"'||scan(geogs,2)||'"';
MPRINT(GG):   stypes='"'||scan(types,1)||'"';
MPRINT(GG):   call symput("stypes", trim(left(stypes)));
MPRINT(GG):   call symput("sgeogs", trim(left(sgeogs)));
MPRINT(GG):   run;

NOTE: The data set WORK.NULL_ has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NULL_ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):  ;
MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   rename levcode=lev;
MPRINT(READFORM):   if ggg1 in ("000","008") and sss1 in ("0X0");
MPRINT(READFORM):   run;

NOTE: There were 428 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 428 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 40.00 percent. 
      Compressed is 6 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):   by lev gg1 ss1;

NOTE: There were 428 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 428 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 40.00 percent. 
      Compressed is 6 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc freq data=grossup noprint;
MPRINT(READFORM):   tables lev*gg1*ss1 / list out=cc;
NOTE: There were 428 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.CC has 418 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 66.67 percent. 
      Compressed is 5 pages; un-compressed would require 3 pages.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data cc;
MPRINT(READFORM):  set cc;
MPRINT(READFORM):  if count>1;
NOTE: There were 418 observations read from the data set WORK.CC.
NOTE: The data set WORK.CC has 2 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   proc print;
NOTE: There were 2 observations read from the data set WORK.CC.
NOTE: The PROCEDURE PRINT printed page 3.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):  by lev1-lev5 ean;
NOTE: There were 428 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 428 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 40.00 percent. 
      Compressed is 6 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   file "/data/prod/transition/audit/formspec/osa/Infoscan/week0868/bschfrvNI.0868" lrecl=1000 recfm=v;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc ;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc;
MPRINT(READFORM):   *put @1 cats $2. &osastruc;
MPRINT(READFORM):   *A.A. commented out 15.sep.2003 ;
MPRINT(READFORM):   put @1 cats $2. @3 gg1 $2. @5 ss1 $2. @7 lev $20. @27 M001 12.2 @40 M002 12.2 @53 M003 12.2 @66 M004 12.2 @79 M005 12.2 @92 M007 6.2 @99 M008 6.2 ;
MPRINT(READFORM):   run;

NOTE: The file "/data/prod/transition/audit/formspec/osa/Infoscan/week0868/bschfrvNI.0868" is:
      Filename=/data/prod/transition/audit/formspec/osa/Infoscan/week0868/bschfrvNI.0868,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:43 2018

NOTE: 428 records were written to the file "/data/prod/transition/audit/formspec/osa/Infoscan/week0868/bschfrvNI.0868".
      The minimum record length was 104.
      The maximum record length was 104.
NOTE: There were 428 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/week0868/bschfrvNI.0868,0) created
MPRINT(FORMAT_OSA):  ;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   * READGROSSUP: This macro will read in a gross up data file *;
MPRINT(READGROSSUP_V10):   * Variables passed to the macro: *;
MPRINT(READGROSSUP_V10):   * plevels = number of levels in hierarchy -1 *;
MPRINT(READGROSSUP_V10):   * mlist = list of measure numbers in category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   * mlevel = number of measures in the category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   *01April2003 Simon Poole Changed length from 4 to 5 *;
MPRINT(READGROSSUP_V10):   *15June2003 a.agostinelli Changed Infile in order to insert *;
MPRINT(READGROSSUP_V10):   * 'service' name in the path *;
MPRINT(READGROSSUP_V10):   *23jul2003 a.agostinelli Changed ITEM to EAN *;
MPRINT(READGROSSUP_V10):   *15sep2003 a.agostinelli added *;
MPRINT(READGROSSUP_V10):   * _TP_=type_period *;
MPRINT(READGROSSUP_V10):   * _per_=period value *;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   data grossup;
MPRINT(READGROSSUP_V10):   infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869" lrecl=1500 recfm=v truncover;
MPRINT(READGROSSUP_V10):   input @1 lev1 5. @6 lev2 5. @11 lev3 5. @16 lev4 5. @21 lev5 5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(READGROSSUP_V10):   run;

NOTE: The infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018,
      File Size (bytes)=64512

NOTE: 448 records were read from the infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: The data set WORK.GROSSUP has 448 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 12.50 percent. 
      Compressed is 7 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869) imported
MPRINT(FORMAT_OSA):  ;
MPRINT(MERGE_DESC):   proc sort data=grossup;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 448 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 448 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 12.50 percent. 
      Compressed is 7 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(MERGE_DESC):   data desc;
MPRINT(MERGE_DESC):   set desc;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGE_DESC):   proc sort data=desc nodupkey;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGE_DESC):   data grossup;
MPRINT(MERGE_DESC):   merge grossup(in=a) desc(in=b);
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   if a and b;
MPRINT(MERGE_DESC):   run;

NOTE: There were 448 observations read from the data set WORK.GROSSUP.
NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.GROSSUP has 448 observations and 18 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 50.00 percent. 
      Compressed is 5 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(FORMAT_OSA):  ;
MPRINT(READFORM):   libname fload "/data/prod/transition/audit/formspec";
NOTE: Libref FLOAD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec
MPRINT(READFORM):   libname fosa "/data/prod/transition/audit/formspec/osa";
NOTE: Libref FOSA was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec/osa
MPRINT(READFORM):   data form;
MPRINT(READFORM):   set fosa.formcat;
MPRINT(READFORM):   if upcase(namecat)=upcase("bschfrvNI");
MPRINT(READFORM):   if upcase(service)=upcase("Infoscan");
MPRINT(READFORM):   length fcode $ 4;
MPRINT(READFORM):   if type='G' then fcode='gg1';
MPRINT(READFORM):   if type='S' then fcode='ss1';
MPRINT(READFORM):   if type='P' then fcode='lev';
MPRINT(READFORM):   if type='M' then fcode=trim(left(type))||trim(left(typenum));
MPRINT(READFORM):   run;

NOTE: There were 99142 observations read from the data set FOSA.FORMCAT.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.11 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   call symput('formtype',trim(left(ctype)));
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:62   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc sort data=form;
MPRINT(READFORM):   by columnposition;
MPRINT(READFORM):   run;

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   if type ^='M';

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.NFORM has 3 observations and 9 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(DOSA):   data gform(keep=gosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="G";
MPRINT(DOSA):   length gosastruc $ 40;
MPRINT(DOSA):   gosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      22957:128   22957:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.GFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.GFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(DOSA):   data sform(keep=sosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="S";
MPRINT(DOSA):   length sosastruc $ 40;
MPRINT(DOSA):   sosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      22966:128   22966:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.SFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.SFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(DOSA):   data pform(keep=posastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="P";
MPRINT(DOSA):   length posastruc $ 40;
MPRINT(DOSA):   posastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      22975:128   22975:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.PFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.PFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   merge gform sform pform;
MPRINT(READFORM):   length nosastruc $ 80;
MPRINT(READFORM):   nosastruc=trim(left(gosastruc))||' '||trim(left(sosastruc))||' '||trim(left(posastruc));
MPRINT(READFORM):   call symput('nosastruc',trim(left(nosastruc)));
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GFORM.
NOTE: There were 1 observations read from the data set WORK.SFORM.
NOTE: There were 1 observations read from the data set WORK.PFORM.
NOTE: The data set WORK.NFORM has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data mform;
MPRINT(READFORM):   set form end=last;
MPRINT(READFORM):   retain cnt 0;
MPRINT(READFORM):   if type='M';
MPRINT(READFORM):   cnt=cnt+1;
MPRINT(READFORM):   columnlengths=trim(left(columnlength));
MPRINT(READFORM):   if columnlength eq int(columnlength) then columnlengths=trim(left(columnlengths))||'.';
MPRINT(READFORM):   mosastruc="@" || trim(left(columnposition))|| " " || trim(left(fcode)) || " " || trim(left(columnlengths));
MPRINT(READFORM):   call symput ("form" || left(cnt), mosastruc);
MPRINT(READFORM):   if last then do;
MPRINT(READFORM):   call symput('nform',cnt);
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:34    5115:171   5115:50    5115:124   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.MFORM has 7 observations and 12 variables.
NOTE: Compressing data set WORK.MFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   if substr(levcode,1,1)='C' then do;
MPRINT(READFORM):   cat=substr(levcode,2,2);
MPRINT(READFORM):   call symput('catnum',trim(left(cat)));
MPRINT(READFORM):   stop;
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   length cats $ 2;
MPRINT(READFORM):   cats=symget('catnum');
MPRINT(READFORM):   cats=trim(left(cats));
MPRINT(READFORM):   if length(trim(left(g1)))=1 then gg1="0"!!trim(left(g1));
MPRINT(READFORM):   else gg1=g1;
MPRINT(READFORM):   if length(trim(left(s1)))=1 then ss1="0"!!trim(left(s1));
MPRINT(READFORM):   else ss1=s1;
MPRINT(READFORM):   ggg1="0"!!trim(left(gg1));
MPRINT(READFORM):   sss1="0"!!trim(left(ss1));
MPRINT(READFORM):   run;

NOTE: There were 448 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 448 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(GG):   data null_;
MPRINT(GG):   length geogs $ 300 types $ 300 sgeogs $ 400 stypes $ 400;
MPRINT(GG):   geogs="000 008 ";
MPRINT(GG):  types="0X0 ";
MPRINT(GG):   sgeogs='"'||scan(geogs,1)||'"'||',';
MPRINT(GG):   sgeogs=trim(left(sgeogs))||'"'||scan(geogs,2)||'"';
MPRINT(GG):   stypes='"'||scan(types,1)||'"';
MPRINT(GG):   call symput("stypes", trim(left(stypes)));
MPRINT(GG):   call symput("sgeogs", trim(left(sgeogs)));
MPRINT(GG):   run;

NOTE: The data set WORK.NULL_ has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NULL_ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):  ;
MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   rename levcode=lev;
MPRINT(READFORM):   if ggg1 in ("000","008") and sss1 in ("0X0");
MPRINT(READFORM):   run;

NOTE: There were 448 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 448 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):   by lev gg1 ss1;

NOTE: There were 448 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 448 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc freq data=grossup noprint;
MPRINT(READFORM):   tables lev*gg1*ss1 / list out=cc;
NOTE: There were 448 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.CC has 438 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 66.67 percent. 
      Compressed is 5 pages; un-compressed would require 3 pages.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(READFORM):   data cc;
MPRINT(READFORM):  set cc;
MPRINT(READFORM):  if count>1;
NOTE: There were 438 observations read from the data set WORK.CC.
NOTE: The data set WORK.CC has 2 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc print;
NOTE: There were 2 observations read from the data set WORK.CC.
NOTE: The PROCEDURE PRINT printed page 4.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):  by lev1-lev5 ean;
NOTE: There were 448 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 448 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   file "/data/prod/transition/audit/formspec/osa/Infoscan/week0869/bschfrvNI.0869" lrecl=1000 recfm=v;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc ;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc;
MPRINT(READFORM):   *put @1 cats $2. &osastruc;
MPRINT(READFORM):   *A.A. commented out 15.sep.2003 ;
MPRINT(READFORM):   put @1 cats $2. @3 gg1 $2. @5 ss1 $2. @7 lev $20. @27 M001 12.2 @40 M002 12.2 @53 M003 12.2 @66 M004 12.2 @79 M005 12.2 @92 M007 6.2 @99 M008 6.2 ;
MPRINT(READFORM):   run;

NOTE: The file "/data/prod/transition/audit/formspec/osa/Infoscan/week0869/bschfrvNI.0869" is:
      Filename=/data/prod/transition/audit/formspec/osa/Infoscan/week0869/bschfrvNI.0869,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:43 2018

NOTE: 448 records were written to the file "/data/prod/transition/audit/formspec/osa/Infoscan/week0869/bschfrvNI.0869".
      The minimum record length was 104.
      The maximum record length was 104.
NOTE: There were 448 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/week0869/bschfrvNI.0869,0) created
MPRINT(FORMAT_OSA):  ;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   * READGROSSUP: This macro will read in a gross up data file *;
MPRINT(READGROSSUP_V10):   * Variables passed to the macro: *;
MPRINT(READGROSSUP_V10):   * plevels = number of levels in hierarchy -1 *;
MPRINT(READGROSSUP_V10):   * mlist = list of measure numbers in category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   * mlevel = number of measures in the category generated *;
MPRINT(READGROSSUP_V10):   * from macro catspec.sas *;
MPRINT(READGROSSUP_V10):   *01April2003 Simon Poole Changed length from 4 to 5 *;
MPRINT(READGROSSUP_V10):   *15June2003 a.agostinelli Changed Infile in order to insert *;
MPRINT(READGROSSUP_V10):   * 'service' name in the path *;
MPRINT(READGROSSUP_V10):   *23jul2003 a.agostinelli Changed ITEM to EAN *;
MPRINT(READGROSSUP_V10):   *15sep2003 a.agostinelli added *;
MPRINT(READGROSSUP_V10):   * _TP_=type_period *;
MPRINT(READGROSSUP_V10):   * _per_=period value *;
MPRINT(READGROSSUP_V10):   **************************************************************;
MPRINT(READGROSSUP_V10):   data grossup;
MPRINT(READGROSSUP_V10):   infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870" lrecl=1500 recfm=v truncover;
MPRINT(READGROSSUP_V10):   input @1 lev1 5. @6 lev2 5. @11 lev3 5. @16 lev4 5. @21 lev5 5. @26 ean $14. @40 g1 $2. @42 s1 $2. @44 period @60 M001 12.2 @72 M002 12.2 @84 M003 12.2 @96 M004 12.2 @108 M005 12.2 @120 M007 12.2 @132 M008 12.2 ;
MPRINT(READGROSSUP_V10):   run;

NOTE: The infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870" is:
      Filename=/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:41 2018,
      File Size (bytes)=63648

NOTE: 442 records were read from the infile "/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870".
      The minimum record length was 143.
      The maximum record length was 143.
NOTE: The data set WORK.GROSSUP has 442 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 12.50 percent. 
      Compressed is 7 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870) imported
MPRINT(FORMAT_OSA):  ;
MPRINT(MERGE_DESC):   proc sort data=grossup;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 442 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 442 observations and 16 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 12.50 percent. 
      Compressed is 7 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(MERGE_DESC):   data desc;
MPRINT(MERGE_DESC):   set desc;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(MERGE_DESC):   proc sort data=desc nodupkey;
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   run;

NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.DESC has 1782 observations and 8 variables.
NOTE: Compressing data set WORK.DESC decreased size by 63.33 percent. 
      Compressed is 11 pages; un-compressed would require 30 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.02 seconds
      

MPRINT(MERGE_DESC):   data grossup;
MPRINT(MERGE_DESC):   merge grossup(in=a) desc(in=b);
MPRINT(MERGE_DESC):   by lev1-lev5 ean;
MPRINT(MERGE_DESC):   if a and b;
MPRINT(MERGE_DESC):   run;

NOTE: There were 442 observations read from the data set WORK.GROSSUP.
NOTE: There were 1782 observations read from the data set WORK.DESC.
NOTE: The data set WORK.GROSSUP has 442 observations and 18 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 50.00 percent. 
      Compressed is 5 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(FORMAT_OSA):  ;
MPRINT(READFORM):   libname fload "/data/prod/transition/audit/formspec";
NOTE: Libref FLOAD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec
MPRINT(READFORM):   libname fosa "/data/prod/transition/audit/formspec/osa";
NOTE: Libref FOSA was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/prod/transition/audit/formspec/osa
MPRINT(READFORM):   data form;
MPRINT(READFORM):   set fosa.formcat;
MPRINT(READFORM):   if upcase(namecat)=upcase("bschfrvNI");
MPRINT(READFORM):   if upcase(service)=upcase("Infoscan");
MPRINT(READFORM):   length fcode $ 4;
MPRINT(READFORM):   if type='G' then fcode='gg1';
MPRINT(READFORM):   if type='S' then fcode='ss1';
MPRINT(READFORM):   if type='P' then fcode='lev';
MPRINT(READFORM):   if type='M' then fcode=trim(left(type))||trim(left(typenum));
MPRINT(READFORM):   run;

NOTE: There were 99142 observations read from the data set FOSA.FORMCAT.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.11 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   call symput('formtype',trim(left(ctype)));
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:62   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc sort data=form;
MPRINT(READFORM):   by columnposition;
MPRINT(READFORM):   run;

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.FORM has 10 observations and 9 variables.
NOTE: Compressing data set WORK.FORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   set form;
MPRINT(READFORM):   if type ^='M';

NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.NFORM has 3 observations and 9 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(DOSA):   data gform(keep=gosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="G";
MPRINT(DOSA):   length gosastruc $ 40;
MPRINT(DOSA):   gosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      23455:128   23455:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.GFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.GFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(DOSA):   data sform(keep=sosastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="S";
MPRINT(DOSA):   length sosastruc $ 40;
MPRINT(DOSA):   sosastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      23464:128   23464:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.SFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.SFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(DOSA):   data pform(keep=posastruc);
MPRINT(DOSA):   set nform;
MPRINT(DOSA):   if type="P";
MPRINT(DOSA):   length posastruc $ 40;
MPRINT(DOSA):   posastruc="@" || trim(left(columnposition)) || " " || trim(left(fcode)) || " " || '' || "$" || trim(left(columnlength)) || trim(left('.'));
MPRINT(READFORM):  ;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      23473:128   23473:206   
NOTE: There were 3 observations read from the data set WORK.NFORM.
NOTE: The data set WORK.PFORM has 1 observations and 1 variables.
NOTE: Compressing data set WORK.PFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data nform;
MPRINT(READFORM):   merge gform sform pform;
MPRINT(READFORM):   length nosastruc $ 80;
MPRINT(READFORM):   nosastruc=trim(left(gosastruc))||' '||trim(left(sosastruc))||' '||trim(left(posastruc));
MPRINT(READFORM):   call symput('nosastruc',trim(left(nosastruc)));
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GFORM.
NOTE: There were 1 observations read from the data set WORK.SFORM.
NOTE: There were 1 observations read from the data set WORK.PFORM.
NOTE: The data set WORK.NFORM has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data mform;
MPRINT(READFORM):   set form end=last;
MPRINT(READFORM):   retain cnt 0;
MPRINT(READFORM):   if type='M';
MPRINT(READFORM):   cnt=cnt+1;
MPRINT(READFORM):   columnlengths=trim(left(columnlength));
MPRINT(READFORM):   if columnlength eq int(columnlength) then columnlengths=trim(left(columnlengths))||'.';
MPRINT(READFORM):   mosastruc="@" || trim(left(columnposition))|| " " || trim(left(fcode)) || " " || trim(left(columnlengths));
MPRINT(READFORM):   call symput ("form" || left(cnt), mosastruc);
MPRINT(READFORM):   if last then do;
MPRINT(READFORM):   call symput('nform',cnt);
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      5115:34    5115:171   5115:50    5115:124   
NOTE: There were 10 observations read from the data set WORK.FORM.
NOTE: The data set WORK.MFORM has 7 observations and 12 variables.
NOTE: Compressing data set WORK.MFORM increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   if substr(levcode,1,1)='C' then do;
MPRINT(READFORM):   cat=substr(levcode,2,2);
MPRINT(READFORM):   call symput('catnum',trim(left(cat)));
MPRINT(READFORM):   stop;
MPRINT(READFORM):   end;
MPRINT(READFORM):   run;

NOTE: There were 1 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   length cats $ 2;
MPRINT(READFORM):   cats=symget('catnum');
MPRINT(READFORM):   cats=trim(left(cats));
MPRINT(READFORM):   if length(trim(left(g1)))=1 then gg1="0"!!trim(left(g1));
MPRINT(READFORM):   else gg1=g1;
MPRINT(READFORM):   if length(trim(left(s1)))=1 then ss1="0"!!trim(left(s1));
MPRINT(READFORM):   else ss1=s1;
MPRINT(READFORM):   ggg1="0"!!trim(left(gg1));
MPRINT(READFORM):   sss1="0"!!trim(left(ss1));
MPRINT(READFORM):   run;

NOTE: There were 442 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 442 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(GG):   data null_;
MPRINT(GG):   length geogs $ 300 types $ 300 sgeogs $ 400 stypes $ 400;
MPRINT(GG):   geogs="000 008 ";
MPRINT(GG):  types="0X0 ";
MPRINT(GG):   sgeogs='"'||scan(geogs,1)||'"'||',';
MPRINT(GG):   sgeogs=trim(left(sgeogs))||'"'||scan(geogs,2)||'"';
MPRINT(GG):   stypes='"'||scan(types,1)||'"';
MPRINT(GG):   call symput("stypes", trim(left(stypes)));
MPRINT(GG):   call symput("sgeogs", trim(left(sgeogs)));
MPRINT(GG):   run;

NOTE: The data set WORK.NULL_ has 1 observations and 4 variables.
NOTE: Compressing data set WORK.NULL_ increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):  ;
MPRINT(READFORM):   data grossup;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   rename levcode=lev;
MPRINT(READFORM):   if ggg1 in ("000","008") and sss1 in ("0X0");
MPRINT(READFORM):   run;

NOTE: There were 442 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 442 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):   by lev gg1 ss1;

NOTE: There were 442 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 442 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   proc freq data=grossup noprint;
MPRINT(READFORM):   tables lev*gg1*ss1 / list out=cc;
NOTE: There were 442 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.CC has 432 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 66.67 percent. 
      Compressed is 5 pages; un-compressed would require 3 pages.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   data cc;
MPRINT(READFORM):  set cc;
MPRINT(READFORM):  if count>1;
NOTE: There were 432 observations read from the data set WORK.CC.
NOTE: The data set WORK.CC has 2 observations and 5 variables.
NOTE: Compressing data set WORK.CC increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(READFORM):   proc print;
NOTE: There were 2 observations read from the data set WORK.CC.
NOTE: The PROCEDURE PRINT printed page 5.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(READFORM):   proc sort data=grossup;
MPRINT(READFORM):  by lev1-lev5 ean;
NOTE: There were 442 observations read from the data set WORK.GROSSUP.
NOTE: The data set WORK.GROSSUP has 442 observations and 23 variables.
NOTE: Compressing data set WORK.GROSSUP decreased size by 45.45 percent. 
      Compressed is 6 pages; un-compressed would require 11 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(READFORM):   data _null_;
MPRINT(READFORM):   set grossup;
MPRINT(READFORM):   file "/data/prod/transition/audit/formspec/osa/Infoscan/week0870/bschfrvNI.0870" lrecl=1000 recfm=v;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc ;
MPRINT(READFORM):   *put @1 "&catnum" &osastruc;
MPRINT(READFORM):   *put @1 cats $2. &osastruc;
MPRINT(READFORM):   *A.A. commented out 15.sep.2003 ;
MPRINT(READFORM):   put @1 cats $2. @3 gg1 $2. @5 ss1 $2. @7 lev $20. @27 M001 12.2 @40 M002 12.2 @53 M003 12.2 @66 M004 12.2 @79 M005 12.2 @92 M007 6.2 @99 M008 6.2 ;
MPRINT(READFORM):   run;

NOTE: The file "/data/prod/transition/audit/formspec/osa/Infoscan/week0870/bschfrvNI.0870" is:
      Filename=/data/prod/transition/audit/formspec/osa/Infoscan/week0870/bschfrvNI.0870,
      Owner Name=prod,Group Name=users,
      Access Permission=rw-r--r--,
      Last Modified=Sun Aug 26 13:21:43 2018

NOTE: 442 records were written to the file "/data/prod/transition/audit/formspec/osa/Infoscan/week0870/bschfrvNI.0870".
      The minimum record length was 104.
      The maximum record length was 104.
NOTE: There were 442 observations read from the data set WORK.GROSSUP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/week0870/bschfrvNI.0870,0) created
MPRINT(FORMAT_OSA):  ;
MPRINT(OSA):  ;

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           5:42.72
      cpu time            5:42.83
      
/*========================================================================*/
/* ========== PROCESS SUMMARY INCL USER-NOTE / WARNING / ERROR ========== */
/*========================================================================*/

--------------------
- Process Duration -
--------------------

      real time           5:42.72
      cpu time            5:42.83

--------------------
- Process Messages -
--------------------

USER-NOTE: File (/IRI_prod/PARM/Prod_Parameters.txt) imported
USER-NOTE: File (/IRI_prod/PARM/Period_Manager.txt) imported
USER-NOTE: File (/data/prod/transition/audit/data/keycats.for.reports) imported
USER-NOTE: File (/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc) imported
USER-NOTE: File (/data/prod/transition/audit/catall) imported
USER-NOTE: File (/data/prod/transition/audit/proj/chipallweek0867.csv) imported
USER-NOTE: File (/data/prod/transition/audit/proj/chipallweek0868.csv) imported
USER-NOTE: File (/data/prod/transition/audit/proj/chipallweek0869.csv) imported
USER-NOTE: File (/data/prod/transition/audit/proj/chipallweek0870.csv) imported
USER-NOTE: File (/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde) imported
USER-NOTE: File (/data/prod/transition/audit/data/item) imported
USER-NOTE: File (week0867) imported
USER-NOTE: File (week0868) imported
USER-NOTE: File (week0869) imported
USER-NOTE: File (week0870) imported
USER-NOTE: File (/data/prod/transition/audit/data/bschfrvNI.geo) imported
USER-NOTE: File (/data/prod/transition/audit/data/store) imported
USER-NOTE: File (/data/prod/transition/audit/data/bschfrvNI.max) imported
USER-NOTE: File (/data/prod/transition/audit/data/store.shop) imported
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0867/geog.bschfrvNI.p0867) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0868/geog.bschfrvNI.p0868) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0869/geog.bschfrvNI.p0869) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0870/geog.bschfrvNI.p0870) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/period0128/geog.bschfrvNI.p0128) created
USER-NOTE: File (/data/prod/transition/audit/catall) imported
USER-NOTE: File (/data/prod/transition/audit/categories/cfiles/bschfrvNI.cde) imported
USER-NOTE: File (/data/prod/transition/audit/categories/dfiles/bschfrvNI.dsc) imported
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/period0128/bschfrvNI.p0128) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/period0128/bschfrvNI.0128,1) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0867/bschfrvNI.p0867) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/week0867/bschfrvNI.0867,0) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0868/bschfrvNI.p0868) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/week0868/bschfrvNI.0868,0) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0869/bschfrvNI.p0869) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/week0869/bschfrvNI.0869,0) created
USER-NOTE: File (/data/prod/transition/audit/aggregate/data/Infoscan/week0870/bschfrvNI.p0870) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/formcat) imported
USER-NOTE: File (/data/prod/transition/audit/formspec/osa/Infoscan/week0870/bschfrvNI.0870,0) created
